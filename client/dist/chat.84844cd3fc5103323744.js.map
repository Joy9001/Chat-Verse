{"version":3,"file":"chat.84844cd3fc5103323744.js","mappings":"uJAMO,SAASA,EAAQC,GACtB,GAAIA,EAAK,OAWX,SAAeA,GACb,IAAK,IAAIC,KAAOF,EAAQG,UACtBF,EAAIC,GAAOF,EAAQG,UAAUD,GAE/B,OAAOD,CACT,CAhBkBG,CAAMH,EACxB,C,8BA0BAD,EAAQG,UAAUE,GAClBL,EAAQG,UAAUG,iBAAmB,SAASC,EAAOC,GAInD,OAHAC,KAAKC,WAAaD,KAAKC,YAAc,CAAC,GACrCD,KAAKC,WAAW,IAAMH,GAASE,KAAKC,WAAW,IAAMH,IAAU,IAC7DI,KAAKH,GACDC,IACT,EAYAT,EAAQG,UAAUS,KAAO,SAASL,EAAOC,GACvC,SAASH,IACPI,KAAKI,IAAIN,EAAOF,GAChBG,EAAGM,MAAML,KAAMM,UACjB,CAIA,OAFAV,EAAGG,GAAKA,EACRC,KAAKJ,GAAGE,EAAOF,GACRI,IACT,EAYAT,EAAQG,UAAUU,IAClBb,EAAQG,UAAUa,eAClBhB,EAAQG,UAAUc,mBAClBjB,EAAQG,UAAUe,oBAAsB,SAASX,EAAOC,GAItD,GAHAC,KAAKC,WAAaD,KAAKC,YAAc,CAAC,EAGlC,GAAKK,UAAUI,OAEjB,OADAV,KAAKC,WAAa,CAAC,EACZD,KAIT,IAUIW,EAVAC,EAAYZ,KAAKC,WAAW,IAAMH,GACtC,IAAKc,EAAW,OAAOZ,KAGvB,GAAI,GAAKM,UAAUI,OAEjB,cADOV,KAAKC,WAAW,IAAMH,GACtBE,KAKT,IAAK,IAAIa,EAAI,EAAGA,EAAID,EAAUF,OAAQG,IAEpC,IADAF,EAAKC,EAAUC,MACJd,GAAMY,EAAGZ,KAAOA,EAAI,CAC7Ba,EAAUE,OAAOD,EAAG,GACpB,KACF,CASF,OAJyB,IAArBD,EAAUF,eACLV,KAAKC,WAAW,IAAMH,GAGxBE,IACT,EAUAT,EAAQG,UAAUqB,KAAO,SAASjB,GAChCE,KAAKC,WAAaD,KAAKC,YAAc,CAAC,EAKtC,IAHA,IAAIe,EAAO,IAAIC,MAAMX,UAAUI,OAAS,GACpCE,EAAYZ,KAAKC,WAAW,IAAMH,GAE7Be,EAAI,EAAGA,EAAIP,UAAUI,OAAQG,IACpCG,EAAKH,EAAI,GAAKP,UAAUO,GAG1B,GAAID,EAEG,CAAIC,EAAI,EAAb,IAAK,IAAWK,GADhBN,EAAYA,EAAUO,MAAM,IACIT,OAAQG,EAAIK,IAAOL,EACjDD,EAAUC,GAAGR,MAAML,KAAMgB,EADKN,CAKlC,OAAOV,IACT,EAGAT,EAAQG,UAAU0B,aAAe7B,EAAQG,UAAUqB,KAUnDxB,EAAQG,UAAU2B,UAAY,SAASvB,GAErC,OADAE,KAAKC,WAAaD,KAAKC,YAAc,CAAC,EAC/BD,KAAKC,WAAW,IAAMH,IAAU,EACzC,EAUAP,EAAQG,UAAU4B,aAAe,SAASxB,GACxC,QAAUE,KAAKqB,UAAUvB,GAAOY,MAClC,C,m2BCvKAa,EAAA,kBAAAC,CAAA,MAAAC,EAAAD,EAAA,GAAAE,EAAAC,OAAAjC,UAAAkC,EAAAF,EAAAG,eAAAC,EAAAH,OAAAI,gBAAA,SAAAN,EAAAD,EAAAE,GAAAD,EAAAD,GAAAE,EAAAM,KAAA,EAAAnB,EAAA,mBAAAoB,OAAAA,OAAA,GAAAC,EAAArB,EAAAsB,UAAA,aAAAC,EAAAvB,EAAAwB,eAAA,kBAAAC,EAAAzB,EAAA0B,aAAA,yBAAAC,EAAAf,EAAAD,EAAAE,GAAA,OAAAC,OAAAI,eAAAN,EAAAD,EAAA,CAAAQ,MAAAN,EAAAe,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAlB,EAAAD,EAAA,KAAAgB,EAAA,aAAAf,GAAAe,EAAA,SAAAf,EAAAD,EAAAE,GAAA,OAAAD,EAAAD,GAAAE,CAAA,WAAAkB,EAAAnB,EAAAD,EAAAE,EAAAE,GAAA,IAAAf,EAAAW,GAAAA,EAAA9B,qBAAAmD,EAAArB,EAAAqB,EAAAX,EAAAP,OAAAmB,OAAAjC,EAAAnB,WAAA0C,EAAA,IAAAW,EAAAnB,GAAA,WAAAE,EAAAI,EAAA,WAAAF,MAAAgB,EAAAvB,EAAAC,EAAAU,KAAAF,CAAA,UAAAe,EAAAxB,EAAAD,EAAAE,GAAA,WAAAwB,KAAA,SAAAC,IAAA1B,EAAA2B,KAAA5B,EAAAE,GAAA,OAAAD,GAAA,OAAAyB,KAAA,QAAAC,IAAA1B,EAAA,EAAAD,EAAAoB,KAAAA,EAAA,IAAAS,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,EAAA,YAAAZ,IAAA,UAAAa,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAApB,EAAAoB,EAAA1B,GAAA,8BAAA2B,EAAAlC,OAAAmC,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAArC,GAAAE,EAAAwB,KAAAW,EAAA7B,KAAA0B,EAAAG,GAAA,IAAAE,EAAAN,EAAAjE,UAAAmD,EAAAnD,UAAAiC,OAAAmB,OAAAc,GAAA,SAAAM,EAAAzC,GAAA,0BAAA0C,SAAA,SAAA3C,GAAAgB,EAAAf,EAAAD,GAAA,SAAAC,GAAA,YAAA2C,QAAA5C,EAAAC,EAAA,gBAAA4C,EAAA5C,EAAAD,GAAA,SAAA8C,EAAA5C,EAAAI,EAAAjB,EAAAqB,GAAA,IAAAE,EAAAa,EAAAxB,EAAAC,GAAAD,EAAAK,GAAA,aAAAM,EAAAc,KAAA,KAAAZ,EAAAF,EAAAe,IAAAE,EAAAf,EAAAN,MAAA,OAAAqB,GAAA,UAAAkB,EAAAlB,IAAAzB,EAAAwB,KAAAC,EAAA,WAAA7B,EAAAgD,QAAAnB,EAAAoB,SAAAC,MAAA,SAAAjD,GAAA6C,EAAA,OAAA7C,EAAAZ,EAAAqB,EAAA,aAAAT,GAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAV,EAAAgD,QAAAnB,GAAAqB,MAAA,SAAAjD,GAAAa,EAAAN,MAAAP,EAAAZ,EAAAyB,EAAA,aAAAb,GAAA,OAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAA,EAAAE,EAAAe,IAAA,KAAAzB,EAAAI,EAAA,gBAAAE,MAAA,SAAAP,EAAAG,GAAA,SAAA+C,IAAA,WAAAnD,GAAA,SAAAA,EAAAE,GAAA4C,EAAA7C,EAAAG,EAAAJ,EAAAE,EAAA,WAAAA,EAAAA,EAAAA,EAAAgD,KAAAC,EAAAA,GAAAA,GAAA,aAAA3B,EAAAxB,EAAAE,EAAAE,GAAA,IAAAE,EAAAuB,EAAA,gBAAAxC,EAAAqB,GAAA,GAAAJ,IAAAyB,EAAA,MAAAqB,MAAA,mCAAA9C,IAAA0B,EAAA,cAAA3C,EAAA,MAAAqB,EAAA,OAAAF,MAAAP,EAAAoD,MAAA,OAAAjD,EAAAkD,OAAAjE,EAAAe,EAAAuB,IAAAjB,IAAA,KAAAE,EAAAR,EAAAmD,SAAA,GAAA3C,EAAA,KAAAE,EAAA0C,EAAA5C,EAAAR,GAAA,GAAAU,EAAA,IAAAA,IAAAmB,EAAA,gBAAAnB,CAAA,cAAAV,EAAAkD,OAAAlD,EAAAqD,KAAArD,EAAAsD,MAAAtD,EAAAuB,SAAA,aAAAvB,EAAAkD,OAAA,IAAAhD,IAAAuB,EAAA,MAAAvB,EAAA0B,EAAA5B,EAAAuB,IAAAvB,EAAAuD,kBAAAvD,EAAAuB,IAAA,gBAAAvB,EAAAkD,QAAAlD,EAAAwD,OAAA,SAAAxD,EAAAuB,KAAArB,EAAAyB,EAAA,IAAAK,EAAAX,EAAAzB,EAAAE,EAAAE,GAAA,cAAAgC,EAAAV,KAAA,IAAApB,EAAAF,EAAAiD,KAAArB,EAAAF,EAAAM,EAAAT,MAAAM,EAAA,gBAAAzB,MAAA4B,EAAAT,IAAA0B,KAAAjD,EAAAiD,KAAA,WAAAjB,EAAAV,OAAApB,EAAA0B,EAAA5B,EAAAkD,OAAA,QAAAlD,EAAAuB,IAAAS,EAAAT,IAAA,YAAA6B,EAAAxD,EAAAE,GAAA,IAAAE,EAAAF,EAAAoD,OAAAhD,EAAAN,EAAAW,SAAAP,GAAA,GAAAE,IAAAL,EAAA,OAAAC,EAAAqD,SAAA,eAAAnD,GAAAJ,EAAAW,SAAA,SAAAT,EAAAoD,OAAA,SAAApD,EAAAyB,IAAA1B,EAAAuD,EAAAxD,EAAAE,GAAA,UAAAA,EAAAoD,SAAA,WAAAlD,IAAAF,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAAzD,EAAA,aAAA6B,EAAA,IAAA5C,EAAAoC,EAAAnB,EAAAN,EAAAW,SAAAT,EAAAyB,KAAA,aAAAtC,EAAAqC,KAAA,OAAAxB,EAAAoD,OAAA,QAAApD,EAAAyB,IAAAtC,EAAAsC,IAAAzB,EAAAqD,SAAA,KAAAtB,EAAA,IAAAvB,EAAArB,EAAAsC,IAAA,OAAAjB,EAAAA,EAAA2C,MAAAnD,EAAAF,EAAA8D,YAAApD,EAAAF,MAAAN,EAAA6D,KAAA/D,EAAAgE,QAAA,WAAA9D,EAAAoD,SAAApD,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,GAAAC,EAAAqD,SAAA,KAAAtB,GAAAvB,GAAAR,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAA3D,EAAAqD,SAAA,KAAAtB,EAAA,UAAAgC,EAAAhE,GAAA,IAAAD,EAAA,CAAAkE,OAAAjE,EAAA,SAAAA,IAAAD,EAAAmE,SAAAlE,EAAA,SAAAA,IAAAD,EAAAoE,WAAAnE,EAAA,GAAAD,EAAAqE,SAAApE,EAAA,SAAAqE,WAAA5F,KAAAsB,EAAA,UAAAuE,EAAAtE,GAAA,IAAAD,EAAAC,EAAAuE,YAAA,GAAAxE,EAAA0B,KAAA,gBAAA1B,EAAA2B,IAAA1B,EAAAuE,WAAAxE,CAAA,UAAAuB,EAAAtB,GAAA,KAAAqE,WAAA,EAAAJ,OAAA,SAAAjE,EAAA0C,QAAAsB,EAAA,WAAAQ,OAAA,YAAAjC,EAAAxC,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAE,EAAAF,EAAAU,GAAA,GAAAR,EAAA,OAAAA,EAAA0B,KAAA5B,GAAA,sBAAAA,EAAA+D,KAAA,OAAA/D,EAAA,IAAA0E,MAAA1E,EAAAd,QAAA,KAAAoB,GAAA,EAAAjB,EAAA,SAAA0E,IAAA,OAAAzD,EAAAN,EAAAd,QAAA,GAAAkB,EAAAwB,KAAA5B,EAAAM,GAAA,OAAAyD,EAAAvD,MAAAR,EAAAM,GAAAyD,EAAAV,MAAA,EAAAU,EAAA,OAAAA,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,SAAA1E,EAAA0E,KAAA1E,CAAA,YAAAwE,UAAAd,EAAA/C,GAAA,2BAAAkC,EAAAhE,UAAAiE,EAAA7B,EAAAmC,EAAA,eAAAjC,MAAA2B,EAAAjB,cAAA,IAAAZ,EAAA6B,EAAA,eAAA3B,MAAA0B,EAAAhB,cAAA,IAAAgB,EAAAyC,YAAA3D,EAAAmB,EAAArB,EAAA,qBAAAd,EAAA4E,oBAAA,SAAA3E,GAAA,IAAAD,EAAA,mBAAAC,GAAAA,EAAA4E,YAAA,QAAA7E,IAAAA,IAAAkC,GAAA,uBAAAlC,EAAA2E,aAAA3E,EAAA8E,MAAA,EAAA9E,EAAA+E,KAAA,SAAA9E,GAAA,OAAAE,OAAA6E,eAAA7E,OAAA6E,eAAA/E,EAAAkC,IAAAlC,EAAAgF,UAAA9C,EAAAnB,EAAAf,EAAAa,EAAA,sBAAAb,EAAA/B,UAAAiC,OAAAmB,OAAAmB,GAAAxC,CAAA,EAAAD,EAAAkF,MAAA,SAAAjF,GAAA,OAAAgD,QAAAhD,EAAA,EAAAyC,EAAAG,EAAA3E,WAAA8C,EAAA6B,EAAA3E,UAAA0C,GAAA,0BAAAZ,EAAA6C,cAAAA,EAAA7C,EAAAmF,MAAA,SAAAlF,EAAAC,EAAAE,EAAAE,EAAAjB,QAAA,IAAAA,IAAAA,EAAA+F,SAAA,IAAA1E,EAAA,IAAAmC,EAAAzB,EAAAnB,EAAAC,EAAAE,EAAAE,GAAAjB,GAAA,OAAAW,EAAA4E,oBAAA1E,GAAAQ,EAAAA,EAAAqD,OAAAb,MAAA,SAAAjD,GAAA,OAAAA,EAAAoD,KAAApD,EAAAO,MAAAE,EAAAqD,MAAA,KAAArB,EAAAD,GAAAzB,EAAAyB,EAAA3B,EAAA,aAAAE,EAAAyB,EAAA/B,GAAA,0BAAAM,EAAAyB,EAAA,qDAAAzC,EAAAqF,KAAA,SAAApF,GAAA,IAAAD,EAAAG,OAAAF,GAAAC,EAAA,WAAAE,KAAAJ,EAAAE,EAAAxB,KAAA0B,GAAA,OAAAF,EAAAoF,UAAA,SAAAvB,IAAA,KAAA7D,EAAAhB,QAAA,KAAAe,EAAAC,EAAAqF,MAAA,GAAAtF,KAAAD,EAAA,OAAA+D,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,QAAAA,EAAAV,MAAA,EAAAU,CAAA,GAAA/D,EAAAwC,OAAAA,EAAAjB,EAAArD,UAAA,CAAA2G,YAAAtD,EAAAkD,MAAA,SAAAzE,GAAA,QAAAwF,KAAA,OAAAzB,KAAA,OAAAN,KAAA,KAAAC,MAAAzD,EAAA,KAAAoD,MAAA,OAAAE,SAAA,UAAAD,OAAA,YAAA3B,IAAA1B,EAAA,KAAAqE,WAAA3B,QAAA4B,IAAAvE,EAAA,QAAAE,KAAA,WAAAA,EAAAuF,OAAA,IAAArF,EAAAwB,KAAA,KAAA1B,KAAAwE,OAAAxE,EAAAP,MAAA,WAAAO,GAAAD,EAAA,EAAAyF,KAAA,gBAAArC,MAAA,MAAApD,EAAA,KAAAqE,WAAA,GAAAE,WAAA,aAAAvE,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,YAAAgE,IAAA,EAAAhC,kBAAA,SAAA3D,GAAA,QAAAqD,KAAA,MAAArD,EAAA,IAAAE,EAAA,cAAA0F,EAAAxF,EAAAE,GAAA,OAAAI,EAAAgB,KAAA,QAAAhB,EAAAiB,IAAA3B,EAAAE,EAAA6D,KAAA3D,EAAAE,IAAAJ,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,KAAAK,CAAA,SAAAA,EAAA,KAAAgE,WAAApF,OAAA,EAAAoB,GAAA,IAAAA,EAAA,KAAAjB,EAAA,KAAAiF,WAAAhE,GAAAI,EAAArB,EAAAmF,WAAA,YAAAnF,EAAA6E,OAAA,OAAA0B,EAAA,UAAAvG,EAAA6E,QAAA,KAAAsB,KAAA,KAAA5E,EAAAR,EAAAwB,KAAAvC,EAAA,YAAAyB,EAAAV,EAAAwB,KAAAvC,EAAA,iBAAAuB,GAAAE,EAAA,SAAA0E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,WAAAqB,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,SAAAxD,GAAA,QAAA4E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,YAAArD,EAAA,MAAAsC,MAAA,kDAAAoC,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,KAAAR,OAAA,SAAA3D,EAAAD,GAAA,QAAAE,EAAA,KAAAoE,WAAApF,OAAA,EAAAgB,GAAA,IAAAA,EAAA,KAAAI,EAAA,KAAAgE,WAAApE,GAAA,GAAAI,EAAA4D,QAAA,KAAAsB,MAAApF,EAAAwB,KAAAtB,EAAA,oBAAAkF,KAAAlF,EAAA8D,WAAA,KAAA/E,EAAAiB,EAAA,OAAAjB,IAAA,UAAAY,GAAA,aAAAA,IAAAZ,EAAA6E,QAAAlE,GAAAA,GAAAX,EAAA+E,aAAA/E,EAAA,UAAAqB,EAAArB,EAAAA,EAAAmF,WAAA,UAAA9D,EAAAgB,KAAAzB,EAAAS,EAAAiB,IAAA3B,EAAAX,GAAA,KAAAiE,OAAA,YAAAS,KAAA1E,EAAA+E,WAAAnC,GAAA,KAAA4D,SAAAnF,EAAA,EAAAmF,SAAA,SAAA5F,EAAAD,GAAA,aAAAC,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,gBAAA1B,EAAAyB,MAAA,aAAAzB,EAAAyB,KAAA,KAAAqC,KAAA9D,EAAA0B,IAAA,WAAA1B,EAAAyB,MAAA,KAAAiE,KAAA,KAAAhE,IAAA1B,EAAA0B,IAAA,KAAA2B,OAAA,cAAAS,KAAA,kBAAA9D,EAAAyB,MAAA1B,IAAA,KAAA+D,KAAA/D,GAAAiC,CAAA,EAAA6D,OAAA,SAAA7F,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAkE,aAAAnE,EAAA,YAAA4F,SAAA3F,EAAAsE,WAAAtE,EAAAmE,UAAAE,EAAArE,GAAA+B,CAAA,kBAAAhC,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAgE,SAAAjE,EAAA,KAAAG,EAAAF,EAAAsE,WAAA,aAAApE,EAAAsB,KAAA,KAAApB,EAAAF,EAAAuB,IAAA4C,EAAArE,EAAA,QAAAI,CAAA,QAAA8C,MAAA,0BAAA2C,cAAA,SAAA/F,EAAAE,EAAAE,GAAA,YAAAmD,SAAA,CAAA5C,SAAA6B,EAAAxC,GAAA8D,WAAA5D,EAAA8D,QAAA5D,GAAA,cAAAkD,SAAA,KAAA3B,IAAA1B,GAAAgC,CAAA,GAAAjC,CAAA,UAAAgG,EAAA5F,EAAAH,EAAAD,EAAAE,EAAAI,EAAAI,EAAAE,GAAA,QAAAvB,EAAAe,EAAAM,GAAAE,GAAAE,EAAAzB,EAAAmB,KAAA,OAAAJ,GAAA,YAAAJ,EAAAI,EAAA,CAAAf,EAAAgE,KAAApD,EAAAa,GAAAsE,QAAApC,QAAAlC,GAAAoC,KAAAhD,EAAAI,EAAA,UAAA2F,EAAA7F,GAAA,sBAAAH,EAAA,KAAAD,EAAAlB,UAAA,WAAAsG,SAAA,SAAAlF,EAAAI,GAAA,IAAAI,EAAAN,EAAAvB,MAAAoB,EAAAD,GAAA,SAAAkG,EAAA9F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,OAAA/F,EAAA,UAAA+F,EAAA/F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,QAAA/F,EAAA,CAAA8F,OAAA,OAGO,IAAME,EAAa,SAACC,GAC1B,IAAMC,EAAO,IAAIC,KAAKF,GAEhBG,GAAS,IAAMF,EAAKG,YAAY9G,OAAO,GACvC+G,GAAW,IAAMJ,EAAKK,cAAchH,OAAO,GAC3CiH,EAAMN,EAAKO,UAAUC,WAErBC,EADa,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OACxET,EAAKU,YACxBC,EAAOX,EAAKY,cAElB,MAAO,GAAPC,OAAUX,EAAK,KAAAW,OAAIT,EAAO,KAAAS,OAAIP,EAAG,KAAAO,OAAIJ,EAAK,MAAAI,OAAKF,EAChD,EAEaG,EAAmB,SAACC,GAChCC,SAASC,cAAc,uBAAuBC,UAAUC,OAAO,UAC/DH,SAASC,cAAc,4BAA4BG,YAAcL,EAEjEM,YAAW,WACVL,SAASC,cAAc,4BAA4BG,YAAc,GACjEJ,SAASC,cAAc,uBAAuBC,UAAUI,IAAI,SAC7D,GAAG,IACJ,EAGaC,EAAW,eAAAC,EAAA7B,EAAAlG,IAAAgF,MAAG,SAAAgD,EAAOC,GAAW,IAAAC,EAAAC,EAAAC,EAAAC,EAAA5I,EAAA6I,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA7J,UAAA,OAAAiB,IAAAqB,MAAA,SAAAwH,GAAA,cAAAA,EAAApD,KAAAoD,EAAA7E,MAAA,OAgBxB,IAdpBuD,SAASC,cAAc,uBACpBD,SAASC,cAAc,sBAAsBC,UAAUC,OAAO,UAEjEH,SAASC,cAAc,wBACpBD,SAASC,cAAc,uBAAuBC,UAAUC,OAAO,UAElEO,EAAYR,UAAUI,IAAI,WAGtBK,EAAgBD,EAAYa,SAAS,IAC3BA,SAAS,GAAGnB,YAAc,GACxCO,EAAcT,UAAUsB,SAAS,WAAmBb,EAAcT,UAAUI,IAAI,UAE1EM,EAAuBF,EAAYT,cAAc,kBAAkBwB,UACrEZ,EAAc,CAAC,EAACC,EAAAO,EAAAzJ,OAhB6BM,EAAI,IAAAC,MAAA2I,EAAA,EAAAA,EAAA,KAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAJ7I,EAAI6I,EAAA,GAAAM,EAAAN,GAkBjD7I,EAAK,IAAMA,EAAK,GAAGwJ,WAAad,EACnCC,EAAc3I,EAAK,IAEb8I,EAAiBN,EAAYiB,QAAQC,GACrCX,EAAmBP,EAAYT,cAAc,cAAcwB,UAC3DP,EAAqBR,EAAYT,cAAc,iBAAiB4B,IAEtEhB,EAAc,CACbiB,YAAad,EACbxD,KAAMyD,EACNc,OAAQb,EACRQ,SAAUd,IAIRO,GAAW,EACXC,EAAgBV,EAAYT,cAAc,WAGAkB,IAA9CC,EAAclB,UAAUsB,SAAS,UACjCQ,EAAqBnB,EAAaM,GAClCc,EAAYpB,GAAY,yBAAAS,EAAAlD,OAAA,GAAAqC,EAAA,KACxB,gBAxCuByB,GAAA,OAAA1B,EAAAjJ,MAAA,KAAAC,UAAA,KA2CXwK,EAAuB,SAACnB,GAAkC,IAArBM,EAAQ3J,UAAAI,OAAA,QAAAuK,IAAA3K,UAAA,IAAAA,UAAA,GACrD4K,EAAWpC,SAASqC,eAAe,aACnCC,EAAWtC,SAASqC,eAAe,aACnCE,EAAYvC,SAASqC,eAAe,cACpCG,EAAiBxC,SAASqC,eAAe,kBACzCI,EAAgBzC,SAASqC,eAAe,iBACxCK,EAAqB1C,SAASqC,eAAe,sBAEjDE,EAAUrC,UAAUsB,SAAS,WAAYe,EAAUrC,UAAUC,OAAO,UACpEiC,EAASlC,UAAUsB,SAAS,WAAYY,EAASlC,UAAUC,OAAO,UAClEmC,EAASpC,UAAUsB,SAAS,WAAYc,EAASpC,UAAUC,OAAO,UAElEqC,EAAepC,YAAcS,EAAYrD,KACzCiF,EAAcZ,IAAMhB,EAAYkB,OAC7BlB,EAAYkB,OAAM,mDAAAlC,OACiCgB,EAAYrD,KAAKmF,QAAQ,KAAM,MACrFD,EAAmBzC,cAAc,4BAA4BG,YAAcS,EAAYrD,KACvFkF,EAAmBzC,cAAc,gCAAgCG,YAAcS,EAAYa,SAC3FgB,EAAmBzC,cAAc,2BAA2B4B,IAAMhB,EAAYkB,OAC3ElB,EAAYkB,OAAM,mDAAAlC,OACiCgB,EAAYrD,KAAKmF,QAAQ,KAAM,MAErF,IAAIC,EAAyB5C,SAASC,cAAc,+BACpD2C,EAAuB1C,UAAUsB,SAAS,WAAYoB,EAAuB1C,UAAUC,OAAO,UAE9F,IAAI0C,EAAwB7C,SAASC,cAAc,8BACnD4C,EAAsB3C,UAAUsB,SAAS,WAAmBqB,EAAsB3C,UAAUI,IAAI,UAE5Fa,EACHoB,EAAUtC,cAAc,WAAWC,UAAUI,IAAI,UAEjDiC,EAAUtC,cAAc,WAAWC,UAAUC,OAAO,UAIrD,IAAI2C,EAAU9C,SAASC,cAAc,yBACrC6C,EAAQ5C,UAAUsB,SAAS,WAAmBsB,EAAQ5C,UAAUI,IAAI,SACrE,EAEa2B,EAAc,SAACpB,GAC3B,IAAIkC,EAAc/C,SAASC,cAAc,iBACrC8C,EAAY7C,UAAUsB,SAAS,WAAWuB,EAAY7C,UAAUC,OAAO,UAEjDH,SAASC,cAAc,gCAC7B4B,IAAMhB,EAAYkB,OACnClB,EAAYkB,OAAM,mDAAAlC,OACiCgB,EAAYrD,KAAKmF,QAAQ,KAAM,MAErF,IAAIK,EAAuBhD,SAASC,cAAc,gCAC9CgD,EAA2BjD,SAASC,cAAc,gCACtD+C,EAAqB5C,YAAcS,EAAYrD,KAC/CyF,EAAyB7C,YAAcS,EAAYa,SACnDuB,EAAyBC,cAAcvB,QAAQwB,IAAMtC,EAAYa,SAEjE,IAAI0B,EAAavC,EAAYiB,YAE7BuB,EAAmBD,EACpB,EAEaC,EAAqB,SAACD,GAClC,IAAId,EAAWtC,SAASqC,eAAe,aAEvCiB,MAAM,6BAA8B,CACnCtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CAAEN,WAAAA,MAEtBxH,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEN,IAAIC,EAAYD,EAAKC,UACjBC,EAAYF,EAAKE,UACjBC,EAAgBH,EAAKI,SACrBH,IACHxB,EAASpC,UAAUI,IAAI,UACRN,SAASC,cAAc,oBAC7BC,UAAUC,OAAO,WAE3B,GAAI4D,IAAcC,EACGhE,SAASC,cAAc,kBAAkBsB,SAAS,GACxDnB,YAAc,eACtB,GAAkB,OAAd2D,EAAoB,CACf/D,SAASC,cAAc,kBAC7BC,UAAUI,IAAI,UAEHN,SAASC,cAAc,wBAC7BC,UAAUI,IAAI,UAE5B,IAAI4D,EAAelE,SAASC,cAAc,eACtCiE,EAAahE,UAAUsB,SAAS,WACnC0C,EAAahE,UAAUC,OAAO,UAG/B,IAAIyC,EAAyB5C,SAASC,cAAc,+BACpD2C,EAAuB1C,UAAUsB,SAAS,WACvCoB,EAAuB1C,UAAUC,OAAO,UAE3CyC,EAAuBuB,YAAYD,EACpC,CACAE,EAAuBP,EACxB,IAAE,OACK,SAACQ,GACPC,QAAQC,IAAI,kCAAmCF,EAChD,GACF,EAEaD,EAAyB,SAACP,GACtC,IAAMG,EAAgBH,EAAKI,SAGvBO,EAAkBxE,SAASC,cAAc,sBAE7C,GAA6B,IAAzB4D,EAAKY,SAAS7M,OAAlB,CAKC4M,EAAgBpE,YAAc,GAC9B,IAAIpB,EAAO,GACX6E,EAAKY,SAAWZ,EAAKY,SAASC,QAAO,SAACC,GAAG,OAAa,OAARA,CAAY,IAC1Dd,EAAKY,SAASpJ,SAAQ,SAACsJ,GAGtB,IAAIC,EAAU9F,EAAW6F,EAAIE,WAAWxM,MAAM,GAC9C,GAAIuM,IAAY5F,EAAM,CACrBA,EAAO4F,EACP,IAAME,EAAS9E,SAAS+E,cAAc,OACtCD,EAAO5E,UAAUI,IAAI,OACrB,IAAM0E,EAAUhF,SAAS+E,cAAc,OACvCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAM2E,EAASjF,SAAS+E,cAAc,MACtCE,EAAO7E,YAAcpB,EAErBgG,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAEA,GAAIH,EAAIV,WAAaD,EAAe,CACnC,IAAIkB,EAAcC,EAAqBR,EAAIS,QAAST,EAAIU,IAAKvG,EAAW6F,EAAIE,WAAWxM,MAAM,EAAG,IAChGmM,EAAgBL,YAAYe,EAC7B,KAAO,CACN,IAAII,EAAYC,EAAmBZ,EAAIS,QAAST,EAAIU,IAAKvG,EAAW6F,EAAIE,WAAWxM,MAAM,EAAG,IAC5FmM,EAAgBL,YAAYmB,EAC7B,CACD,IACAd,EAAgBgB,UAAYhB,EAAgBiB,YAC7C,MAlCCjB,EAAgBpE,YAAc,EAmChC,EAEa+E,EAAuB,SAACR,EAAKe,EAAOC,GAChD,IAAIC,EAAY5F,SAAS+E,cAAc,OAgBvC,OAfAa,EAAU1F,UAAUI,IAAI,iBACxBsF,EAAUjE,QAAQC,GAAK8D,EACvBE,EAAUC,UAAY,uqBAAHhG,OASiE8E,EAAG,mEAAA9E,OAC7B8F,EAAI,iCAGvDC,CACR,EAEaL,EAAqB,SAACZ,EAAKe,EAAOC,GAC9C,IAAIC,EAAY5F,SAAS+E,cAAc,OAgBvC,OAfAa,EAAU1F,UAAUI,IAAI,eACxBsF,EAAUjE,QAAQC,GAAK8D,EACvBE,EAAUC,UAAY,wJAAHhG,OAEiE8E,EAAG,mEAAA9E,OAC7B8F,EAAI,8iBAUvDC,CACR,EAEaE,EAAuB,SAACjC,GACpC,IAAIkC,EAAYC,EAAwBnC,GAElB7D,SAASC,cAAc,kBAC7BkE,YAAY4B,GAE5BxF,EAAYwF,EAAWlC,IACvBoC,EAAAA,EAAAA,uBAAsBC,EAAAA,YACvB,EAEaF,EAA0B,SAACnC,GACvC,IAAIkC,EAAY/F,SAAS+E,cAAc,OACvCgB,EAAU7F,UAAUI,IAAI,aAAc,SACtCyF,EAAUpE,QAAQC,GAAKiC,EAAK/B,YAAc+B,EAAK/B,YAAc+B,EAAKwB,IAClE,IAAIc,EAActC,EAAK1C,SAAW,SAAW,GAe7C,OAdA4E,EAAUF,UAAY,gCAAHhG,OACSsG,EAAW,sIAAAtG,OAEwBgE,EAAK9B,OAAM,WAAAlC,OAAUgE,EAAKnC,SAAQ,wHAAA7B,OAI9DgE,EAAKrG,KAAI,iDAAAqC,OACLgE,EAAKnC,SAAQ,kKAM7CqE,CACR,EAEaK,EAAe,eAAAC,EAAA1H,EAAAlG,IAAAgF,MAAG,SAAA6I,EAAOC,GAAO,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA1O,IAAAqB,MAAA,SAAAsN,GAAA,cAAAA,EAAAlJ,KAAAkJ,EAAA3K,MAAA,OA2B3C,GA1BG+J,GAAe,EACfC,EAAgB,GAEdC,EAAcH,EAAQhF,SAAS,GAAGA,SAAS,GAAGE,UAGhDkF,EAAkB3G,SAASC,cAAc,4BAA4B/G,MACrE0N,EAAgB,CACnB,+DACA,mDACA,mEACA,mFACA,oEACA,wEACA,4DACA,qEACA,wEACA,kEACA,oFACA,2DACA,8EACA,uDACA,2EACA,qFACA,wFACA,oFAEGF,IAAgBC,EAAe,CAAAS,EAAA3K,KAAA,SAQzB,OAPLoK,EAAQ7G,SAASC,cAAc,WAC/B6G,EAAYD,EAAM5G,cAAc,SAC1B4F,UAAY,oDAAHhG,OAAuD+G,EAAcS,KAAKC,MAAMD,KAAKE,SAAWX,EAAchP,SAAQ,QACzIiP,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,UACpBwG,EAAU1G,YAAc,EACzB,GAAG,MAAMgH,EAAA9K,OAAA,kBAIJyK,EAAUR,EAAQhF,SAAS,GAAGA,SAAS,GAAGE,UAC1CuF,EAAYT,EAAQhF,SAAS,GAAGM,IAChCoF,EAAQV,EAAQ5E,QAAQC,GAE1BsF,EAAU,CACbpF,YAAamF,EACbzJ,KAAMuJ,EACNrF,SAAUgF,EACV3E,OAAQiF,KAGLG,EAAenH,SAASC,cAAc,mBAC7BuH,OAAeL,EAAaK,MAAO,GAE/BxH,SAASyH,iBAAiB,eAChCpM,SAAQ,SAACqM,GACEA,EAAOzH,cAAc,kBAAkBwB,YAErCyF,EAAQxF,WAC9B8E,GAAe,EACfC,EAAgBiB,EAEZA,EAAOxH,UAAUsB,SAAS,WAC7BkG,EAAOxH,UAAUC,OAAO,UAG3B,IAGKqG,EAsBJjG,EAAYkG,EAAeS,GArB3B5D,MAAM,qCAAsC,CAC3CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAY8D,EAAQpF,gBAGpBlG,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACe,yBAAjBA,EAAKuB,SACRU,EAAqBjC,EAAK8D,UAG5B,IAAE,OACK,SAACC,GACPtD,QAAQC,IAAI,uBAAwBqD,EACrC,IAOF5H,SAASC,cAAc,sBAAsB4H,QAAO,yBAAAT,EAAAhJ,OAAA,GAAAkI,EAAA,KACpD,gBAhG2BwB,GAAA,OAAAzB,EAAA9O,MAAA,KAAAC,UAAA,KAkGfuQ,EAAiB,SAACC,GAC9B,IAAIxD,EAAkBxE,SAASC,cAAc,sBAEzCjB,EAAOF,EAAWkJ,EAAOnD,WACzBD,EAAU5F,EAAK3G,MAAM,GACrB4P,EAAUjJ,EAAK3G,MAAM,EAAG,GAExB6P,EAAQ/P,MAAMgQ,KAAKnI,SAASyH,iBAAiB,UAEjD,GAAqB,IAAjBS,EAAMtQ,QAAgBsQ,EAAMA,EAAMtQ,OAAS,GAAG6J,YAAcmD,EAAS,CACxE,IAAME,EAAS9E,SAAS+E,cAAc,OACtCD,EAAO5E,UAAUI,IAAI,OACrB,IAAM0E,EAAUhF,SAAS+E,cAAc,OACvCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAM2E,EAASjF,SAAS+E,cAAc,MACtCE,EAAO7E,YAAcwE,EAErBI,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAEA,IAAII,EAAcC,EAAqB6C,EAAO5C,QAAS4C,EAAO3C,IAAK4C,GACnEzD,EAAgBL,YAAYe,GAE5BV,EAAgBgB,UAAYhB,EAAgBiB,YAC7C,EAEa2C,EAAiB,eAAAC,EAAA1J,EAAAlG,IAAAgF,MAAG,SAAA6K,EAAOlF,EAAYuB,GAAG,OAAAlM,IAAAqB,MAAA,SAAAyO,GAAA,cAAAA,EAAArK,KAAAqK,EAAA9L,MAAA,OACtD6G,MAAM,qBAAsB,CAC3BtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAAA,EACAgC,QAAST,MAGT/I,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEN,GAAqB,oBAAjBA,EAAKuB,QAA+B,CACvC,IAAIyB,EAAQ7G,SAASC,cAAc,UACnC4G,EAAMtF,SAAS,GAAGsE,UAAY,kBAC9BgB,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,SACrB,GAAG,IACJ,MACCyH,EAAelE,EAEjB,IAAE,OACK,SAACQ,GACPC,QAAQC,IAAI,6BAA8BF,EAC3C,IAAE,wBAAAkE,EAAAnK,OAAA,GAAAkK,EAAA,KACH,gBA5B6BE,EAAAC,GAAA,OAAAJ,EAAA9Q,MAAA,KAAAC,UAAA,KA8BjBkR,EAAa,eAAAC,EAAAhK,EAAAlG,IAAAgF,MAAG,SAAAmL,EAAOjE,GAAG,IAAAe,EAAAtC,EAAA,OAAA3K,IAAAqB,MAAA,SAAA+O,GAAA,cAAAA,EAAA3K,KAAA2K,EAAApM,MAAA,OAClCiJ,EAAQf,EAAIhD,QAAQC,GAGpBwB,EAAapD,SAASC,cAAc,sBAAsB0B,QAAQC,GAEtE0B,MAAM,uBAAwB,CAC7BtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAAA,EACAsC,MAAAA,MAGA9J,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEN,GAAqB,oBAAjBA,EAAKuB,QAA+B,CACvCT,EAAIxE,SACOH,SAASyH,iBAAiB,QAChCpM,SAAQ,SAACiE,IACkB,OAA3BA,EAAIwJ,oBAA+BxJ,EAAIwJ,mBAAmB5I,UAAUsB,SAAS,SAChFlC,EAAIa,QAEN,IACA,IAAI0G,EAAQ7G,SAASC,cAAc,UACnC4G,EAAMtF,SAAS,GAAGnB,YAAc,2BAChCyG,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,SACrB,GAAG,IACJ,CACD,IAAE,OACK,SAAC+D,GACPC,QAAQC,IAAI,8BAA+BF,EAC5C,IAAE,wBAAAwE,EAAAzK,OAAA,GAAAwK,EAAA,KACH,gBAtCyBG,GAAA,OAAAJ,EAAApR,MAAA,KAAAC,UAAA,KAwCbwR,EAAkB,eAAAC,EAAAtK,EAAAlG,IAAAgF,MAAG,SAAAyL,IAAA,IAAA9G,EAAAE,EAAAC,EAAA4G,EAAAC,EAAAhG,EAAA,OAAA3K,IAAAqB,MAAA,SAAAuP,GAAA,cAAAA,EAAAnL,KAAAmL,EAAA5M,MAAA,OAC7B2F,EAAWpC,SAASqC,eAAe,aACnCC,EAAWtC,SAASqC,eAAe,aACnCE,EAAYvC,SAASqC,eAAe,cACpC8G,EAAWnJ,SAASC,cAAc,oBAElCmJ,EAAWpJ,SAASC,cAAc,sBAClCmD,EAAagG,EAASzH,QAAQC,GAElC0B,MAAM,4BAA6B,CAClCtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAAA,MAGAxH,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEN,GAAqB,yBAAjBA,EAAKuB,QAAoC,CAG5CgE,EAASjJ,SACToC,EAAUrC,UAAUI,IAAI,UACxB8B,EAASlC,UAAUI,IAAI,UACvBgC,EAASpC,UAAUI,IAAI,UACvB6I,EAASjJ,UAAUI,IAAI,UAEvB,IAAIuG,EAAQ7G,SAASC,cAAc,UACnC4G,EAAMtF,SAAS,GAAGnB,YAAc,uBAChCyG,EAAM3G,UAAUC,OAAO,UAEvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,SACrB,GAAG,IACJ,CACD,IAAE,OACK,SAAC+D,GACPC,QAAQC,IAAI,mCAAoCF,EACjD,IAAE,wBAAAgF,EAAAjL,OAAA,GAAA8K,EAAA,KACH,kBA1C8B,OAAAD,EAAA1R,MAAA,KAAAC,UAAA,KA4ClB8R,EAAkB,SAAClG,EAAY1C,GAC3C,IAAI4B,EAAWtC,SAASqC,eAAe,aACnC8G,EAAWnJ,SAASC,cAAc,oBAEtCqD,MAAM,mBAAoB,CACzBtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAAA,MAGAxH,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEe,iBAAjBA,EAAKuB,UACR1E,EAAYa,SAAS,GAAGnB,YAAc,UACtCkC,EAASpC,UAAUI,IAAI,UACvB6I,EAASjJ,UAAUC,OAAO,UAE5B,IAAE,OACK,SAACkE,GACPC,QAAQC,IAAI,2BAA4BF,EACzC,GACF,EAEakF,EAAoB,SAACnG,EAAY1C,GAC7C,IAAI4B,EAAWtC,SAASqC,eAAe,aACnC8G,EAAWnJ,SAASC,cAAc,oBAEtCqD,MAAM,qBAAsB,CAC3BtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBN,WAAAA,MAGAxH,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEe,mBAAjBA,EAAKuB,UACR1E,EAAYa,SAAS,GAAGnB,YAAc,QACtC+I,EAASjJ,UAAUI,IAAI,UACvBgC,EAASpC,UAAUC,OAAO,UAE5B,IAAE,OACK,SAACkE,GACPC,QAAQC,IAAI,6BAA8BF,EAC3C,GACF,EAEamF,EAAgB,eAAAC,EAAA9K,EAAAlG,IAAAgF,MAAG,SAAAiM,EAAOhJ,GAAW,IAAA0I,EAAAhG,EAAA,OAAA3K,IAAAqB,MAAA,SAAA6P,GAAA,cAAAA,EAAAzL,KAAAyL,EAAAlN,MAAA,OAC7C2M,EAAWpJ,SAASC,cAAc,sBAClCmD,EAAagG,EAASzH,QAAQC,GAId,UAFFlB,EAAYa,SAAS,GAAGE,UAGzC6H,EAAgBlG,EAAY1C,GAE5B6I,EAAkBnG,EAAY1C,GAC9B,wBAAAiJ,EAAAvL,OAAA,GAAAsL,EAAA,KACD,gBAX4BE,GAAA,OAAAH,EAAAlS,MAAA,KAAAC,UAAA,KAchBqS,EAAgBC,aAC5B,WACCxG,MAAM,0BAA2B,CAChCtH,OAAQ,MACRuH,QAAS,CACR,eAAgB,sBAGhB3H,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACNS,QAAQC,IAAIV,GACRA,EAAK+D,OAAOmC,cAAcF,EAC/B,IAAE,OACK,SAACjC,GAAK,OAAKtD,QAAQC,IAAIqD,EAAMxC,QAAQ,GAC9C,GACA,I,kHCxmBDpF,SAASqC,eAAe,mBAAmBtL,iBAAiB,SAAS,WACpE,IAAIiT,EAAkBhK,SAASqC,eAAe,mBAC1C4H,EAAcjK,SAASqC,eAAe,eAEtC4H,EAAY/J,UAAUsB,SAAS,WAClCyI,EAAY/J,UAAUC,OAAO,UAC7B6J,EAAgB9J,UAAUI,IAAI,YAE9B2J,EAAY/J,UAAUI,IAAI,UAC1B0J,EAAgB9J,UAAUC,OAAO,UAEnC,IAEAH,SAASjJ,iBAAiB,SAAS,SAACC,GACnC,IAAIgT,EAAkBhK,SAASqC,eAAe,mBAC1C4H,EAAcjK,SAASqC,eAAe,eAErC2H,EAAgBxI,SAASxK,EAAMkT,SAAYD,EAAYzI,SAASxK,EAAMkT,SACrED,EAAY/J,UAAUsB,SAAS,YACnCyI,EAAY/J,UAAUI,IAAI,UAC1B0J,EAAgB9J,UAAUC,OAAO,UAGpC,IAEAH,SAASC,cAAc,gBAAgBlJ,iBAAiB,eAAe,SAACC,GACvEgJ,SAASqC,eAAe,aAAanJ,OAASlC,EAAMmT,OAAOC,OAC5D,G,k4CC5BA3R,EAAA,kBAAAC,CAAA,MAAAC,EAAAD,EAAA,GAAAE,EAAAC,OAAAjC,UAAAkC,EAAAF,EAAAG,eAAAC,EAAAH,OAAAI,gBAAA,SAAAN,EAAAD,EAAAE,GAAAD,EAAAD,GAAAE,EAAAM,KAAA,EAAAnB,EAAA,mBAAAoB,OAAAA,OAAA,GAAAC,EAAArB,EAAAsB,UAAA,aAAAC,EAAAvB,EAAAwB,eAAA,kBAAAC,EAAAzB,EAAA0B,aAAA,yBAAAC,EAAAf,EAAAD,EAAAE,GAAA,OAAAC,OAAAI,eAAAN,EAAAD,EAAA,CAAAQ,MAAAN,EAAAe,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAlB,EAAAD,EAAA,KAAAgB,EAAA,aAAAf,GAAAe,EAAA,SAAAf,EAAAD,EAAAE,GAAA,OAAAD,EAAAD,GAAAE,CAAA,WAAAkB,EAAAnB,EAAAD,EAAAE,EAAAE,GAAA,IAAAf,EAAAW,GAAAA,EAAA9B,qBAAAmD,EAAArB,EAAAqB,EAAAX,EAAAP,OAAAmB,OAAAjC,EAAAnB,WAAA0C,EAAA,IAAAW,EAAAnB,GAAA,WAAAE,EAAAI,EAAA,WAAAF,MAAAgB,EAAAvB,EAAAC,EAAAU,KAAAF,CAAA,UAAAe,EAAAxB,EAAAD,EAAAE,GAAA,WAAAwB,KAAA,SAAAC,IAAA1B,EAAA2B,KAAA5B,EAAAE,GAAA,OAAAD,GAAA,OAAAyB,KAAA,QAAAC,IAAA1B,EAAA,EAAAD,EAAAoB,KAAAA,EAAA,IAAAS,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,EAAA,YAAAZ,IAAA,UAAAa,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAApB,EAAAoB,EAAA1B,GAAA,8BAAA2B,EAAAlC,OAAAmC,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAArC,GAAAE,EAAAwB,KAAAW,EAAA7B,KAAA0B,EAAAG,GAAA,IAAAE,EAAAN,EAAAjE,UAAAmD,EAAAnD,UAAAiC,OAAAmB,OAAAc,GAAA,SAAAM,EAAAzC,GAAA,0BAAA0C,SAAA,SAAA3C,GAAAgB,EAAAf,EAAAD,GAAA,SAAAC,GAAA,YAAA2C,QAAA5C,EAAAC,EAAA,gBAAA4C,EAAA5C,EAAAD,GAAA,SAAA8C,EAAA5C,EAAAI,EAAAjB,EAAAqB,GAAA,IAAAE,EAAAa,EAAAxB,EAAAC,GAAAD,EAAAK,GAAA,aAAAM,EAAAc,KAAA,KAAAZ,EAAAF,EAAAe,IAAAE,EAAAf,EAAAN,MAAA,OAAAqB,GAAA,UAAAkB,EAAAlB,IAAAzB,EAAAwB,KAAAC,EAAA,WAAA7B,EAAAgD,QAAAnB,EAAAoB,SAAAC,MAAA,SAAAjD,GAAA6C,EAAA,OAAA7C,EAAAZ,EAAAqB,EAAA,aAAAT,GAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAV,EAAAgD,QAAAnB,GAAAqB,MAAA,SAAAjD,GAAAa,EAAAN,MAAAP,EAAAZ,EAAAyB,EAAA,aAAAb,GAAA,OAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAA,EAAAE,EAAAe,IAAA,KAAAzB,EAAAI,EAAA,gBAAAE,MAAA,SAAAP,EAAAG,GAAA,SAAA+C,IAAA,WAAAnD,GAAA,SAAAA,EAAAE,GAAA4C,EAAA7C,EAAAG,EAAAJ,EAAAE,EAAA,WAAAA,EAAAA,EAAAA,EAAAgD,KAAAC,EAAAA,GAAAA,GAAA,aAAA3B,EAAAxB,EAAAE,EAAAE,GAAA,IAAAE,EAAAuB,EAAA,gBAAAxC,EAAAqB,GAAA,GAAAJ,IAAAyB,EAAA,MAAAqB,MAAA,mCAAA9C,IAAA0B,EAAA,cAAA3C,EAAA,MAAAqB,EAAA,OAAAF,MAAAP,EAAAoD,MAAA,OAAAjD,EAAAkD,OAAAjE,EAAAe,EAAAuB,IAAAjB,IAAA,KAAAE,EAAAR,EAAAmD,SAAA,GAAA3C,EAAA,KAAAE,EAAA0C,EAAA5C,EAAAR,GAAA,GAAAU,EAAA,IAAAA,IAAAmB,EAAA,gBAAAnB,CAAA,cAAAV,EAAAkD,OAAAlD,EAAAqD,KAAArD,EAAAsD,MAAAtD,EAAAuB,SAAA,aAAAvB,EAAAkD,OAAA,IAAAhD,IAAAuB,EAAA,MAAAvB,EAAA0B,EAAA5B,EAAAuB,IAAAvB,EAAAuD,kBAAAvD,EAAAuB,IAAA,gBAAAvB,EAAAkD,QAAAlD,EAAAwD,OAAA,SAAAxD,EAAAuB,KAAArB,EAAAyB,EAAA,IAAAK,EAAAX,EAAAzB,EAAAE,EAAAE,GAAA,cAAAgC,EAAAV,KAAA,IAAApB,EAAAF,EAAAiD,KAAArB,EAAAF,EAAAM,EAAAT,MAAAM,EAAA,gBAAAzB,MAAA4B,EAAAT,IAAA0B,KAAAjD,EAAAiD,KAAA,WAAAjB,EAAAV,OAAApB,EAAA0B,EAAA5B,EAAAkD,OAAA,QAAAlD,EAAAuB,IAAAS,EAAAT,IAAA,YAAA6B,EAAAxD,EAAAE,GAAA,IAAAE,EAAAF,EAAAoD,OAAAhD,EAAAN,EAAAW,SAAAP,GAAA,GAAAE,IAAAL,EAAA,OAAAC,EAAAqD,SAAA,eAAAnD,GAAAJ,EAAAW,SAAA,SAAAT,EAAAoD,OAAA,SAAApD,EAAAyB,IAAA1B,EAAAuD,EAAAxD,EAAAE,GAAA,UAAAA,EAAAoD,SAAA,WAAAlD,IAAAF,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAAzD,EAAA,aAAA6B,EAAA,IAAA5C,EAAAoC,EAAAnB,EAAAN,EAAAW,SAAAT,EAAAyB,KAAA,aAAAtC,EAAAqC,KAAA,OAAAxB,EAAAoD,OAAA,QAAApD,EAAAyB,IAAAtC,EAAAsC,IAAAzB,EAAAqD,SAAA,KAAAtB,EAAA,IAAAvB,EAAArB,EAAAsC,IAAA,OAAAjB,EAAAA,EAAA2C,MAAAnD,EAAAF,EAAA8D,YAAApD,EAAAF,MAAAN,EAAA6D,KAAA/D,EAAAgE,QAAA,WAAA9D,EAAAoD,SAAApD,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,GAAAC,EAAAqD,SAAA,KAAAtB,GAAAvB,GAAAR,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAA3D,EAAAqD,SAAA,KAAAtB,EAAA,UAAAgC,EAAAhE,GAAA,IAAAD,EAAA,CAAAkE,OAAAjE,EAAA,SAAAA,IAAAD,EAAAmE,SAAAlE,EAAA,SAAAA,IAAAD,EAAAoE,WAAAnE,EAAA,GAAAD,EAAAqE,SAAApE,EAAA,SAAAqE,WAAA5F,KAAAsB,EAAA,UAAAuE,EAAAtE,GAAA,IAAAD,EAAAC,EAAAuE,YAAA,GAAAxE,EAAA0B,KAAA,gBAAA1B,EAAA2B,IAAA1B,EAAAuE,WAAAxE,CAAA,UAAAuB,EAAAtB,GAAA,KAAAqE,WAAA,EAAAJ,OAAA,SAAAjE,EAAA0C,QAAAsB,EAAA,WAAAQ,OAAA,YAAAjC,EAAAxC,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAE,EAAAF,EAAAU,GAAA,GAAAR,EAAA,OAAAA,EAAA0B,KAAA5B,GAAA,sBAAAA,EAAA+D,KAAA,OAAA/D,EAAA,IAAA0E,MAAA1E,EAAAd,QAAA,KAAAoB,GAAA,EAAAjB,EAAA,SAAA0E,IAAA,OAAAzD,EAAAN,EAAAd,QAAA,GAAAkB,EAAAwB,KAAA5B,EAAAM,GAAA,OAAAyD,EAAAvD,MAAAR,EAAAM,GAAAyD,EAAAV,MAAA,EAAAU,EAAA,OAAAA,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,SAAA1E,EAAA0E,KAAA1E,CAAA,YAAAwE,UAAAd,EAAA/C,GAAA,2BAAAkC,EAAAhE,UAAAiE,EAAA7B,EAAAmC,EAAA,eAAAjC,MAAA2B,EAAAjB,cAAA,IAAAZ,EAAA6B,EAAA,eAAA3B,MAAA0B,EAAAhB,cAAA,IAAAgB,EAAAyC,YAAA3D,EAAAmB,EAAArB,EAAA,qBAAAd,EAAA4E,oBAAA,SAAA3E,GAAA,IAAAD,EAAA,mBAAAC,GAAAA,EAAA4E,YAAA,QAAA7E,IAAAA,IAAAkC,GAAA,uBAAAlC,EAAA2E,aAAA3E,EAAA8E,MAAA,EAAA9E,EAAA+E,KAAA,SAAA9E,GAAA,OAAAE,OAAA6E,eAAA7E,OAAA6E,eAAA/E,EAAAkC,IAAAlC,EAAAgF,UAAA9C,EAAAnB,EAAAf,EAAAa,EAAA,sBAAAb,EAAA/B,UAAAiC,OAAAmB,OAAAmB,GAAAxC,CAAA,EAAAD,EAAAkF,MAAA,SAAAjF,GAAA,OAAAgD,QAAAhD,EAAA,EAAAyC,EAAAG,EAAA3E,WAAA8C,EAAA6B,EAAA3E,UAAA0C,GAAA,0BAAAZ,EAAA6C,cAAAA,EAAA7C,EAAAmF,MAAA,SAAAlF,EAAAC,EAAAE,EAAAE,EAAAjB,QAAA,IAAAA,IAAAA,EAAA+F,SAAA,IAAA1E,EAAA,IAAAmC,EAAAzB,EAAAnB,EAAAC,EAAAE,EAAAE,GAAAjB,GAAA,OAAAW,EAAA4E,oBAAA1E,GAAAQ,EAAAA,EAAAqD,OAAAb,MAAA,SAAAjD,GAAA,OAAAA,EAAAoD,KAAApD,EAAAO,MAAAE,EAAAqD,MAAA,KAAArB,EAAAD,GAAAzB,EAAAyB,EAAA3B,EAAA,aAAAE,EAAAyB,EAAA/B,GAAA,0BAAAM,EAAAyB,EAAA,qDAAAzC,EAAAqF,KAAA,SAAApF,GAAA,IAAAD,EAAAG,OAAAF,GAAAC,EAAA,WAAAE,KAAAJ,EAAAE,EAAAxB,KAAA0B,GAAA,OAAAF,EAAAoF,UAAA,SAAAvB,IAAA,KAAA7D,EAAAhB,QAAA,KAAAe,EAAAC,EAAAqF,MAAA,GAAAtF,KAAAD,EAAA,OAAA+D,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,QAAAA,EAAAV,MAAA,EAAAU,CAAA,GAAA/D,EAAAwC,OAAAA,EAAAjB,EAAArD,UAAA,CAAA2G,YAAAtD,EAAAkD,MAAA,SAAAzE,GAAA,QAAAwF,KAAA,OAAAzB,KAAA,OAAAN,KAAA,KAAAC,MAAAzD,EAAA,KAAAoD,MAAA,OAAAE,SAAA,UAAAD,OAAA,YAAA3B,IAAA1B,EAAA,KAAAqE,WAAA3B,QAAA4B,IAAAvE,EAAA,QAAAE,KAAA,WAAAA,EAAAuF,OAAA,IAAArF,EAAAwB,KAAA,KAAA1B,KAAAwE,OAAAxE,EAAAP,MAAA,WAAAO,GAAAD,EAAA,EAAAyF,KAAA,gBAAArC,MAAA,MAAApD,EAAA,KAAAqE,WAAA,GAAAE,WAAA,aAAAvE,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,YAAAgE,IAAA,EAAAhC,kBAAA,SAAA3D,GAAA,QAAAqD,KAAA,MAAArD,EAAA,IAAAE,EAAA,cAAA0F,EAAAxF,EAAAE,GAAA,OAAAI,EAAAgB,KAAA,QAAAhB,EAAAiB,IAAA3B,EAAAE,EAAA6D,KAAA3D,EAAAE,IAAAJ,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,KAAAK,CAAA,SAAAA,EAAA,KAAAgE,WAAApF,OAAA,EAAAoB,GAAA,IAAAA,EAAA,KAAAjB,EAAA,KAAAiF,WAAAhE,GAAAI,EAAArB,EAAAmF,WAAA,YAAAnF,EAAA6E,OAAA,OAAA0B,EAAA,UAAAvG,EAAA6E,QAAA,KAAAsB,KAAA,KAAA5E,EAAAR,EAAAwB,KAAAvC,EAAA,YAAAyB,EAAAV,EAAAwB,KAAAvC,EAAA,iBAAAuB,GAAAE,EAAA,SAAA0E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,WAAAqB,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,SAAAxD,GAAA,QAAA4E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,YAAArD,EAAA,MAAAsC,MAAA,kDAAAoC,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,KAAAR,OAAA,SAAA3D,EAAAD,GAAA,QAAAE,EAAA,KAAAoE,WAAApF,OAAA,EAAAgB,GAAA,IAAAA,EAAA,KAAAI,EAAA,KAAAgE,WAAApE,GAAA,GAAAI,EAAA4D,QAAA,KAAAsB,MAAApF,EAAAwB,KAAAtB,EAAA,oBAAAkF,KAAAlF,EAAA8D,WAAA,KAAA/E,EAAAiB,EAAA,OAAAjB,IAAA,UAAAY,GAAA,aAAAA,IAAAZ,EAAA6E,QAAAlE,GAAAA,GAAAX,EAAA+E,aAAA/E,EAAA,UAAAqB,EAAArB,EAAAA,EAAAmF,WAAA,UAAA9D,EAAAgB,KAAAzB,EAAAS,EAAAiB,IAAA3B,EAAAX,GAAA,KAAAiE,OAAA,YAAAS,KAAA1E,EAAA+E,WAAAnC,GAAA,KAAA4D,SAAAnF,EAAA,EAAAmF,SAAA,SAAA5F,EAAAD,GAAA,aAAAC,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,gBAAA1B,EAAAyB,MAAA,aAAAzB,EAAAyB,KAAA,KAAAqC,KAAA9D,EAAA0B,IAAA,WAAA1B,EAAAyB,MAAA,KAAAiE,KAAA,KAAAhE,IAAA1B,EAAA0B,IAAA,KAAA2B,OAAA,cAAAS,KAAA,kBAAA9D,EAAAyB,MAAA1B,IAAA,KAAA+D,KAAA/D,GAAAiC,CAAA,EAAA6D,OAAA,SAAA7F,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAkE,aAAAnE,EAAA,YAAA4F,SAAA3F,EAAAsE,WAAAtE,EAAAmE,UAAAE,EAAArE,GAAA+B,CAAA,kBAAAhC,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAgE,SAAAjE,EAAA,KAAAG,EAAAF,EAAAsE,WAAA,aAAApE,EAAAsB,KAAA,KAAApB,EAAAF,EAAAuB,IAAA4C,EAAArE,EAAA,QAAAI,CAAA,QAAA8C,MAAA,0BAAA2C,cAAA,SAAA/F,EAAAE,EAAAE,GAAA,YAAAmD,SAAA,CAAA5C,SAAA6B,EAAAxC,GAAA8D,WAAA5D,EAAA8D,QAAA5D,GAAA,cAAAkD,SAAA,KAAA3B,IAAA1B,GAAAgC,CAAA,GAAAjC,CAAA,UAAAgG,EAAA5F,EAAAH,EAAAD,EAAAE,EAAAI,EAAAI,EAAAE,GAAA,QAAAvB,EAAAe,EAAAM,GAAAE,GAAAE,EAAAzB,EAAAmB,KAAA,OAAAJ,GAAA,YAAAJ,EAAAI,EAAA,CAAAf,EAAAgE,KAAApD,EAAAa,GAAAsE,QAAApC,QAAAlC,GAAAoC,KAAAhD,EAAAI,EAAA,UAAA2F,EAAA7F,GAAA,sBAAAH,EAAA,KAAAD,EAAAlB,UAAA,WAAAsG,SAAA,SAAAlF,EAAAI,GAAA,IAAAI,EAAAN,EAAAvB,MAAAoB,EAAAD,GAAA,SAAAkG,EAAA9F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,OAAA/F,EAAA,UAAA+F,EAAA/F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,QAAA/F,EAAA,CAAA8F,OAAA,OAEA,IAAMyL,EAA2BrK,SAASC,cAAc,mBAAmB4F,UAI3E7F,SAASC,cAAc,sBAAsBlJ,iBAAiB,SAAS,WACtE,IAAIuT,EAAiBtK,SAASqC,eAAe,gBACzCkI,EAAUvK,SAASC,cAAc,sBACjCyC,EAAqB1C,SAASqC,eAAe,sBAC7CmI,EAAmBxK,SAASqC,eAAe,oBAC3C4H,EAAcjK,SAASqC,eAAe,eACtCoI,EAAsBzK,SAASC,cAAc,0BAG7CyK,EAAe1K,SAASqC,eAAe,kBACtCqI,EAAaxK,UAAUsB,SAAS,YACpCkJ,EAAa7E,UAAYwE,EACzBM,IACAD,EAAaxK,UAAUI,IAAI,WAG5BgK,EAAepK,UAAUC,OAAO,UAChCqK,EAAiBtK,UAAUC,OAAO,UAClCuC,EAAmBxC,UAAUI,IAAI,UACjC2J,EAAY/J,UAAUI,IAAI,UACtBgK,EAAepK,UAAUsB,SAAS,SACrC8I,EAAepK,UAAUC,OAAO,QAGjCsK,EAAoBvH,cAAcsE,OAAQiD,EAAoBvH,cAAcsE,MAAO,GAEnF+C,EAAQrK,UAAUI,IAAI,SACvB,IAEAN,SAASqC,eAAe,gBAAgBtL,iBAAiB,SAAS,SAACC,GAElE,IAAIsT,EAAiBtK,SAASqC,eAAe,gBACzCuI,EAAmB5K,SAASqC,eAAe,kBAC3CwI,EAAkB7K,SAASC,cAAc,wBACzC6K,EAAe9K,SAASqC,eAAe,mBACvCkI,EAAUvK,SAASC,cAAc,sBAGrCqK,EAAepK,UAAU6K,OAAO,UAChCT,EAAepK,UAAU6K,OAAO,QAE5BH,EAAiB1K,UAAUsB,SAAS,WACvCoJ,EAAiB1K,UAAUC,OAAO,UAClCoK,EAAQrK,UAAUC,OAAO,UACzB2K,EAAaE,QACbH,EAAgBrF,UAAY,IAE5BoF,EAAiB1K,UAAUI,IAAI,UAC/BiK,EAAQrK,UAAUI,IAAI,UAExB,IAEAN,SAASqC,eAAe,oBAAoBtL,iBAAiB,SAAS,WACrE,IAAIwT,EAAUvK,SAASC,cAAc,sBACjCyC,EAAqB1C,SAASqC,eAAe,sBAC7CmI,EAAmBxK,SAASqC,eAAe,oBAE3CK,EAAmBxC,UAAUsB,SAAS,WACzCkB,EAAmBxC,UAAUC,OAAO,UACpCoK,EAAQrK,UAAUC,OAAO,UACzBqK,EAAiBtK,UAAUI,IAAI,YAE/BoC,EAAmBxC,UAAUI,IAAI,UACjCiK,EAAQrK,UAAUI,IAAI,UACtBkK,EAAiBtK,UAAUC,OAAO,UAEpC,IAEAH,SAASqC,eAAe,YAAYtL,iBAAiB,SAAS,SAAC2B,GAC9DA,EAAEuS,iBACF,IAAIC,EAAWlL,SAASqC,eAAe,aAEnCsC,EAAMwG,UAAUC,SAASF,EAAShS,OAItC,GAHAgS,EAAShS,MAAQ,GACjBgS,EAASF,QAELrG,EAAI/M,OAAS,EAChB,GAAIoI,SAASC,cAAc,sBAAuB,CACjD,IAAImD,EAAapD,SAASC,cAAc,sBAAsB0B,QAAQC,GACtEyJ,EAAAA,kBAAgCjI,EAAYuB,EAC7C,MAAO,GAAI3E,SAASC,cAAc,uBAAwB,CACzD,IAAIqL,EAAUtL,SAASC,cAAc,uBAAuB0B,QAAQC,GACpE2J,EAAAA,uBAA0CD,EAAS3G,EACpD,CAEF,IAEA3E,SAASqC,eAAe,aAAatL,iBAAiB,WAAW,SAACC,GACjE,IAAIkU,EAAWlL,SAASqC,eAAe,aAEvC,GAAkB,UAAdrL,EAAML,KAAoBK,EAAMwU,UAgB7B,GAAIxU,EAAMwU,UAA0B,UAAdxU,EAAML,IAAiB,CACnDK,EAAMiU,iBACN,IAAMQ,EAAQP,EAASQ,eACjB3L,EAAOmL,EAAShS,MAEtBgS,EAAShS,MAAQ6G,EAAK1H,MAAM,EAAGoT,GAAS,KAAO1L,EAAK1H,MAAMoT,GAC1DP,EAASS,aAAeF,EAAQ,CACjC,MAvB8C,CAC7CzU,EAAMiU,iBAEN,IAAItG,EAAMwG,UAAUC,SAASF,EAAShS,OAItC,GAHAgS,EAAShS,MAAQ,GACjBgS,EAASF,QAELrG,EAAI/M,OAAS,EAChB,GAAIoI,SAASC,cAAc,sBAAuB,CACjD,IAAImD,EAAapD,SAASC,cAAc,sBAAsB0B,QAAQC,GACtEyJ,EAAAA,kBAAgCjI,EAAYuB,EAC7C,MAAO,GAAI3E,SAASC,cAAc,uBAAwB,CACzD,IAAIqL,EAAUtL,SAASC,cAAc,uBAAuB0B,QAAQC,GACpE2J,EAAAA,uBAA0CD,EAAS3G,EACpD,CAEF,CAQD,IAEA3E,SAASC,cAAc,sBAAsBlJ,iBAAiB,SAAS,SAACC,GAEvE,GAAIA,EAAMkT,OAAO0B,QAAQ,mBAAoB,CAC5C,IACMjH,EADe3N,EAAMkT,OAAO0B,QAAQ,mBACjB1I,cACrBlD,SAASC,cAAc,sBAC1BoL,EAAAA,cAA4B1G,GAClB3E,SAASC,cAAc,wBACjCsL,EAAAA,mBAAsC5G,EAExC,CACD,IAGA3E,SAASC,cAAc,wBAAwBlJ,iBAAiB,SAAS,WACxEsU,EAAAA,oBACD,IAGArL,SAASC,cAAc,kBAAkBlJ,iBAAiB,SAAS,WAClEsU,EAAAA,iBAA+BrL,SAASC,cAAc,kBACvD,IAEAD,SAASC,cAAc,wBAAwBlJ,iBAAiB,SAAS,WACxE8U,WAAWC,WACZ,IAGA9L,SAASC,cAAc,0BAA0BlJ,iBAAiB,SAAS,WAC1E,IAAMgV,EAAkB/L,SAASC,cAAc,8BAE/CqD,MAAM,mBACJ1H,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAGNkI,EAAgBlK,IAAMgC,EAAK9B,MAC5B,IAAE,OACK,SAACsC,GACPC,QAAQC,IAAI,4BAA6BF,EAC1C,GACF,IAGArE,SAASC,cAAc,iCAAiClJ,iBAAiB,SAAS,WACjF,IAAIyG,EAAO2N,UAAUC,SAASpL,SAASC,cAAc,wBAAwB/G,OACzEwI,EAAWyJ,UAAUC,SAASpL,SAASC,cAAc,4BAA4B/G,OAC/E8S,EAASb,UAAUC,SAASpL,SAASC,cAAc,yCAAyC/G,OAC9F6I,EAAS/B,SAASC,cAAc,8BAA8B4B,IAC5DoK,EAAYd,UAAUC,SAASpL,SAASC,cAAc,2BAA2B/G,OAEvFoK,MAAM,sBAAuB,CAC5BtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,mBAChB,eAAgB0I,GAEjBzI,KAAMC,KAAKC,UAAU,CACpBlG,KAAAA,EACAkE,SAAAA,EACAsK,OAAAA,EACAjK,OAAAA,MAGAnG,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACFA,EAAKqI,UACRlM,SAASC,cAAc,wBAAwB/G,MAAQ2K,EAAKsI,KAAK3O,KACjEwC,SAASC,cAAc,4BAA4B/G,MAAQ2K,EAAKsI,KAAKzK,SACrE1B,SAASC,cAAc,wBAAwB4B,IAAMgC,EAAKsI,KAAKpK,QAG3C,2BAAjB8B,EAAKuB,UACR1D,EAAStB,YAAcyD,EAAKsI,KAAKzK,UAGlC2J,EAAAA,iBAA+BxH,EAAKuB,QACrC,IAAE,OACK,SAACf,GACPC,QAAQC,IAAI,8BAA+BF,GAC3CgH,EAAAA,iBAA+B,oEAChC,GACF,IAGArL,SAASC,cAAc,sBAAsBlJ,iBAAiB,SAAS,SAACC,GAGnEA,EAAMkT,OAAO0B,QAAQ,kBACxBP,EAAAA,gBAA8BrU,EAAMkT,OAAO0B,QAAQ,iBAErD,IAIA5L,SAASC,cAAc,gBAAgBlJ,iBAAiB,SAAS,SAACC,GAC7DA,EAAMkT,OAAO0B,QAAQ,eACxBP,EAAAA,YAA0BrU,EAAMkT,OAAO0B,QAAQ,gBACrC5U,EAAMkT,OAAO0B,QAAQ,iBAC/BL,EAAAA,iBAAoCvU,EAAMkT,OAAO0B,QAAQ,gBAE3D,IAGA5L,SAASC,cAAc,2BAA2BlJ,iBAAiB,SAAS,WAC3E,IAAIuU,EAAUtL,SAASC,cAAc,uBAAuB0B,QAAQC,GAEpE0B,MAAM,yCAA0C,CAC/CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpB4H,QAAAA,MAGA1P,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACN,GAAIA,EAAKqI,QAAS,CACAlM,SAASC,cAAc,yBAADJ,OAA0ByL,EAAO,OAC7DnL,SAEXH,SAASC,cAAc,sBAAsB4H,QAE7C,IAAItF,EAAYvC,SAASqC,eAAe,cACpCD,EAAWpC,SAASqC,eAAe,aACnCC,EAAWtC,SAASqC,eAAe,aAEvCE,EAAUrC,UAAUI,IAAI,UACxB8B,EAASlC,UAAUI,IAAI,UACvBgC,EAASpC,UAAUI,IAAI,UAEvB,IAAIuG,EAAQ7G,SAASC,cAAc,UACnC4G,EAAMtF,SAAS,GAAGnB,YAAc,yBAChCyG,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,SACrB,GAAG,IACJ,CACD,IAAE,OACK,SAAC+D,GACPC,QAAQC,IAAI,wCAAyCF,EACtD,GACF,IAGArE,SAASC,cAAc,0BAA0BlJ,iBAAiB,SAAS,WAE1E,IADeiJ,SAASC,cAAc,0BAA0BiD,cACnDsE,KAAb,CAIA,IAAI8D,EAAUtL,SAASC,cAAc,uBAAuB0B,QAAQC,GAEpE0B,MAAM,oCAAqC,CAC1CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpB4H,QAAAA,MAGA1P,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACN,GAAIA,EAAKqI,QAAS,CACjB,IAAIE,EAAevI,EAAKuI,aACpBC,EAAqBrM,SAASC,cAAc,sBAChDoM,EAAmBjM,YAAc,GACjC,IAAIkM,EAAcF,EAAaxU,OACVyU,EAAmBE,uBAAuBtM,cAAc,QAC9DG,YAAckM,EAC7BF,EAAa/Q,SAAQ,SAACmR,GACrB,IAAIC,EAAclB,EAAAA,qBAAwCiB,GAC1DH,EAAmBlI,YAAYsI,EAChC,GACD,KAAO,CACN,IAAI5F,EAAQ7G,SAASC,cAAc,UAC/B6G,EAAYD,EAAM5G,cAAc,QACpC6G,EAAU1G,YAAc,2DACxByG,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,UACpBwG,EAAU1G,YAAc,EACzB,GAAG,IACJ,CACD,IAAE,OACK,SAACiE,GACPC,QAAQC,IAAI,mCAAoCF,EACjD,GAvCD,CAwCD,IAGArE,SAASC,cAAc,wBAAwBlJ,iBAAiB,SAAS,WACxE,IAAI2V,EAAc1M,SAASC,cAAc,wBACzCyM,EAAY/K,QAAQwB,IAAM,SAC1B,IAAIwJ,EAAiB3M,SAASC,cAAc,uBAAuB0B,QAAQC,GAC3EgL,UAAUC,UAAUC,UAAU,GAADjN,OACzBkN,wBAAkB,2CAAAlN,OAA0CmN,mBAAmBL,KAGnFtM,YAAW,WACVqM,EAAY/K,QAAQwB,IAAM,iBAC3B,GAAG,IACJ,IAGA,IAAMwH,EAAuC,WAE5C3K,SAASC,cAAc,iBAAiBlJ,iBAAiB,SAAS,WACjE,IAAIkW,EAAajN,SAASC,cAAc,iBACpCiN,EAAclN,SAASC,cAAc,kBACrCkN,EAAoBnN,SAASC,cAAc,yBAC3CmN,EAAqBpN,SAASC,cAAc,kCAEhDgN,EAAW/M,UAAUsB,SAAS,eAAuByL,EAAW/M,UAAUI,IAAI,cAC9E4M,EAAYhN,UAAUsB,SAAS,eAAgB0L,EAAYhN,UAAUC,OAAO,cAE5EgN,EAAkBjN,UAAUsB,SAAS,WAAY2L,EAAkBjN,UAAUC,OAAO,WACpFiN,EAAmBlN,UAAUsB,SAAS,WAAmB4L,EAAmBlN,UAAUI,IAAI,SAC3F,IAEAN,SAASC,cAAc,kBAAkBlJ,iBAAiB,SAAS,WAClE,IAAIkW,EAAajN,SAASC,cAAc,iBACpCiN,EAAclN,SAASC,cAAc,kBACrCkN,EAAoBnN,SAASC,cAAc,yBAC3CmN,EAAqBpN,SAASC,cAAc,iCAEhDgN,EAAW/M,UAAUsB,SAAS,eAAgByL,EAAW/M,UAAUC,OAAO,eAC1E+M,EAAYhN,UAAUsB,SAAS,eAAuB0L,EAAYhN,UAAUI,IAAI,eAEhF6M,EAAkBjN,UAAUsB,SAAS,WAAmB2L,EAAkBjN,UAAUI,IAAI,UACxF8M,EAAmBlN,UAAUsB,SAAS,WAAY4L,EAAmBlN,UAAUC,OAAO,SACvF,IAGAH,SAASqC,eAAe,mBAAmBtL,iBAAiB,QAAO,eAAAyJ,EAAA7B,EAAAlG,IAAAgF,MAAE,SAAAgD,EAAOzJ,GAAK,IAAAqW,EAAAC,EAAAzJ,EAAA0J,EAAA,OAAA9U,IAAAqB,MAAA,SAAAwH,GAAA,cAAAA,EAAApD,KAAAoD,EAAA7E,MAAA,OAId,GAHlEzF,EAAMiU,iBAAgB3J,EAAApD,KAAA,EAEfmP,EAAYrW,EAAMkT,OAAOhR,MAAMsU,cAC/BF,EAActN,SAASyH,iBAAiB,oBAC5B,KAAd4F,EAAgB,CAAA/L,EAAA7E,KAAA,QACnB6Q,EAAYjS,SAAQ,SAACqM,GACpBA,EAAOxH,UAAUsB,SAAS,WAAYkG,EAAOxH,UAAUC,OAAO,SAC/D,IAAEmB,EAAA7E,KAAA,uBAAA6E,EAAA7E,KAAA,GAEiB8O,EAAAA,aAAgC8B,GAAU,QAClC,KADrBxJ,EAAIvC,EAAAnF,MACDsR,OAAO7V,OACf0V,EAAYjS,SAAQ,SAACqM,IACpBA,EAAOxH,UAAUsB,SAAS,WAAmBkG,EAAOxH,UAAUI,IAAI,SACnE,KAEMiN,EAAuB1J,EAAK4J,OAAOC,KAAI,SAAChG,GAAM,OAAKA,EAAOhG,QAAQ,IACxE4L,EAAYjS,SAAQ,SAACqM,GACpB,IAAMiG,EAAiBjG,EAAOzH,cAAc,6BAA6BwB,UAAUmM,OAC/EL,EAAqBM,SAASF,GACjCjG,EAAOxH,UAAUC,OAAO,UAExBuH,EAAOxH,UAAUI,IAAI,SAEvB,KACA,QAAAgB,EAAA7E,KAAA,iBAAA6E,EAAApD,KAAA,GAAAoD,EAAAwM,GAAAxM,EAAA,SAGFgD,QAAQC,IAAI,8BAA6BjD,EAAAwM,IAAQ,yBAAAxM,EAAAlD,OAAA,GAAAqC,EAAA,mBAElD,gBAAAyB,GAAA,OAAA1B,EAAAjJ,MAAA,KAAAC,UAAA,EA9BkE,IAiCnEwI,SAASC,cAAc,wBAAwBlJ,iBAAiB,SAAS,SAACC,GACrEA,EAAMkT,OAAO0B,QAAQ,qBACxBP,EAAAA,gBAA8BrU,EAAMkT,OAAO0B,QAAQ,oBAErD,IAGA5L,SAASC,cAAc,8BAA8BlJ,iBACpD,SACA,SAACC,GACqBgJ,SAASC,cAAc,8BAC7B8N,YAAc/W,EAAMgX,MACpC,GACA,CAAEC,SAAS,IAIZjO,SAASC,cAAc,uBAAuBlJ,iBAAiB,SAAS,WACvEiJ,SAASC,cAAc,6BAA6BC,UAAUC,OAAO,UACrEH,SAASC,cAAc,0BAA0BC,UAAUI,IAAI,SAChE,IAGAN,SAASqC,eAAe,oBAAoBtL,iBAAiB,QAAO,eAAAsP,EAAA1H,EAAAlG,IAAAgF,MAAE,SAAA6I,EAAOtP,GAAK,IAAAqW,EAAAC,EAAAzJ,EAAA0J,EAAA,OAAA9U,IAAAqB,MAAA,SAAAsN,GAAA,cAAAA,EAAAlJ,KAAAkJ,EAAA3K,MAAA,OAId,GAHnEzF,EAAMiU,iBAAgB7D,EAAAlJ,KAAA,EAEfmP,EAAYrW,EAAMkT,OAAOhR,MAAMsU,cAC/BF,EAActN,SAASyH,iBAAiB,qBAC5B,KAAd4F,EAAgB,CAAAjG,EAAA3K,KAAA,QACnB6Q,EAAYjS,SAAQ,SAACqM,GACpBA,EAAOxH,UAAUsB,SAAS,WAAYkG,EAAOxH,UAAUC,OAAO,SAC/D,IAAEiH,EAAA3K,KAAA,uBAAA2K,EAAA3K,KAAA,GAEiB8O,EAAAA,aAAgC8B,GAAU,QAClC,KADrBxJ,EAAIuD,EAAAjL,MACDsR,OAAO7V,OACf0V,EAAYjS,SAAQ,SAACqM,IACpBA,EAAOxH,UAAUsB,SAAS,WAAmBkG,EAAOxH,UAAUI,IAAI,SACnE,KAEMiN,EAAuB1J,EAAK4J,OAAOC,KAAI,SAAChG,GAAM,OAAKA,EAAOhG,QAAQ,IACxE4L,EAAYjS,SAAQ,SAACqM,GACpB,IAAMiG,EAAiBjG,EAAOzH,cAAc,8BAA8BwB,UAAUmM,OAChFL,EAAqBM,SAASF,GACjCjG,EAAOxH,UAAUC,OAAO,UAExBuH,EAAOxH,UAAUI,IAAI,SAEvB,KACA,QAAA8G,EAAA3K,KAAA,iBAAA2K,EAAAlJ,KAAA,GAAAkJ,EAAA0G,GAAA1G,EAAA,SAGF9C,QAAQC,IAAI,8BAA6B6C,EAAA0G,IAAQ,yBAAA1G,EAAAhJ,OAAA,GAAAkI,EAAA,mBAElD,gBAAAwB,GAAA,OAAAzB,EAAA9O,MAAA,KAAAC,UAAA,EA9BmE,IAiCpEwI,SAASC,cAAc,yBAAyBlJ,iBAAiB,SAAS,SAACC,GAC1E,IAAIA,EAAMkT,OAAOhK,UAAUsB,SAAS,wBAApC,CAIA,IAAI0M,EAAW,KACXC,EAAuBnO,SAASC,cAAc,qCAC9CmO,EAAiBpO,SAASC,cAAc,8BACxCoO,EAAiBrX,EAAMkT,OAAO0B,QAAQ,qBAa1C,GAVI5U,EAAMkT,OAAO0B,QAAQ,uBAExBsC,EAAWlX,EAAMkT,OAAO0B,QAAQ,qBAAqB3L,cAAc,sCAE9DiO,IAAalX,EAAMkT,SACtBgE,EAASI,SAAWJ,EAASI,SAK5BJ,GAAYA,EAASI,QAAS,CACjCH,EAAqBjO,UAAUsB,SAAS,WAAY2M,EAAqBjO,UAAUC,OAAO,UAC1FH,SAASC,cAAc,yBAAyBC,UAAUyC,QAAQ,OAAQ,QAE1E,IAAI4L,EAAoBvO,SAAS+E,cAAc,OAC/CwJ,EAAkBrO,UAAUI,IAAI,UAChCiO,EAAkB5M,QAAQC,GAAKyM,EAAe1M,QAAQC,GACtD,IAAI4M,EAAyBxO,SAAS+E,cAAc,OACpDyJ,EAAuBtO,UAAUI,IAAI,OAAQ,OAAQ,gBACrD,IAAImO,EAAoBzO,SAAS+E,cAAc,OAC/C0J,EAAkB5M,IAAMwM,EAAepO,cAAc,OAAO4B,IAC5D4M,EAAkBC,IAAML,EAAepO,cAAc,OAAOyO,IAE5DF,EAAuBrK,YAAYsK,GACnCF,EAAkBpK,YAAYqK,GAC9BJ,EAAejK,YAAYoK,EAC5B,KAAO,CACN,IACoCI,EADWC,EAAAC,EAAvBT,EAAe7M,UACH,IAApC,IAAAqN,EAAAlU,MAAAiU,EAAAC,EAAA9V,KAAAiD,MAAsC,KAA7B2L,EAAMiH,EAAAzV,MAGVwO,EAAOzH,cAAc,OAAOyO,MAAQL,EAAepO,cAAc,OAAOyO,KAC3EhH,EAAOvH,QAET,CAAC,OAAAkE,GAAAuK,EAAAlW,EAAA2L,EAAA,SAAAuK,EAAAnU,GAAA,CAEsC,IAAnC2T,EAAe7M,SAAS3J,UAC3BuW,EAAqBjO,UAAUsB,SAAS,WAAmB2M,EAAqBjO,UAAUI,IAAI,UAC9FN,SAASC,cAAc,yBAAyBC,UAAUyC,QAAQ,OAAQ,QAE5E,CAhDA,CAiDD,IAGA3C,SAASC,cAAc,4BAA4BlJ,iBAAiB,SAAS,WAC5E,IAAI+X,EAAc9O,SAASC,cAAc,iBAEzCqD,MAAM,yBACJ1H,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAENiL,EAAYjN,IAAMgC,EAAKiL,WACxB,IAAE,OACK,SAACzK,GACPC,QAAQC,IAAI,kCAAmCF,EAChD,GACF,IAGArE,SAASC,cAAc,mBAAmBlJ,iBAAiB,SAAS,WACnEiJ,SAASC,cAAc,6BAA6BC,UAAUI,IAAI,UAClEN,SAASC,cAAc,0BAA0BC,UAAUC,OAAO,SACnE,IAGAH,SAASC,cAAc,qBAAqBlJ,iBAAiB,QAAO4H,EAAAlG,IAAAgF,MAAE,SAAA6K,IAAA,IAAAyG,EAAAC,EAAAC,EAAAH,EAAA,OAAArW,IAAAqB,MAAA,SAAAyO,GAAA,cAAAA,EAAArK,KAAAqK,EAAA9L,MAAA,OAOR,GALzDsS,EAAkB5W,MAAMgQ,KAAKnI,SAASC,cAAc,8BAA8BsB,UAAUmM,KAC/F,SAAClB,GAAM,OAAKA,EAAO7K,QAAQC,EAAE,IAE1BoN,EAAY7D,UAAUC,SAASpL,SAASC,cAAc,eAAe/G,OACrE+V,EAAmB9D,UAAUC,SAASpL,SAASC,cAAc,sBAAsB/G,OACnF4V,EAAc9O,SAASC,cAAc,iBAAiB4B,IAExC,KAAdmN,GAAyC,KAArBC,EAAuB,CAAA1G,EAAA9L,KAAA,QAC2B,OAAzE4O,EAAAA,iBAA+B,2CAA0C9C,EAAAjM,OAAA,wBAAAiM,EAAA9L,KAAA,EAIpE6G,MAAM,+BAAgC,CAC3CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpBqL,gBAAAA,EACAC,UAAAA,EACAC,iBAAAA,EACAH,YAAAA,MAGAlT,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GAEFA,EAAKqI,SACRb,EAAAA,iBAA+B,8BAG/BrL,SAASC,cAAc,mBAAmB4F,UAAYwE,EAGtDrK,SAASC,cAAc,sBAAsB4H,QAE7C0D,EAAAA,oBAAuC1H,EAAKqL,YAE5C7D,EAAAA,iBAA+B,6CAEjC,IAAE,OACK,SAAChH,GACPC,QAAQC,IAAI,4BAA6BF,GACzCgH,EAAAA,iBAA+B,kEAChC,IAAE,wBAAA9C,EAAAnK,OAAA,GAAAkK,EAAA,KAEL,EAEAqC,G,opBC7jBAlS,EAAA,kBAAAC,CAAA,MAAAC,EAAAD,EAAA,GAAAE,EAAAC,OAAAjC,UAAAkC,EAAAF,EAAAG,eAAAC,EAAAH,OAAAI,gBAAA,SAAAN,EAAAD,EAAAE,GAAAD,EAAAD,GAAAE,EAAAM,KAAA,EAAAnB,EAAA,mBAAAoB,OAAAA,OAAA,GAAAC,EAAArB,EAAAsB,UAAA,aAAAC,EAAAvB,EAAAwB,eAAA,kBAAAC,EAAAzB,EAAA0B,aAAA,yBAAAC,EAAAf,EAAAD,EAAAE,GAAA,OAAAC,OAAAI,eAAAN,EAAAD,EAAA,CAAAQ,MAAAN,EAAAe,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAlB,EAAAD,EAAA,KAAAgB,EAAA,aAAAf,GAAAe,EAAA,SAAAf,EAAAD,EAAAE,GAAA,OAAAD,EAAAD,GAAAE,CAAA,WAAAkB,EAAAnB,EAAAD,EAAAE,EAAAE,GAAA,IAAAf,EAAAW,GAAAA,EAAA9B,qBAAAmD,EAAArB,EAAAqB,EAAAX,EAAAP,OAAAmB,OAAAjC,EAAAnB,WAAA0C,EAAA,IAAAW,EAAAnB,GAAA,WAAAE,EAAAI,EAAA,WAAAF,MAAAgB,EAAAvB,EAAAC,EAAAU,KAAAF,CAAA,UAAAe,EAAAxB,EAAAD,EAAAE,GAAA,WAAAwB,KAAA,SAAAC,IAAA1B,EAAA2B,KAAA5B,EAAAE,GAAA,OAAAD,GAAA,OAAAyB,KAAA,QAAAC,IAAA1B,EAAA,EAAAD,EAAAoB,KAAAA,EAAA,IAAAS,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,EAAA,YAAAZ,IAAA,UAAAa,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAApB,EAAAoB,EAAA1B,GAAA,8BAAA2B,EAAAlC,OAAAmC,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAArC,GAAAE,EAAAwB,KAAAW,EAAA7B,KAAA0B,EAAAG,GAAA,IAAAE,EAAAN,EAAAjE,UAAAmD,EAAAnD,UAAAiC,OAAAmB,OAAAc,GAAA,SAAAM,EAAAzC,GAAA,0BAAA0C,SAAA,SAAA3C,GAAAgB,EAAAf,EAAAD,GAAA,SAAAC,GAAA,YAAA2C,QAAA5C,EAAAC,EAAA,gBAAA4C,EAAA5C,EAAAD,GAAA,SAAA8C,EAAA5C,EAAAI,EAAAjB,EAAAqB,GAAA,IAAAE,EAAAa,EAAAxB,EAAAC,GAAAD,EAAAK,GAAA,aAAAM,EAAAc,KAAA,KAAAZ,EAAAF,EAAAe,IAAAE,EAAAf,EAAAN,MAAA,OAAAqB,GAAA,UAAAkB,EAAAlB,IAAAzB,EAAAwB,KAAAC,EAAA,WAAA7B,EAAAgD,QAAAnB,EAAAoB,SAAAC,MAAA,SAAAjD,GAAA6C,EAAA,OAAA7C,EAAAZ,EAAAqB,EAAA,aAAAT,GAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAV,EAAAgD,QAAAnB,GAAAqB,MAAA,SAAAjD,GAAAa,EAAAN,MAAAP,EAAAZ,EAAAyB,EAAA,aAAAb,GAAA,OAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAA,EAAAE,EAAAe,IAAA,KAAAzB,EAAAI,EAAA,gBAAAE,MAAA,SAAAP,EAAAG,GAAA,SAAA+C,IAAA,WAAAnD,GAAA,SAAAA,EAAAE,GAAA4C,EAAA7C,EAAAG,EAAAJ,EAAAE,EAAA,WAAAA,EAAAA,EAAAA,EAAAgD,KAAAC,EAAAA,GAAAA,GAAA,aAAA3B,EAAAxB,EAAAE,EAAAE,GAAA,IAAAE,EAAAuB,EAAA,gBAAAxC,EAAAqB,GAAA,GAAAJ,IAAAyB,EAAA,MAAAqB,MAAA,mCAAA9C,IAAA0B,EAAA,cAAA3C,EAAA,MAAAqB,EAAA,OAAAF,MAAAP,EAAAoD,MAAA,OAAAjD,EAAAkD,OAAAjE,EAAAe,EAAAuB,IAAAjB,IAAA,KAAAE,EAAAR,EAAAmD,SAAA,GAAA3C,EAAA,KAAAE,EAAA0C,EAAA5C,EAAAR,GAAA,GAAAU,EAAA,IAAAA,IAAAmB,EAAA,gBAAAnB,CAAA,cAAAV,EAAAkD,OAAAlD,EAAAqD,KAAArD,EAAAsD,MAAAtD,EAAAuB,SAAA,aAAAvB,EAAAkD,OAAA,IAAAhD,IAAAuB,EAAA,MAAAvB,EAAA0B,EAAA5B,EAAAuB,IAAAvB,EAAAuD,kBAAAvD,EAAAuB,IAAA,gBAAAvB,EAAAkD,QAAAlD,EAAAwD,OAAA,SAAAxD,EAAAuB,KAAArB,EAAAyB,EAAA,IAAAK,EAAAX,EAAAzB,EAAAE,EAAAE,GAAA,cAAAgC,EAAAV,KAAA,IAAApB,EAAAF,EAAAiD,KAAArB,EAAAF,EAAAM,EAAAT,MAAAM,EAAA,gBAAAzB,MAAA4B,EAAAT,IAAA0B,KAAAjD,EAAAiD,KAAA,WAAAjB,EAAAV,OAAApB,EAAA0B,EAAA5B,EAAAkD,OAAA,QAAAlD,EAAAuB,IAAAS,EAAAT,IAAA,YAAA6B,EAAAxD,EAAAE,GAAA,IAAAE,EAAAF,EAAAoD,OAAAhD,EAAAN,EAAAW,SAAAP,GAAA,GAAAE,IAAAL,EAAA,OAAAC,EAAAqD,SAAA,eAAAnD,GAAAJ,EAAAW,SAAA,SAAAT,EAAAoD,OAAA,SAAApD,EAAAyB,IAAA1B,EAAAuD,EAAAxD,EAAAE,GAAA,UAAAA,EAAAoD,SAAA,WAAAlD,IAAAF,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAAzD,EAAA,aAAA6B,EAAA,IAAA5C,EAAAoC,EAAAnB,EAAAN,EAAAW,SAAAT,EAAAyB,KAAA,aAAAtC,EAAAqC,KAAA,OAAAxB,EAAAoD,OAAA,QAAApD,EAAAyB,IAAAtC,EAAAsC,IAAAzB,EAAAqD,SAAA,KAAAtB,EAAA,IAAAvB,EAAArB,EAAAsC,IAAA,OAAAjB,EAAAA,EAAA2C,MAAAnD,EAAAF,EAAA8D,YAAApD,EAAAF,MAAAN,EAAA6D,KAAA/D,EAAAgE,QAAA,WAAA9D,EAAAoD,SAAApD,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,GAAAC,EAAAqD,SAAA,KAAAtB,GAAAvB,GAAAR,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAA3D,EAAAqD,SAAA,KAAAtB,EAAA,UAAAgC,EAAAhE,GAAA,IAAAD,EAAA,CAAAkE,OAAAjE,EAAA,SAAAA,IAAAD,EAAAmE,SAAAlE,EAAA,SAAAA,IAAAD,EAAAoE,WAAAnE,EAAA,GAAAD,EAAAqE,SAAApE,EAAA,SAAAqE,WAAA5F,KAAAsB,EAAA,UAAAuE,EAAAtE,GAAA,IAAAD,EAAAC,EAAAuE,YAAA,GAAAxE,EAAA0B,KAAA,gBAAA1B,EAAA2B,IAAA1B,EAAAuE,WAAAxE,CAAA,UAAAuB,EAAAtB,GAAA,KAAAqE,WAAA,EAAAJ,OAAA,SAAAjE,EAAA0C,QAAAsB,EAAA,WAAAQ,OAAA,YAAAjC,EAAAxC,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAE,EAAAF,EAAAU,GAAA,GAAAR,EAAA,OAAAA,EAAA0B,KAAA5B,GAAA,sBAAAA,EAAA+D,KAAA,OAAA/D,EAAA,IAAA0E,MAAA1E,EAAAd,QAAA,KAAAoB,GAAA,EAAAjB,EAAA,SAAA0E,IAAA,OAAAzD,EAAAN,EAAAd,QAAA,GAAAkB,EAAAwB,KAAA5B,EAAAM,GAAA,OAAAyD,EAAAvD,MAAAR,EAAAM,GAAAyD,EAAAV,MAAA,EAAAU,EAAA,OAAAA,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,SAAA1E,EAAA0E,KAAA1E,CAAA,YAAAwE,UAAAd,EAAA/C,GAAA,2BAAAkC,EAAAhE,UAAAiE,EAAA7B,EAAAmC,EAAA,eAAAjC,MAAA2B,EAAAjB,cAAA,IAAAZ,EAAA6B,EAAA,eAAA3B,MAAA0B,EAAAhB,cAAA,IAAAgB,EAAAyC,YAAA3D,EAAAmB,EAAArB,EAAA,qBAAAd,EAAA4E,oBAAA,SAAA3E,GAAA,IAAAD,EAAA,mBAAAC,GAAAA,EAAA4E,YAAA,QAAA7E,IAAAA,IAAAkC,GAAA,uBAAAlC,EAAA2E,aAAA3E,EAAA8E,MAAA,EAAA9E,EAAA+E,KAAA,SAAA9E,GAAA,OAAAE,OAAA6E,eAAA7E,OAAA6E,eAAA/E,EAAAkC,IAAAlC,EAAAgF,UAAA9C,EAAAnB,EAAAf,EAAAa,EAAA,sBAAAb,EAAA/B,UAAAiC,OAAAmB,OAAAmB,GAAAxC,CAAA,EAAAD,EAAAkF,MAAA,SAAAjF,GAAA,OAAAgD,QAAAhD,EAAA,EAAAyC,EAAAG,EAAA3E,WAAA8C,EAAA6B,EAAA3E,UAAA0C,GAAA,0BAAAZ,EAAA6C,cAAAA,EAAA7C,EAAAmF,MAAA,SAAAlF,EAAAC,EAAAE,EAAAE,EAAAjB,QAAA,IAAAA,IAAAA,EAAA+F,SAAA,IAAA1E,EAAA,IAAAmC,EAAAzB,EAAAnB,EAAAC,EAAAE,EAAAE,GAAAjB,GAAA,OAAAW,EAAA4E,oBAAA1E,GAAAQ,EAAAA,EAAAqD,OAAAb,MAAA,SAAAjD,GAAA,OAAAA,EAAAoD,KAAApD,EAAAO,MAAAE,EAAAqD,MAAA,KAAArB,EAAAD,GAAAzB,EAAAyB,EAAA3B,EAAA,aAAAE,EAAAyB,EAAA/B,GAAA,0BAAAM,EAAAyB,EAAA,qDAAAzC,EAAAqF,KAAA,SAAApF,GAAA,IAAAD,EAAAG,OAAAF,GAAAC,EAAA,WAAAE,KAAAJ,EAAAE,EAAAxB,KAAA0B,GAAA,OAAAF,EAAAoF,UAAA,SAAAvB,IAAA,KAAA7D,EAAAhB,QAAA,KAAAe,EAAAC,EAAAqF,MAAA,GAAAtF,KAAAD,EAAA,OAAA+D,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,QAAAA,EAAAV,MAAA,EAAAU,CAAA,GAAA/D,EAAAwC,OAAAA,EAAAjB,EAAArD,UAAA,CAAA2G,YAAAtD,EAAAkD,MAAA,SAAAzE,GAAA,QAAAwF,KAAA,OAAAzB,KAAA,OAAAN,KAAA,KAAAC,MAAAzD,EAAA,KAAAoD,MAAA,OAAAE,SAAA,UAAAD,OAAA,YAAA3B,IAAA1B,EAAA,KAAAqE,WAAA3B,QAAA4B,IAAAvE,EAAA,QAAAE,KAAA,WAAAA,EAAAuF,OAAA,IAAArF,EAAAwB,KAAA,KAAA1B,KAAAwE,OAAAxE,EAAAP,MAAA,WAAAO,GAAAD,EAAA,EAAAyF,KAAA,gBAAArC,MAAA,MAAApD,EAAA,KAAAqE,WAAA,GAAAE,WAAA,aAAAvE,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,YAAAgE,IAAA,EAAAhC,kBAAA,SAAA3D,GAAA,QAAAqD,KAAA,MAAArD,EAAA,IAAAE,EAAA,cAAA0F,EAAAxF,EAAAE,GAAA,OAAAI,EAAAgB,KAAA,QAAAhB,EAAAiB,IAAA3B,EAAAE,EAAA6D,KAAA3D,EAAAE,IAAAJ,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,KAAAK,CAAA,SAAAA,EAAA,KAAAgE,WAAApF,OAAA,EAAAoB,GAAA,IAAAA,EAAA,KAAAjB,EAAA,KAAAiF,WAAAhE,GAAAI,EAAArB,EAAAmF,WAAA,YAAAnF,EAAA6E,OAAA,OAAA0B,EAAA,UAAAvG,EAAA6E,QAAA,KAAAsB,KAAA,KAAA5E,EAAAR,EAAAwB,KAAAvC,EAAA,YAAAyB,EAAAV,EAAAwB,KAAAvC,EAAA,iBAAAuB,GAAAE,EAAA,SAAA0E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,WAAAqB,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,SAAAxD,GAAA,QAAA4E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,YAAArD,EAAA,MAAAsC,MAAA,kDAAAoC,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,KAAAR,OAAA,SAAA3D,EAAAD,GAAA,QAAAE,EAAA,KAAAoE,WAAApF,OAAA,EAAAgB,GAAA,IAAAA,EAAA,KAAAI,EAAA,KAAAgE,WAAApE,GAAA,GAAAI,EAAA4D,QAAA,KAAAsB,MAAApF,EAAAwB,KAAAtB,EAAA,oBAAAkF,KAAAlF,EAAA8D,WAAA,KAAA/E,EAAAiB,EAAA,OAAAjB,IAAA,UAAAY,GAAA,aAAAA,IAAAZ,EAAA6E,QAAAlE,GAAAA,GAAAX,EAAA+E,aAAA/E,EAAA,UAAAqB,EAAArB,EAAAA,EAAAmF,WAAA,UAAA9D,EAAAgB,KAAAzB,EAAAS,EAAAiB,IAAA3B,EAAAX,GAAA,KAAAiE,OAAA,YAAAS,KAAA1E,EAAA+E,WAAAnC,GAAA,KAAA4D,SAAAnF,EAAA,EAAAmF,SAAA,SAAA5F,EAAAD,GAAA,aAAAC,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,gBAAA1B,EAAAyB,MAAA,aAAAzB,EAAAyB,KAAA,KAAAqC,KAAA9D,EAAA0B,IAAA,WAAA1B,EAAAyB,MAAA,KAAAiE,KAAA,KAAAhE,IAAA1B,EAAA0B,IAAA,KAAA2B,OAAA,cAAAS,KAAA,kBAAA9D,EAAAyB,MAAA1B,IAAA,KAAA+D,KAAA/D,GAAAiC,CAAA,EAAA6D,OAAA,SAAA7F,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAkE,aAAAnE,EAAA,YAAA4F,SAAA3F,EAAAsE,WAAAtE,EAAAmE,UAAAE,EAAArE,GAAA+B,CAAA,kBAAAhC,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAgE,SAAAjE,EAAA,KAAAG,EAAAF,EAAAsE,WAAA,aAAApE,EAAAsB,KAAA,KAAApB,EAAAF,EAAAuB,IAAA4C,EAAArE,EAAA,QAAAI,CAAA,QAAA8C,MAAA,0BAAA2C,cAAA,SAAA/F,EAAAE,EAAAE,GAAA,YAAAmD,SAAA,CAAA5C,SAAA6B,EAAAxC,GAAA8D,WAAA5D,EAAA8D,QAAA5D,GAAA,cAAAkD,SAAA,KAAA3B,IAAA1B,GAAAgC,CAAA,GAAAjC,CAAA,UAAAgG,EAAA5F,EAAAH,EAAAD,EAAAE,EAAAI,EAAAI,EAAAE,GAAA,QAAAvB,EAAAe,EAAAM,GAAAE,GAAAE,EAAAzB,EAAAmB,KAAA,OAAAJ,GAAA,YAAAJ,EAAAI,EAAA,CAAAf,EAAAgE,KAAApD,EAAAa,GAAAsE,QAAApC,QAAAlC,GAAAoC,KAAAhD,EAAAI,EAAA,CAEO,IAAMmW,EAAY,eAFzBrW,EAEyB0H,GAFzB1H,EAEyBL,IAAAgF,MAAG,SAAAgD,EAAO4M,GAAS,IAAA+B,EAAA,OAAA3W,IAAAqB,MAAA,SAAAwH,GAAA,cAAAA,EAAApD,KAAAoD,EAAA7E,MAAA,UACzB,KAAd4Q,EAAgB,CAAA/L,EAAA7E,KAAA,eAAA6E,EAAAhF,OAAA,SACZ,MAAI,cAAAgF,EAAA7E,KAAA,EAEQ6G,MAAM,wBAAyB,CACjDtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CAAE2J,UAAAA,MAEtBzR,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACN,OAAOA,CACR,IAAE,OACK,SAACQ,GACPC,QAAQC,IAAI,8BAA+BF,EAC5C,IAAE,OAbO,OAAN+K,EAAM9N,EAAAnF,KAAAmF,EAAAhF,OAAA,SAcH8S,GAAM,wBAAA9N,EAAAlD,OAAA,GAAAqC,EAAA,IApBf,eAAA9H,EAAA,KAAAD,EAAAlB,UAAA,WAAAsG,SAAA,SAAAlF,EAAAI,GAAA,IAAAI,EAAAN,EAAAvB,MAAAoB,EAAAD,GAAA,SAAAkG,EAAA9F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,OAAA/F,EAAA,UAAA+F,EAAA/F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,QAAA/F,EAAA,CAAA8F,OAAA,QAsBC,gBApBwBsD,GAAA,OAAA1B,EAAAjJ,MAAA,KAAAC,UAAA,KAuBZ6X,EAAsB,SAACxL,GAAyB,IAAnByL,IAAO9X,UAAAI,OAAA,QAAAuK,IAAA3K,UAAA,KAAAA,UAAA,GAC5C+X,EAAavP,SAASC,cAAc,iBACxCsP,EAAW/H,OAAe+H,EAAW/H,MAAO,GAG5C,IAAIzB,EAAY/F,SAAS+E,cAAc,OACvCgB,EAAU7F,UAAUI,IAAI,cAAe,SACvCyF,EAAUpE,QAAQC,GAAKiC,EAAKyH,QAE5B,IAAIkE,EAAYxP,SAAS+E,cAAc,OACvCyK,EAAUtP,UAAUI,IAAI,UAExB,IAAImP,EAASzP,SAAS+E,cAAc,OACpC0K,EAAOvP,UAAUI,IAAI,aAErB,IAAIoP,EAAM1P,SAAS+E,cAAc,OACjC2K,EAAIC,WAAY,EAChBD,EAAI7N,IAAMgC,EAAKiL,YACZjL,EAAKiL,YAAW,mDAAAjP,OACmCgE,EAAKmL,UAAUrM,QAAQ,KAAM,MACnF+M,EAAIhB,IAAM7K,EAAKmL,UAEfS,EAAOtL,YAAYuL,GACnBF,EAAUrL,YAAYsL,GACtB1J,EAAU5B,YAAYqL,GAEtB,IAAII,EAAU5P,SAAS+E,cAAc,OACrC6K,EAAQ1P,UAAUI,IAAI,qBAEtB,IAAI9C,EAAOwC,SAAS+E,cAAc,MAClCvH,EAAK0C,UAAUI,IAAI,cACnB9C,EAAK4C,YAAcyD,EAAKmL,UAExB,IAAItN,EAAW1B,SAAS+E,cAAc,MACtCrD,EAASxB,UAAUI,IAAI,qBACvBoB,EAAStB,YAAcyD,EAAKoL,iBAE5BW,EAAQzL,YAAY3G,GACpBoS,EAAQzL,YAAYzC,GACpBqE,EAAU5B,YAAYyL,GAgBtB,OATA7J,EAAUF,WAAasF,UAAUC,SALlB,yHAOKpL,SAASC,cAAc,gBAC7BkE,YAAY4B,GAEtBuJ,GACHO,EAAiB9J,EAAWlC,GAGtBkC,CACR,EAGa8J,EAAmB,SAACnP,GAIhCV,SAASC,cAAc,uBACpBD,SAASC,cAAc,sBAAsBC,UAAUC,OAAO,UAEjEH,SAASC,cAAc,wBACpBD,SAASC,cAAc,uBAAuBC,UAAUC,OAAO,UAElEO,EAAYR,UAAUI,IAAI,UAG1B,IAAIK,EAAgBD,EAAYa,SAAS,GACzCZ,EAAcY,SAAS,GAAGnB,YAAc,GACxCO,EAAcT,UAAUsB,SAAS,WAAmBb,EAAcT,UAAUI,IAAI,UAG3D,IADrB,IAAIwP,EAAiBpP,EAAYiB,QAAQC,GACrCmO,EAAe,CAAC,EAACjP,EAAAtJ,UAAAI,OAlB2BM,EAAI,IAAAC,MAAA2I,EAAA,EAAAA,EAAA,KAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAJ7I,EAAI6I,EAAA,GAAAvJ,UAAAuJ,GAqBnDgP,EADG7X,EAAK,IAAMA,EAAK,GAAGoT,UAAYwE,EACnB5X,EAAK,GAEL,CACdoT,QAASwE,EACTd,UAAWtO,EAAYT,cAAc,eAAewB,UACpDwN,iBAAkBvO,EAAYT,cAAc,sBAAsBwB,UAClEqN,YAAapO,EAAYT,cAAc,kBAAkB4B,KAI3DmO,EAA0BD,GAC1BE,EAAgBF,EACjB,EAEaC,EAA4B,SAACD,GACzC,IAAIxN,EAAYvC,SAASqC,eAAe,cACpCD,EAAWpC,SAASqC,eAAe,aACnCC,EAAWtC,SAASqC,eAAe,aACnCG,EAAiBxC,SAASqC,eAAe,kBACzCI,EAAgBzC,SAASqC,eAAe,iBACxCK,EAAqB1C,SAASqC,eAAe,sBAEjDE,EAAUrC,UAAUsB,SAAS,WAAYe,EAAUrC,UAAUC,OAAO,UACpEiC,EAASlC,UAAUsB,SAAS,WAAYY,EAASlC,UAAUC,OAAO,UAClEmC,EAASpC,UAAUsB,SAAS,WAAYc,EAASpC,UAAUC,OAAO,UAElEqC,EAAepC,YAAc2P,EAAaf,UAC1CvM,EAAcZ,IAAMkO,EAAajB,YACjCpM,EAAmBzC,cAAc,4BAA4BG,YAAc2P,EAAaf,UACxFtM,EAAmBzC,cAAc,gCAAgCG,YAAc2P,EAAad,iBAC5FvM,EAAmBzC,cAAc,2BAA2B4B,IAAMkO,EAAajB,YAC5EiB,EAAajB,YAAW,mDAAAjP,OAC2BgB,YAAYmO,UAAUrM,QAAQ,KAAM,MAE1FJ,EAAUtC,cAAc,WAAWC,UAAUsB,SAAS,WACnDe,EAAUtC,cAAc,WAAWC,UAAUC,OAAO,UAGvD,IAAIyC,EAAyB5C,SAASC,cAAc,gCACpD2C,EAAuB1C,UAAUsB,SAAS,WAAmBoB,EAAuB1C,UAAUI,IAAI,UAElG,IAAIuC,EAAwB7C,SAASC,cAAc,6BACnD4C,EAAsB3C,UAAUsB,SAAS,WAAYqB,EAAsB3C,UAAUC,OAAO,UAG5F,IAAI2C,EAAU9C,SAASC,cAAc,wBACrC6C,EAAQ5C,UAAUsB,SAAS,WAAYsB,EAAQ5C,UAAUC,OAAO,SACjE,EAGa8P,EAAkB,SAACF,GAC/B,IAAIhN,EAAc/C,SAASC,cAAc,iBACzC8C,EAAY7C,UAAUsB,SAAS,WAAYuB,EAAY7C,UAAUC,OAAO,UAE9CH,SAASC,cAAc,gCAC7B4B,IAAMkO,EAAajB,YACpCiB,EAAajB,YAAW,mDAAAjP,OAC2BkQ,EAAaf,UAAUrM,QAAQ,KAAM,MAE3F,IAAIuN,EAAalQ,SAASC,cAAc,gCACpCkQ,EAAoBnQ,SAASC,cAAc,gCAC/CiQ,EAAW9P,YAAc2P,EAAaf,UACtCmB,EAAkB/P,YAAc2P,EAAad,iBAC7CkB,EAAkBjN,cAAcvB,QAAQwB,IAAM4M,EAAad,iBAG3D3L,MAAM,yCAA0C,CAC/CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpB4H,QAASyE,EAAazE,YAGtB1P,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACwU,GACNC,EAA4BD,EAC7B,IAAE,OACK,SAAC/L,GACPC,QAAQC,IAAI,kCAAmCF,EAChD,GACF,EAGagM,EAA8B,SAACD,GAC3C,IAAME,EAA+BF,EAA/BE,YAAaC,EAAkBH,EAAlBG,cAEf/L,EAAkBxE,SAASC,cAAc,sBAE7C,GAA6B,IAAzBsQ,EAAc3Y,OAAlB,CAIC4M,EAAgBpE,YAAc,GAC9B,IAAIpB,EAAO,IACXuR,EAAgBA,EAAc7L,QAAO,SAACC,GAAG,OAAa,OAARA,CAAY,KAC5CtJ,SAAQ,SAACsJ,GAEtB,IAAIC,GAAU9F,EAAAA,EAAAA,YAAW6F,EAAIE,WAAWxM,MAAM,GAC1C4P,GAAUnJ,EAAAA,EAAAA,YAAW6F,EAAIE,WAAWxM,MAAM,EAAG,GACjD,GAAIuM,IAAY5F,EAAM,CACrBA,EAAO4F,EACP,IAAIE,EAAS9E,SAAS+E,cAAc,OACpCD,EAAO5E,UAAUI,IAAI,OACrB,IAAI0E,EAAUhF,SAAS+E,cAAc,OACrCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAI2E,EAASjF,SAAS+E,cAAc,MACpCE,EAAO7E,YAAcwE,EAErBI,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAGA,GAAIH,EAAIV,WAAaqM,EAAa,CACjC,IAAIE,EAAmBC,EAA0B9L,EAAIS,QAAST,EAAIU,IAAK4C,EAAStD,EAAI+L,YACpFlM,EAAgBL,YAAYqM,EAC7B,KAAO,CACN,IAAIG,EAAiBC,EAAwBjM,EAAIS,QAAST,EAAIU,IAAK4C,EAAStD,EAAI+L,YAEhFlM,EAAgBL,YAAYwM,EAC7B,CACD,IACAnM,EAAgBgB,UAAYhB,EAAgBiB,YAC7C,MAnCCjB,EAAgBpE,YAAc,EAoChC,EAEaqQ,EAA4B,SAAC9L,EAAKe,EAAOC,EAAMnI,GAC3D,IAAIoI,EAAY5F,SAAS+E,cAAc,OAoBvC,OAnBAa,EAAU1F,UAAUI,IAAI,iBACxBsF,EAAUjE,QAAQC,GAAK8D,EACvBE,EAAUC,UAAY,4uBAAHhG,OAU2DrC,EAAI,uFAAAqC,OACL8F,EAAI,8HAAA9F,OAEe8E,EAAG,8BAI5FiB,CACR,EAEagL,EAA0B,SAACjM,EAAKe,EAAOC,EAAMnI,GACzD,IAAIoI,EAAY5F,SAAS+E,cAAc,OAYvC,OAXAa,EAAU1F,UAAUI,IAAI,eACxBsF,EAAUjE,QAAQC,GAAK8D,EACvBE,EAAUC,UAAY,6NAAHhG,OAG2DrC,EAAI,uFAAAqC,OACL8F,EAAI,gIAAA9F,OAEiB8E,EAAG,8BAG9FiB,CACR,EAGaiL,EAAyB,SAACvF,EAAS3G,GAC/CrB,MAAM,qCAAsC,CAC3CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpB4H,QAAAA,EACA3G,IAAAA,MAGA/I,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACN,IAAAiN,EAAoCjN,EAAKkN,QAAjC1L,EAAGyL,EAAHzL,IAAKD,EAAO0L,EAAP1L,QAASP,EAASiM,EAATjM,UAElB6L,EAAa1Q,SAASC,cAAc,wBAAwB/G,MAE5DsL,EAAkBxE,SAASC,cAAc,sBAEzCjB,GAAOF,EAAAA,EAAAA,YAAW+F,GAClBD,EAAU5F,EAAK3G,MAAM,GACrB4P,EAAUjJ,EAAK3G,MAAM,EAAG,GAExB6P,EAAQ/P,MAAMgQ,KAAKnI,SAASyH,iBAAiB,UAEjD,GAAqB,IAAjBS,EAAMtQ,QAAgBsQ,EAAMA,EAAMtQ,OAAS,GAAG6J,YAAcmD,EAAS,CACxE,IAAME,EAAS9E,SAAS+E,cAAc,OACtCD,EAAO5E,UAAUI,IAAI,OACrB,IAAM0E,EAAUhF,SAAS+E,cAAc,OACvCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAM2E,EAASjF,SAAS+E,cAAc,MACtCE,EAAO7E,YAAcwE,EAErBI,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAEA,IAAI0L,EAAmBC,EAA0BrL,EAASC,EAAK4C,EAASyI,GAExElM,EAAgBL,YAAYqM,GAE5BhM,EAAgBgB,UAAYhB,EAAgBiB,YAC7C,GACF,EAGauL,EAAqB,SAACrM,GAClC,IAAIe,EAAQf,EAAIhD,QAAQC,GACpB0J,EAAUtL,SAASC,cAAc,uBAAuB0B,QAAQC,GAEpE0B,MAAM,uCAAwC,CAC7CtH,OAAQ,OACRuH,QAAS,CACR,eAAgB,oBAEjBC,KAAMC,KAAKC,UAAU,CACpB4H,QAAAA,EACA5F,MAAAA,MAGA9J,MAAK,SAAC+H,GAAG,OAAKA,EAAIC,MAAM,IACxBhI,MAAK,SAACiI,GACN,GAAIA,EAAKqI,QAAS,CACjBvH,EAAIxE,SACOH,SAASyH,iBAAiB,QAChCpM,SAAQ,SAACiE,IACkB,OAA3BA,EAAIwJ,oBAA+BxJ,EAAIwJ,mBAAmB5I,UAAUsB,SAAS,SAChFlC,EAAIa,QAEN,IACA,IAAI0G,EAAQ7G,SAASC,cAAc,UACnC4G,EAAMtF,SAAS,GAAGnB,YAAc,2BAChCyG,EAAM3G,UAAUC,OAAO,UACvBE,YAAW,WACVwG,EAAM3G,UAAUI,IAAI,SACrB,GAAG,IACJ,CACD,IAAE,OACK,SAAC+D,GACPC,QAAQC,IAAI,oCAAqCF,EAClD,GACF,EAGa4M,EAAuB,SAACzE,GACpC,IAAI5G,EAAY5F,SAAS+E,cAAc,OAmBvC,OAlBAa,EAAU1F,UAAUI,IAAI,eAAgB,SACxCsF,EAAUjE,QAAQC,GAAK4K,EAAO1K,YAC9B8D,EAAUC,UAAY,4FAAHhG,OACqE2M,EAAOzK,OAAM,WAAAlC,OAAU2M,EAAO9K,SAAQ,+QAAA7B,OAK7G2M,EAAOhP,KAAI,mOAAAqC,OAKX2M,EAAO9K,SAAQ,6CAKzBkE,CACR,C,0fC7XAnN,EAAA,kBAAAC,CAAA,MAAAC,EAAAD,EAAA,GAAAE,EAAAC,OAAAjC,UAAAkC,EAAAF,EAAAG,eAAAC,EAAAH,OAAAI,gBAAA,SAAAN,EAAAD,EAAAE,GAAAD,EAAAD,GAAAE,EAAAM,KAAA,EAAAnB,EAAA,mBAAAoB,OAAAA,OAAA,GAAAC,EAAArB,EAAAsB,UAAA,aAAAC,EAAAvB,EAAAwB,eAAA,kBAAAC,EAAAzB,EAAA0B,aAAA,yBAAAC,EAAAf,EAAAD,EAAAE,GAAA,OAAAC,OAAAI,eAAAN,EAAAD,EAAA,CAAAQ,MAAAN,EAAAe,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAlB,EAAAD,EAAA,KAAAgB,EAAA,aAAAf,GAAAe,EAAA,SAAAf,EAAAD,EAAAE,GAAA,OAAAD,EAAAD,GAAAE,CAAA,WAAAkB,EAAAnB,EAAAD,EAAAE,EAAAE,GAAA,IAAAf,EAAAW,GAAAA,EAAA9B,qBAAAmD,EAAArB,EAAAqB,EAAAX,EAAAP,OAAAmB,OAAAjC,EAAAnB,WAAA0C,EAAA,IAAAW,EAAAnB,GAAA,WAAAE,EAAAI,EAAA,WAAAF,MAAAgB,EAAAvB,EAAAC,EAAAU,KAAAF,CAAA,UAAAe,EAAAxB,EAAAD,EAAAE,GAAA,WAAAwB,KAAA,SAAAC,IAAA1B,EAAA2B,KAAA5B,EAAAE,GAAA,OAAAD,GAAA,OAAAyB,KAAA,QAAAC,IAAA1B,EAAA,EAAAD,EAAAoB,KAAAA,EAAA,IAAAS,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,EAAA,YAAAZ,IAAA,UAAAa,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAApB,EAAAoB,EAAA1B,GAAA,8BAAA2B,EAAAlC,OAAAmC,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAArC,GAAAE,EAAAwB,KAAAW,EAAA7B,KAAA0B,EAAAG,GAAA,IAAAE,EAAAN,EAAAjE,UAAAmD,EAAAnD,UAAAiC,OAAAmB,OAAAc,GAAA,SAAAM,EAAAzC,GAAA,0BAAA0C,SAAA,SAAA3C,GAAAgB,EAAAf,EAAAD,GAAA,SAAAC,GAAA,YAAA2C,QAAA5C,EAAAC,EAAA,gBAAA4C,EAAA5C,EAAAD,GAAA,SAAA8C,EAAA5C,EAAAI,EAAAjB,EAAAqB,GAAA,IAAAE,EAAAa,EAAAxB,EAAAC,GAAAD,EAAAK,GAAA,aAAAM,EAAAc,KAAA,KAAAZ,EAAAF,EAAAe,IAAAE,EAAAf,EAAAN,MAAA,OAAAqB,GAAA,UAAAkB,EAAAlB,IAAAzB,EAAAwB,KAAAC,EAAA,WAAA7B,EAAAgD,QAAAnB,EAAAoB,SAAAC,MAAA,SAAAjD,GAAA6C,EAAA,OAAA7C,EAAAZ,EAAAqB,EAAA,aAAAT,GAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAV,EAAAgD,QAAAnB,GAAAqB,MAAA,SAAAjD,GAAAa,EAAAN,MAAAP,EAAAZ,EAAAyB,EAAA,aAAAb,GAAA,OAAA6C,EAAA,QAAA7C,EAAAZ,EAAAqB,EAAA,IAAAA,EAAAE,EAAAe,IAAA,KAAAzB,EAAAI,EAAA,gBAAAE,MAAA,SAAAP,EAAAG,GAAA,SAAA+C,IAAA,WAAAnD,GAAA,SAAAA,EAAAE,GAAA4C,EAAA7C,EAAAG,EAAAJ,EAAAE,EAAA,WAAAA,EAAAA,EAAAA,EAAAgD,KAAAC,EAAAA,GAAAA,GAAA,aAAA3B,EAAAxB,EAAAE,EAAAE,GAAA,IAAAE,EAAAuB,EAAA,gBAAAxC,EAAAqB,GAAA,GAAAJ,IAAAyB,EAAA,MAAAqB,MAAA,mCAAA9C,IAAA0B,EAAA,cAAA3C,EAAA,MAAAqB,EAAA,OAAAF,MAAAP,EAAAoD,MAAA,OAAAjD,EAAAkD,OAAAjE,EAAAe,EAAAuB,IAAAjB,IAAA,KAAAE,EAAAR,EAAAmD,SAAA,GAAA3C,EAAA,KAAAE,EAAA0C,EAAA5C,EAAAR,GAAA,GAAAU,EAAA,IAAAA,IAAAmB,EAAA,gBAAAnB,CAAA,cAAAV,EAAAkD,OAAAlD,EAAAqD,KAAArD,EAAAsD,MAAAtD,EAAAuB,SAAA,aAAAvB,EAAAkD,OAAA,IAAAhD,IAAAuB,EAAA,MAAAvB,EAAA0B,EAAA5B,EAAAuB,IAAAvB,EAAAuD,kBAAAvD,EAAAuB,IAAA,gBAAAvB,EAAAkD,QAAAlD,EAAAwD,OAAA,SAAAxD,EAAAuB,KAAArB,EAAAyB,EAAA,IAAAK,EAAAX,EAAAzB,EAAAE,EAAAE,GAAA,cAAAgC,EAAAV,KAAA,IAAApB,EAAAF,EAAAiD,KAAArB,EAAAF,EAAAM,EAAAT,MAAAM,EAAA,gBAAAzB,MAAA4B,EAAAT,IAAA0B,KAAAjD,EAAAiD,KAAA,WAAAjB,EAAAV,OAAApB,EAAA0B,EAAA5B,EAAAkD,OAAA,QAAAlD,EAAAuB,IAAAS,EAAAT,IAAA,YAAA6B,EAAAxD,EAAAE,GAAA,IAAAE,EAAAF,EAAAoD,OAAAhD,EAAAN,EAAAW,SAAAP,GAAA,GAAAE,IAAAL,EAAA,OAAAC,EAAAqD,SAAA,eAAAnD,GAAAJ,EAAAW,SAAA,SAAAT,EAAAoD,OAAA,SAAApD,EAAAyB,IAAA1B,EAAAuD,EAAAxD,EAAAE,GAAA,UAAAA,EAAAoD,SAAA,WAAAlD,IAAAF,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAAzD,EAAA,aAAA6B,EAAA,IAAA5C,EAAAoC,EAAAnB,EAAAN,EAAAW,SAAAT,EAAAyB,KAAA,aAAAtC,EAAAqC,KAAA,OAAAxB,EAAAoD,OAAA,QAAApD,EAAAyB,IAAAtC,EAAAsC,IAAAzB,EAAAqD,SAAA,KAAAtB,EAAA,IAAAvB,EAAArB,EAAAsC,IAAA,OAAAjB,EAAAA,EAAA2C,MAAAnD,EAAAF,EAAA8D,YAAApD,EAAAF,MAAAN,EAAA6D,KAAA/D,EAAAgE,QAAA,WAAA9D,EAAAoD,SAAApD,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,GAAAC,EAAAqD,SAAA,KAAAtB,GAAAvB,GAAAR,EAAAoD,OAAA,QAAApD,EAAAyB,IAAA,IAAAkC,UAAA,oCAAA3D,EAAAqD,SAAA,KAAAtB,EAAA,UAAAgC,EAAAhE,GAAA,IAAAD,EAAA,CAAAkE,OAAAjE,EAAA,SAAAA,IAAAD,EAAAmE,SAAAlE,EAAA,SAAAA,IAAAD,EAAAoE,WAAAnE,EAAA,GAAAD,EAAAqE,SAAApE,EAAA,SAAAqE,WAAA5F,KAAAsB,EAAA,UAAAuE,EAAAtE,GAAA,IAAAD,EAAAC,EAAAuE,YAAA,GAAAxE,EAAA0B,KAAA,gBAAA1B,EAAA2B,IAAA1B,EAAAuE,WAAAxE,CAAA,UAAAuB,EAAAtB,GAAA,KAAAqE,WAAA,EAAAJ,OAAA,SAAAjE,EAAA0C,QAAAsB,EAAA,WAAAQ,OAAA,YAAAjC,EAAAxC,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAE,EAAAF,EAAAU,GAAA,GAAAR,EAAA,OAAAA,EAAA0B,KAAA5B,GAAA,sBAAAA,EAAA+D,KAAA,OAAA/D,EAAA,IAAA0E,MAAA1E,EAAAd,QAAA,KAAAoB,GAAA,EAAAjB,EAAA,SAAA0E,IAAA,OAAAzD,EAAAN,EAAAd,QAAA,GAAAkB,EAAAwB,KAAA5B,EAAAM,GAAA,OAAAyD,EAAAvD,MAAAR,EAAAM,GAAAyD,EAAAV,MAAA,EAAAU,EAAA,OAAAA,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,SAAA1E,EAAA0E,KAAA1E,CAAA,YAAAwE,UAAAd,EAAA/C,GAAA,2BAAAkC,EAAAhE,UAAAiE,EAAA7B,EAAAmC,EAAA,eAAAjC,MAAA2B,EAAAjB,cAAA,IAAAZ,EAAA6B,EAAA,eAAA3B,MAAA0B,EAAAhB,cAAA,IAAAgB,EAAAyC,YAAA3D,EAAAmB,EAAArB,EAAA,qBAAAd,EAAA4E,oBAAA,SAAA3E,GAAA,IAAAD,EAAA,mBAAAC,GAAAA,EAAA4E,YAAA,QAAA7E,IAAAA,IAAAkC,GAAA,uBAAAlC,EAAA2E,aAAA3E,EAAA8E,MAAA,EAAA9E,EAAA+E,KAAA,SAAA9E,GAAA,OAAAE,OAAA6E,eAAA7E,OAAA6E,eAAA/E,EAAAkC,IAAAlC,EAAAgF,UAAA9C,EAAAnB,EAAAf,EAAAa,EAAA,sBAAAb,EAAA/B,UAAAiC,OAAAmB,OAAAmB,GAAAxC,CAAA,EAAAD,EAAAkF,MAAA,SAAAjF,GAAA,OAAAgD,QAAAhD,EAAA,EAAAyC,EAAAG,EAAA3E,WAAA8C,EAAA6B,EAAA3E,UAAA0C,GAAA,0BAAAZ,EAAA6C,cAAAA,EAAA7C,EAAAmF,MAAA,SAAAlF,EAAAC,EAAAE,EAAAE,EAAAjB,QAAA,IAAAA,IAAAA,EAAA+F,SAAA,IAAA1E,EAAA,IAAAmC,EAAAzB,EAAAnB,EAAAC,EAAAE,EAAAE,GAAAjB,GAAA,OAAAW,EAAA4E,oBAAA1E,GAAAQ,EAAAA,EAAAqD,OAAAb,MAAA,SAAAjD,GAAA,OAAAA,EAAAoD,KAAApD,EAAAO,MAAAE,EAAAqD,MAAA,KAAArB,EAAAD,GAAAzB,EAAAyB,EAAA3B,EAAA,aAAAE,EAAAyB,EAAA/B,GAAA,0BAAAM,EAAAyB,EAAA,qDAAAzC,EAAAqF,KAAA,SAAApF,GAAA,IAAAD,EAAAG,OAAAF,GAAAC,EAAA,WAAAE,KAAAJ,EAAAE,EAAAxB,KAAA0B,GAAA,OAAAF,EAAAoF,UAAA,SAAAvB,IAAA,KAAA7D,EAAAhB,QAAA,KAAAe,EAAAC,EAAAqF,MAAA,GAAAtF,KAAAD,EAAA,OAAA+D,EAAAvD,MAAAP,EAAA8D,EAAAV,MAAA,EAAAU,CAAA,QAAAA,EAAAV,MAAA,EAAAU,CAAA,GAAA/D,EAAAwC,OAAAA,EAAAjB,EAAArD,UAAA,CAAA2G,YAAAtD,EAAAkD,MAAA,SAAAzE,GAAA,QAAAwF,KAAA,OAAAzB,KAAA,OAAAN,KAAA,KAAAC,MAAAzD,EAAA,KAAAoD,MAAA,OAAAE,SAAA,UAAAD,OAAA,YAAA3B,IAAA1B,EAAA,KAAAqE,WAAA3B,QAAA4B,IAAAvE,EAAA,QAAAE,KAAA,WAAAA,EAAAuF,OAAA,IAAArF,EAAAwB,KAAA,KAAA1B,KAAAwE,OAAAxE,EAAAP,MAAA,WAAAO,GAAAD,EAAA,EAAAyF,KAAA,gBAAArC,MAAA,MAAApD,EAAA,KAAAqE,WAAA,GAAAE,WAAA,aAAAvE,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,YAAAgE,IAAA,EAAAhC,kBAAA,SAAA3D,GAAA,QAAAqD,KAAA,MAAArD,EAAA,IAAAE,EAAA,cAAA0F,EAAAxF,EAAAE,GAAA,OAAAI,EAAAgB,KAAA,QAAAhB,EAAAiB,IAAA3B,EAAAE,EAAA6D,KAAA3D,EAAAE,IAAAJ,EAAAoD,OAAA,OAAApD,EAAAyB,IAAA1B,KAAAK,CAAA,SAAAA,EAAA,KAAAgE,WAAApF,OAAA,EAAAoB,GAAA,IAAAA,EAAA,KAAAjB,EAAA,KAAAiF,WAAAhE,GAAAI,EAAArB,EAAAmF,WAAA,YAAAnF,EAAA6E,OAAA,OAAA0B,EAAA,UAAAvG,EAAA6E,QAAA,KAAAsB,KAAA,KAAA5E,EAAAR,EAAAwB,KAAAvC,EAAA,YAAAyB,EAAAV,EAAAwB,KAAAvC,EAAA,iBAAAuB,GAAAE,EAAA,SAAA0E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,WAAAqB,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,SAAAxD,GAAA,QAAA4E,KAAAnG,EAAA8E,SAAA,OAAAyB,EAAAvG,EAAA8E,UAAA,YAAArD,EAAA,MAAAsC,MAAA,kDAAAoC,KAAAnG,EAAA+E,WAAA,OAAAwB,EAAAvG,EAAA+E,WAAA,KAAAR,OAAA,SAAA3D,EAAAD,GAAA,QAAAE,EAAA,KAAAoE,WAAApF,OAAA,EAAAgB,GAAA,IAAAA,EAAA,KAAAI,EAAA,KAAAgE,WAAApE,GAAA,GAAAI,EAAA4D,QAAA,KAAAsB,MAAApF,EAAAwB,KAAAtB,EAAA,oBAAAkF,KAAAlF,EAAA8D,WAAA,KAAA/E,EAAAiB,EAAA,OAAAjB,IAAA,UAAAY,GAAA,aAAAA,IAAAZ,EAAA6E,QAAAlE,GAAAA,GAAAX,EAAA+E,aAAA/E,EAAA,UAAAqB,EAAArB,EAAAA,EAAAmF,WAAA,UAAA9D,EAAAgB,KAAAzB,EAAAS,EAAAiB,IAAA3B,EAAAX,GAAA,KAAAiE,OAAA,YAAAS,KAAA1E,EAAA+E,WAAAnC,GAAA,KAAA4D,SAAAnF,EAAA,EAAAmF,SAAA,SAAA5F,EAAAD,GAAA,aAAAC,EAAAyB,KAAA,MAAAzB,EAAA0B,IAAA,gBAAA1B,EAAAyB,MAAA,aAAAzB,EAAAyB,KAAA,KAAAqC,KAAA9D,EAAA0B,IAAA,WAAA1B,EAAAyB,MAAA,KAAAiE,KAAA,KAAAhE,IAAA1B,EAAA0B,IAAA,KAAA2B,OAAA,cAAAS,KAAA,kBAAA9D,EAAAyB,MAAA1B,IAAA,KAAA+D,KAAA/D,GAAAiC,CAAA,EAAA6D,OAAA,SAAA7F,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAkE,aAAAnE,EAAA,YAAA4F,SAAA3F,EAAAsE,WAAAtE,EAAAmE,UAAAE,EAAArE,GAAA+B,CAAA,kBAAAhC,GAAA,QAAAD,EAAA,KAAAsE,WAAApF,OAAA,EAAAc,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAoE,WAAAtE,GAAA,GAAAE,EAAAgE,SAAAjE,EAAA,KAAAG,EAAAF,EAAAsE,WAAA,aAAApE,EAAAsB,KAAA,KAAApB,EAAAF,EAAAuB,IAAA4C,EAAArE,EAAA,QAAAI,CAAA,QAAA8C,MAAA,0BAAA2C,cAAA,SAAA/F,EAAAE,EAAAE,GAAA,YAAAmD,SAAA,CAAA5C,SAAA6B,EAAAxC,GAAA8D,WAAA5D,EAAA8D,QAAA5D,GAAA,cAAAkD,SAAA,KAAA3B,IAAA1B,GAAAgC,CAAA,GAAAjC,CAAA,UAAAgG,EAAA5F,EAAAH,EAAAD,EAAAE,EAAAI,EAAAI,EAAAE,GAAA,QAAAvB,EAAAe,EAAAM,GAAAE,GAAAE,EAAAzB,EAAAmB,KAAA,OAAAJ,GAAA,YAAAJ,EAAAI,EAAA,CAAAf,EAAAgE,KAAApD,EAAAa,GAAAsE,QAAApC,QAAAlC,GAAAoC,KAAAhD,EAAAI,EAAA,UAAA2F,EAAA7F,GAAA,sBAAAH,EAAA,KAAAD,EAAAlB,UAAA,WAAAsG,SAAA,SAAAlF,EAAAI,GAAA,IAAAI,EAAAN,EAAAvB,MAAAoB,EAAAD,GAAA,SAAAkG,EAAA9F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,OAAA/F,EAAA,UAAA+F,EAAA/F,GAAA4F,EAAAtF,EAAAR,EAAAI,EAAA4F,EAAAC,EAAA,QAAA/F,EAAA,CAAA8F,OAAA,OAIA,IAAMsS,EAAgB,SAAC9L,GACtB,IAAIpG,GAAOF,EAAAA,EAAAA,YAAWsG,EAAQP,WAC1BD,EAAU5F,EAAK3G,MAAM,GACrB4P,EAAUjJ,EAAK3G,MAAM,EAAG,GAExB6P,EAAQ/P,MAAMgQ,KAAKnI,SAASyH,iBAAiB,UAC7CjD,EAAkBxE,SAASC,cAAc,sBAE7C,GAAqB,IAAjBiI,EAAMtQ,QAAgBsQ,EAAMA,EAAMtQ,OAAS,GAAGwI,cAAgBwE,EAAS,CAC1E,IAAME,EAAS9E,SAAS+E,cAAc,OACtCD,EAAO5E,UAAUI,IAAI,OACrB,IAAM0E,EAAUhF,SAAS+E,cAAc,OACvCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAM2E,EAASjF,SAAS+E,cAAc,MACtCE,EAAO7E,YAAcwE,EAErBI,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAEA,IAAIQ,GAAYC,EAAAA,EAAAA,oBAAmBH,EAAQA,QAASA,EAAQC,IAAK4C,GAEjEzD,EAAgBL,YAAYmB,GAC5Bd,EAAgBgB,UAAYhB,EAAgBiB,YAC7C,EAGMQ,EAAwB,SAACkL,GACXnR,SAASyH,iBAAiB,eAClCpM,QAAO,eAAAmF,EAAA7B,EAAAlG,IAAAgF,MAAC,SAAAgD,EAAOiH,GAAM,IAAAiG,EAAAyD,EAAA7O,EAAA8O,EAAA,OAAA5Y,IAAAqB,MAAA,SAAAwH,GAAA,cAAAA,EAAApD,KAAAoD,EAAA7E,MAAA,OAC3BkR,EAAiBjG,EAAOzH,cAAc,kBAAkBwB,UACxD2P,EAAS1J,EAAOzH,cAAc,WAE9BkR,GAASA,EAAMtD,SAASF,KAC3ByD,EAAOlR,UAAUsB,SAAS,WAAmB4P,EAAOlR,UAAUI,IAAI,UAC9DoH,EAAOxH,UAAUsB,SAAS,YACzBe,EAAYvC,SAASC,cAAc,iBACnCoR,EAAmB9O,EAAUtC,cAAc,YAC9BC,UAAUsB,SAAS,WAAmB6P,EAAiBnR,UAAUI,IAAI,YAGvF8Q,EAAOlR,UAAUsB,SAAS,WAAY4P,EAAOlR,UAAUC,OAAO,UAC9D,wBAAAmB,EAAAlD,OAAA,GAAAqC,EAAA,KACD,gBAAAyB,GAAA,OAAA1B,EAAAjJ,MAAA,KAAAC,UAAA,EAdiB,GAenB,EAWM8Z,GAASC,EAAAA,EAAAA,SAAGxE,wBAAoB,CACrCyE,iBAAiB,IAGdtL,EAAc,GAGlBoL,EAAOxa,GAAG,kBAAkB,SAACqa,GAC5BjL,EAAciL,EACdlL,EAAsBkL,EACvB,IAGAG,EAAOxa,GAAG,aAAY,eAAAuP,EAAA1H,EAAAlG,IAAAgF,MAAE,SAAA6I,EAAOlB,EAASqM,EAAgBC,GAAQ,IAAAC,EAAAC,EAAAC,EAAA,OAAApZ,IAAAqB,MAAA,SAAAsN,GAAA,cAAAA,EAAAlJ,KAAAkJ,EAAA3K,MAAA,OAY/D,GAXIkV,EAAS,GAGI3R,SAASyH,iBAAiB,eAChCpM,SAAQ,SAACqM,GACEA,EAAOzH,cAAc,kBAAkBwB,YACrCgQ,IACtBE,EAASjK,EAEX,IAGe,KAAXiK,EAAa,CAAAvK,EAAA3K,KAAA,SAiBd,GAhBgBuD,SAASyH,iBAAiB,oBAChCpM,SAAQ,SAACqM,GACpB,IAAIiG,EAAiBjG,EAAOzH,cAAc,6BAA6BwB,UAAUmM,OAEjF,GAAID,IAAmB8D,EAAgB,CACtC,IAAIK,EAAapK,EAAOzH,cAAc,yBAAyBwB,UAC3DsQ,EAAerK,EAAOzH,cAAc,2BAA2B4B,IAC/DmQ,EAAWtK,EAAO/F,QAAQC,GAC9B+P,EAAS,CACRnU,KAAMsU,EACNpQ,SAAUiM,EACV5L,OAAQgQ,EACRjQ,YAAakQ,EACb7Q,UAAU,EAEZ,CACD,IAEe,KAAXwQ,EAAa,CAAAvK,EAAA3K,KAAA,SAKd,OAHFiV,EAAS,CACRN,OAAQ,UACRxJ,MAAO,qBACNR,EAAA9K,OAAA,kBA1D0BuH,EA6DG8N,EA5D7B5L,YAAYC,EAAAA,EAAAA,yBAAwBnC,GAElB7D,SAASC,cAAc,kBAC7BkE,YAAY4B,GAyD1B4L,EAxDK5L,EAwDiC,QAIpC4L,EAAOzR,UAAUsB,SAAS,WAC7B0P,EAAc9L,GACdsM,EAAS,CACRN,OAAQ,cAGLQ,EAAYD,EAAOpQ,SAAS,GAE5BsQ,EAAiBI,SAASL,EAAUnQ,WAAa,EACrDmQ,EAAUrQ,SAAS,GAAGnB,YAAcyR,EACpCD,EAAU1R,UAAUC,OAAO,UAEJ,IAAnB0R,GACH/R,EAAAA,EAAAA,kBAAiB,gCAADD,OAAiC4R,EAAc,OAE/D3R,EAAAA,EAAAA,kBAAiB,YAADD,OAAagS,EAAc,wBAAAhS,OAAuB4R,EAAc,MAGjFC,EAAS,CACRN,OAAQ,YAET,yBAAAhK,EAAAhJ,OAtF4B,IAACyF,EAC1BkC,CAqFH,GAAAO,EAAA,KACD,gBAAAwB,EAAAU,EAAAC,GAAA,OAAApC,EAAA9O,MAAA,KAAAC,UAAA,EAlEqB,IAqEtB8Z,EAAOxa,GAAG,iBAAiB,SAACob,EAAUT,GAErC,IAAIU,EAAenS,SAASC,cAAc,sBAEtCkS,EACmBA,EAAalS,cAAc,kBAAkBwB,YAE3CgQ,IACJzR,SAASyH,iBAAiB,gBAChCpM,SAAQ,SAACsJ,GACTA,EAAIhD,QAAQC,KAEVsQ,GACbvN,EAAIxE,QAEN,IAEqBH,SAASyH,iBAAiB,kBAChCpM,SAAQ,SAACsJ,GACXA,EAAIhD,QAAQC,KAEVsQ,GACbvN,EAAIxE,QAEN,IAEWH,SAASyH,iBAAiB,QAChCpM,SAAQ,SAACiE,IACkB,OAA3BA,EAAIwJ,oBAA+BxJ,EAAIwJ,mBAAmB5I,UAAUsB,SAAS,SAChFlC,EAAIa,QAEN,KAGgBH,SAASyH,iBAAiB,eAChCpM,SAAQ,SAACqM,GAEnB,GADqBA,EAAOzH,cAAc,kBAAkBwB,YACrCgQ,EAAgB,CACtC,IAAIG,EAAYlK,EAAOnG,SAAS,GAChC,GAAIqQ,EAAU1R,UAAUsB,SAAS,UAChC,OAED,IAAIqQ,EAAiBI,SAASL,EAAUnQ,WAAa,EACrDmQ,EAAUrQ,SAAS,GAAGnB,YAAcyR,EACb,IAAnBA,GACHD,EAAU1R,UAAUI,IAAI,SAE1B,CACD,GAEF,IAGAgR,EAAOxa,GAAG,sBAAsB,SAAC2a,GACfzR,SAASyH,iBAAiB,eAChCpM,SAAQ,SAACqM,GACEA,EAAOzH,cAAc,kBAAkBwB,YACrCgQ,GACtB/J,EAAOvH,QAET,IACA,IAAIoC,EAAYvC,SAASqC,eAAe,cACpCD,EAAWpC,SAASqC,eAAe,aACnCC,EAAWtC,SAASqC,eAAe,aACnC8G,EAAWnJ,SAASC,cAAc,oBAClCmS,EAAcpS,SAASC,cAAc,eACrCoS,EAAWrS,SAASC,cAAc,kBAClCqS,EAAgBtS,SAASC,cAAc,wBAE3CsC,EAAUrC,UAAUI,IAAI,UACxB8B,EAASlC,UAAUI,IAAI,UACvB8B,EAASnC,cAAc,sBAAsB4F,UAAY,GACzDvD,EAASpC,UAAUI,IAAI,UACvB6I,EAASjJ,UAAUI,IAAI,UACnB8R,GACHA,EAAYjS,SAEbkS,EAASnS,UAAUC,OAAO,UAC1BmS,EAAcpS,UAAUC,OAAO,SAChC,IAGAmR,EAAOxa,GAAG,aAAa,SAACmN,GAGvB,GAAIjE,SAASC,cAAc,sBAAuB,CAClCD,SAASqC,eAAe,aAC9BnC,UAAUI,IAAI,UAERN,SAASC,cAAc,oBAC7BC,UAAUC,OAAO,UAEXH,SAASC,cAAc,kBAC7BC,UAAUI,IAAI,UAEHN,SAASC,cAAc,wBAC7BC,UAAUI,IAAI,UAE5B,IAAI4D,EAAelE,SAASC,cAAc,eACtCiE,EAAahE,UAAUsB,SAAS,WACnC0C,EAAahE,UAAUC,OAAO,UAG/B,IAAIyC,EAAyB5C,SAASC,cAAc,+BACpD2C,EAAuB1C,UAAUsB,SAAS,WAAYoB,EAAuB1C,UAAUC,OAAO,UAC9FyC,EAAuBuB,YAAYD,EACpC,CACD,IAGAoN,EAAOxa,GAAG,eAAe,SAACmN,GAEzB,GAAIjE,SAASC,cAAc,sBAAuB,CAClCD,SAASC,cAAc,oBAC7BC,UAAUI,IAAI,UAERN,SAASC,cAAc,kBAC7BC,UAAUC,OAAO,UAENH,SAASC,cAAc,wBAC7BC,UAAUC,OAAO,UAE/B,IAAI+D,EAAelE,SAASC,cAAc,eACrCiE,EAAahE,UAAUsB,SAAS,WAEpC0C,EAAahE,UAAUI,IAAI,UAGbN,SAASqC,eAAe,aAC9BnC,UAAUC,OAAO,SAC3B,CACD,IAGAmR,EAAOxa,GAAG,4BAA4B,SAACyb,EAAgBC,EAAgBd,GACtE,IAEmB1R,SAASyH,iBAAiB,oBAChCpM,SAAQ,SAACqM,GACCA,EAAOzH,cAAc,6BAA6BwB,UAAUmM,SAC1D2E,EAAe7Q,WACrCgG,EAAOzH,cAAc,yBAAyBG,YAAcoS,EAAehV,KAC3EkK,EAAOzH,cAAc,6BAA6BG,YAAcoS,EAAe9Q,SAC/EgG,EAAOzH,cAAc,2BAA2B4B,IAAM2Q,EAAezQ,OAEvE,IAGsB/B,SAASyH,iBAAiB,eAChCpM,SAAQ,SAAC8Q,GAExB,GADeA,EAAKlM,cAAc,kBAAkBwB,UAAUmM,SAC7C2E,EAAe7Q,WAC/ByK,EAAKlM,cAAc,cAAcG,YAAcoS,EAAehV,KAC9D2O,EAAKlM,cAAc,kBAAkBG,YAAcoS,EAAe9Q,SAClEyK,EAAKlM,cAAc,iBAAiB4B,IAAM2Q,EAAezQ,OAGrDoK,EAAKjM,UAAUsB,SAAS,WAAW,CAEtC,IAAIe,EAAYvC,SAASC,cAAc,eACvCsC,EAAUtC,cAAc,iBAAiB4B,IAAM2Q,EAAezQ,OAC9DQ,EAAUtC,cAAc,mBAAmBG,YAAcoS,EAAehV,KAGxEwC,SAASC,cAAc,mCAAmC4B,IAAM2Q,EAAezQ,OAC/E/B,SAASC,cAAc,kCAAkCG,YAAcoS,EAAehV,KACtFwC,SAASC,cAAc,kCAAkCG,YAAcoS,EAAe9Q,SAGtF,IAAI+Q,EAAmBzS,SAASC,cAAc,wBAC9CwS,EAAiBxS,cAAc,gCAAgC4B,IAAM2Q,EAAezQ,OACpF0Q,EAAiBxS,cAAc,gCAAgCG,YAAcoS,EAAehV,KAC5FiV,EAAiBxS,cAAc,gCAAgCG,YAAcoS,EAAe9Q,QAC7F,CAEF,IAEAgQ,EAAS,CACRN,OAAQ,UACRhM,QAAS,mBAEX,CAAE,MAAOwC,GAER8J,EAAS,CACRN,OAAQ,UACRxJ,MAAOA,GAET,CACD,IAGA0J,EAAOxa,GAAG,cAAc,SAAC+M,GACxByN,EAAOrZ,KAAK,YAAa,CAAEya,OAAQ7O,EAAK6O,SAElB1S,SAASC,cAAc,wBAAwB/G,QAE7C2K,EAAK8O,cAAatD,EAAAA,EAAAA,qBAAoBxL,EAAKqL,WAAW,EAC/E,IAGAoC,EAAOxa,GAAG,iBAAiB,SAAC+M,EAAM6N,GAEjC,IAAQpG,EAAmDzH,EAAnDyH,QAASlG,EAA0CvB,EAA1CuB,QAASM,EAAiC7B,EAAjC6B,MAAOb,EAA0BhB,EAA1BgB,UAAW6L,EAAe7M,EAAf6M,WAExCkC,EAAY,GAWhB,GATgB5S,SAASyH,iBAAiB,gBAChCpM,SAAQ,SAACwX,GACTA,EAAMlR,QAAQC,KAEZ0J,IACVsH,EAAYC,EAEd,IAEkB,KAAdD,EASJ,GAAIA,EAAU1S,UAAUsB,SAAS,UAAW,CAC3C,IAAIxC,GAAOF,EAAAA,EAAAA,YAAW+F,GAClBD,EAAU5F,EAAK3G,MAAM,GACrB4P,EAAUjJ,EAAK3G,MAAM,EAAG,GAExB6P,EAAQ/P,MAAMgQ,KAAKnI,SAASyH,iBAAiB,UAC7CjD,EAAkBxE,SAASC,cAAc,sBAE7C,GAAqB,IAAjBiI,EAAMtQ,QAAgBsQ,EAAMA,EAAMtQ,OAAS,GAAGwI,cAAgBwE,EAAS,CAC1E,IAAME,EAAS9E,SAAS+E,cAAc,OACtCD,EAAO5E,UAAUI,IAAI,OACrB,IAAM0E,EAAUhF,SAAS+E,cAAc,OACvCC,EAAQ9E,UAAUI,IAAI,QACtB,IAAM2E,EAASjF,SAAS+E,cAAc,MACtCE,EAAO7E,YAAcwE,EAErBI,EAAQb,YAAYc,GACpBH,EAAOX,YAAYa,GACnBR,EAAgBL,YAAYW,EAC7B,CAEA,IAAIQ,GAAYsL,EAAAA,EAAAA,yBAAwBxL,EAASM,EAAOuC,EAASyI,GAEjElM,EAAgBL,YAAYmB,GAC5Bd,EAAgBgB,UAAYhB,EAAgBiB,aAC5CiM,EAAS,CACRN,OAAQ,WAEV,KAAO,CACN,IAAI0B,EAAkBF,EAAU3S,cAAc,iBAC1C4R,EAAiBI,SAASa,EAAgBvR,SAAS,GAAGnB,aAAe,EACzE0S,EAAgBvR,SAAS,GAAGnB,YAAcyR,EAC1CiB,EAAgB5S,UAAUC,OAAO,UAEjC,IAAI6O,EAAY4D,EAAU3S,cAAc,eAAewB,UAEhC,IAAnBoQ,GACH/R,EAAAA,EAAAA,kBAAiB,8BAADD,OAA+BmP,EAAS,aAExDlP,EAAAA,EAAAA,kBAAiB,YAADD,OAAagS,EAAc,sBAAAhS,OAAqBmP,EAAS,YAG1E0C,EAAS,CACRN,OAAQ,UAEV,MApDCM,EAAS,CACRN,OAAQ,UACRxJ,MAAO,mBAmDV,IAGA0J,EAAOxa,GAAG,wBAAwB,SAAC+M,GAClC,IAAQyH,EAA8BzH,EAA9ByH,QAAS5F,EAAqB7B,EAArB6B,MAAOqN,EAAclP,EAAdkP,UACpBC,EAAYhT,SAASyH,iBAAiB,gBACtCmL,EAAY,GAShB,GAPAI,EAAU3X,SAAQ,SAACwX,GACTA,EAAMlR,QAAQC,KACZ0J,IACVsH,EAAYC,EAEd,IAEID,GAAaA,EAAU1S,UAAUsB,SAAS,UACzBoR,EAAUjR,QAAQC,KAEhB0J,IACEtL,SAASyH,iBAAiB,gBAEhCpM,SAAQ,SAACsJ,GACzB,IAAIsO,EAAYtO,EAAIhD,QAAQC,GACxB8D,IAAUuN,GACbtO,EAAIxE,QAEN,IAEWH,SAASyH,iBAAiB,QAChCpM,SAAQ,SAACiE,IACkB,OAA3BA,EAAIwJ,oBAA+BxJ,EAAIwJ,mBAAmB5I,UAAUsB,SAAS,SAChFlC,EAAIa,QAEN,UAEK,GAAIyS,EAAW,CACrB,IAAIE,EAAkBF,EAAU3S,cAAc,iBAC9C,GAAI6S,EAAgB5S,UAAUsB,SAAS,UACtC,OAED,IAAIqQ,EAAiBI,SAASa,EAAgBvR,SAAS,GAAGE,WAAa,EACvEqR,EAAgBvR,SAAS,GAAGnB,YAAcyR,EACnB,IAAnBA,GACHiB,EAAgB5S,UAAUI,IAAI,SAEhC,CAEA,IAAI0O,EAAY4D,EAAU3S,cAAc,eAAewB,WACvD3B,EAAAA,EAAAA,kBAAiB,IAADD,OAAKkT,EAAS,4BAAAlT,OAA2BmP,EAAS,WACnE,IAIAsC,EAAOxa,GAAG,WAAW,WACpBwN,QAAQC,IAAI,sBACb,IAEA+M,EAAOxa,GAAG,cAAc,WACvBwN,QAAQC,IAAI,2BACb,G,8DCxdA,SAAS2O,EAAsBC,GAC7B,GAAmB,iBAARA,IAAqBA,EAC9B,MAAM,IAAIrX,MAAM,qCAAuCqX,EAE3D,CAEA,SAASC,EAAcC,GACrB,GAAsB,iBAAXA,EACT,MAAM,IAAIvX,MAAM,2BAA6BuX,EAEjD,C,8BAEA,MAEMC,EAAc,QACdC,EAAiB,WACjBC,EAAkB,YAElBC,EAAe,SAEfC,EAAc,QAGdC,EAAwB,cACxBC,EAAW,OACXC,EAAU,MACVC,EAAyB,WACzBC,EAAgB,WAChBC,EAAiB,YACjBC,EAAqB,eAoB3B,SAASC,EAAWC,GAClB,OAdF,SAAiBC,EAAKC,GACpB,MAAMC,EAAM,IAAIC,IACV5Q,EAAM,GACZ,IAAK,MAAM6Q,KAAQJ,EAAK,CACtB,MAAMzd,EAAM0d,EAAKG,GACZF,EAAIG,IAAI9d,KACX2d,EAAIhU,IAAI3J,GACRgN,EAAIvM,KAAKod,GAEb,CACA,OAAO7Q,CACT,CAGS+Q,CAAOP,GAAQQ,GAAKA,EAAEvK,SAC/B,CA0BA,MAAMwK,EAAwB,CAAC,EACzBC,EAAgB,CAAC,EACjBC,EAAmB,CAAC,EAE1B,SAASC,EAAuBrZ,EAASsZ,EAAQC,GAG/CA,EAAIC,QAAU,IAAMF,EAAOC,EAAIrN,OAE/BqN,EAAIE,UAAY,IAAMH,EAAO,IAAIlZ,MAAM,gBACvCmZ,EAAIG,UAAY,IAAM1Z,EAAQuZ,EAAI7F,OACpC,CAEAvR,eAAewX,EAAgBC,GAC7B,MAAMC,QAAW,IAAIzX,SAAQ,CAACpC,EAASsZ,KACrC,MAAMC,EAAMO,UAAUhO,KAAK8N,EAhFJ,GAiFvBV,EAAsBU,GAAUL,EAChCA,EAAIQ,gBAAkB/c,IAMhBA,EAAEgd,WAvFe,GAwC3B,SAA2BH,GACzB,SAASI,EAAmBnY,EAAMoY,EAASC,GACzC,MAAMC,EAAQF,EACVL,EAAGI,kBAAkBnY,EAAM,CAAEoY,YAC7BL,EAAGI,kBAAkBnY,GACzB,GAAIqY,EACF,IAAK,MAAOE,GAAYH,EAASI,MAAgBnd,OAAOod,QAAQJ,GAC9DC,EAAMI,YAAYH,EAAWH,EAAS,CAAEI,eAG5C,OAAOF,CACT,CAEAH,EAAkBpC,GAClBoC,EAAkBrC,EAhDE,UAgDwC,CAC1D,CAACG,GAAe,CAnDC,UAmD+B,GAChD,CAACE,GAAwB,CAAC,CAhDV,QACA,UAgDhB,CAACM,GAAqB,CAxCC,gBAwCqC,KAE9D0B,EAAkBnC,OAAiBrR,EAAW,CAC5C,CAACuR,GAAc,CAAC,KAEpB,CA0BQyC,CAAiBlB,EAAI7F,OACvB,EAEF2F,EAAsBrZ,EAASsZ,EAAQC,EAAI,IAQ7C,OADAM,EAAGa,QAAU,IAAMC,EAAcf,GAC1BC,CACT,CASA,SAASe,EAAWf,EAAIgB,EAAWC,EAAqB3e,GACtD,OAAO,IAAIiG,SAAQ,CAACpC,EAASsZ,KAG3B,MAAMyB,EAAMlB,EAAGmB,YAAYH,EAAWC,EAAqB,CAAEG,WAAY,YACnEb,EAA6B,iBAAdS,EACjBE,EAAIG,YAAYL,GAChBA,EAAU7I,KAAIlQ,GAAQiZ,EAAIG,YAAYpZ,KAC1C,IAAImG,EACJ9L,EAAGie,EAAOW,GAAMrH,IACdzL,EAAMyL,CAAM,IAGdqH,EAAII,WAAa,IAAMnb,EAAQiI,GAE/B8S,EAAIvB,QAAU,IAAMF,EAAOyB,EAAI7O,MAAM,GAEzC,CAEA,SAASyO,EAAef,GAEtB,MAAML,EAAML,EAAsBU,GAC5BC,EAAKN,GAAOA,EAAI7F,OACtB,GAAImG,EAAI,CACNA,EAAGuB,QACH,MAAMve,EAAYuc,EAAiBQ,GAEnC,GAAI/c,EACF,IAAK,MAAMwe,KAAYxe,EACrBwe,GAGN,QACOnC,EAAsBU,UACtBT,EAAcS,UACdR,EAAiBQ,EAC1B,CAyBA,MAAM0B,EAAqB,IAAIzC,IAAI,CACjC,KAAM,KAAM,MAAO,MACnB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,MAAO,KAAM,KACnB,KAAM,KAAM,MAAO,KACnB,MAAO,KAAM,OAAQ,KACrB,OAGF,SAAS0C,EAAe9D,GACtB,OAAOA,EACJ+D,MAAM,UACNxJ,KAAIyJ,IACEA,EAAKC,MAAM,OAASJ,EAAmBvC,IAAI0C,GAEvCA,EAAK3J,cAGP2J,EACJxU,QAAQ,UAAW,IACnBA,QAAQ,KAAM,KACd6K,gBACF9I,OAAO2S,QACd,CASA,SAASC,EAAiBnE,GACxB,OAAOA,EACJzO,OAAO2S,SACP3J,KAAIiH,GAAKA,EAAEnH,gBACX9I,QAAOiQ,GAAKA,EAAE/c,QAXY,GAY/B,CA6CA,SAAS2f,EAAWzB,EAAO9Z,EAAQrF,EAAKkB,GACtCie,EAAM9Z,GAAQrF,GAAKye,UAAY1c,GAAMb,GAAMA,EAAGa,EAAEwR,OAAOkF,OACzD,CAEA,SAASoI,EAAQ1B,EAAOnf,EAAKkB,GAC3B0f,EAAUzB,EAAO,MAAOnf,EAAKkB,EAC/B,CAEA,SAAS4f,EAAW3B,EAAOnf,EAAKkB,GAC9B0f,EAAUzB,EAAO,SAAUnf,EAAKkB,EAClC,CAEA,SAAS6f,EAAQjB,GAEXA,EAAIiB,QACNjB,EAAIiB,QAER,CAiBA,SAASC,EAAmBC,EAAQC,GAClC,MAAMC,EAfR,SAAgBC,EAAO1D,GACrB,IAAI2D,EAAUD,EAAM,GACpB,IAAK,IAAIhgB,EAAI,EAAGA,EAAIggB,EAAMngB,OAAQG,IAAK,CACrC,MAAMyc,EAAOuD,EAAMhgB,GACfsc,EAAK2D,GAAW3D,EAAKG,KACvBwD,EAAUxD,EAEd,CACA,OAAOwD,CACT,CAMwBC,CAAML,GAAQjD,GAAKA,EAAE/c,SACrCsgB,EAAU,GAChB,IAAK,MAAM1D,KAAQsD,EAEZF,EAAOO,MAAKJ,IAAuE,IAA9DA,EAAMK,WAAUzD,GAAKkD,EAAWlD,KAAOkD,EAAWrD,QAC1E0D,EAAQ9gB,KAAKod,GAGjB,OAAO0D,CACT,CAkDAra,eAAewa,EAAU9C,EAAI+C,EAAWC,EAAKC,GAC3C,IACE,MAAMC,EA1IV,SAA6BH,GAqC3B,OApCYA,EAAU5K,KAAI,EAAGgL,aAAYC,WAAU9F,QAAO+F,QAAOC,aAAYC,QAAOC,OAAMC,QAAOC,cAC/F,MAQMtV,EAAM,CACV+U,aACA7F,QACA+F,QACAG,OACAG,OAba,IAAI,IAAI3E,IACrB+C,EAAgB,KACVuB,GAAc,IAAInL,IAAIuJ,GAAekC,WACrCJ,GAAQ,IAAIrL,IAAIuJ,GAAekC,UAChClC,EAAcyB,GACjBC,MAEDS,OAODhP,QAAS4O,EACTC,WAQF,GANIN,IACFhV,EAAIgV,SAAWA,GAEbE,IACFlV,EAAIkV,WAAaA,GAEfC,EAAO,CACTnV,EAAI0V,UAAY,GAChB1V,EAAI2V,aAAe,GACnB3V,EAAI4V,aAAe,GACnB,IAAK,MAAM,KAAEC,EAAI,MAAER,EAAK,QAAEC,KAAaH,EACrCnV,EAAI0V,UAAUjiB,KAAKoiB,GACnB7V,EAAI2V,aAAaliB,KAAK4hB,GACtBrV,EAAI4V,aAAaniB,KAAK6hB,EAE1B,CACA,OAAOtV,IAGX,CAoG4B8V,CAAmBnB,SACrChC,EAAUf,EAAI,CAACjC,EAAaC,GAAiBS,GAAgB,EAAE0F,EAAYC,GAAYlD,KAC3F,IAAImD,EACAC,EACAC,EAAO,EAEX,SAASC,IACQ,KAATD,GAKR,WACE,GAAIF,IAAYpB,GAAQqB,IAAWtB,EAEjC,OAGFmB,EAAWM,QAEX,IAAK,MAAMnW,KAAQ4U,EACjBiB,EAAWO,IAAIpW,GAEjB8V,EAAUM,IAAIzB,EAAM5E,GACpB+F,EAAUM,IAAI1B,EAAK1E,GACnB6D,EAAOjB,EACT,CAlBIyD,EAEJ,CAkBA1C,EAAOmC,EAAW/F,GAAUxE,IAC1BwK,EAAUxK,EACV2K,GAAc,IAGhBvC,EAAOmC,EAAW9F,GAASzE,IACzByK,EAASzK,EACT2K,GAAc,GACd,GAEN,CAAE,QACF,CACF,CASAlc,eAAesc,EAAuB5E,EAAI6E,GACxC,MAAMlB,EAAS5B,EAAgBL,EAAcmD,IAE7C,OAAKlB,EAAOthB,OAIL0e,EAAUf,EAAIjC,EAAaS,GAAe,CAAC2F,EAAYjD,EAAK5e,KAEjE,MAAMwiB,EAAsB,GAQtBC,EAAS,KACb,MAAMpC,EAAUP,EAAkB0C,GAAqB1F,GAAKA,EAAEvK,UAC9DvS,EAAGqgB,EAAQkB,MAAK,CAAChgB,EAAGmhB,IAAMnhB,EAAEwf,MAAQ2B,EAAE3B,OAAS,EAAI,IAAG,EAGxD,IAAK,IAAI7gB,EAAI,EAAGA,EAAImhB,EAAOthB,OAAQG,IAAK,CACtC,MAAMyiB,EAAQtB,EAAOnhB,GACf0iB,EAAQ1iB,IAAMmhB,EAAOthB,OAAS,EAChC8iB,YAAYC,MAAMH,EAAOA,EAAQ,KAAU,GAAO,GAClDE,YAAYE,KAAKJ,GACrB/C,EAAUiC,EAAWmB,MAAMpH,GAAegH,GAAOrL,IAC/CiL,EAAoBjjB,KAAKgY,GAhBvBiL,EAAoBziB,SAAWshB,EAAOthB,QACxC0iB,GAgBW,GAEf,KA3BO,EA6BX,CAIAzc,eAAeid,EAAqBvF,EAAIwF,GACtC,MAAM5G,QAAegG,EAAsB5E,EAAIwF,GAO/C,IAAK5G,EAAOvc,OAAQ,CAClB,MAAMojB,EAAYrG,IAAOA,EAAEkE,YAAc,IAAIhL,SAASkN,EAAUvN,eAChE,aAxIJ3P,eAAkD0X,EAAIyF,GAgBpD,OAAO1E,EAAUf,EAAIjC,EAAaS,GAAe,CAAC2F,EAAYjD,EAAK5e,KACjE,IAAIojB,EAEJ,MAAMC,EAAmB,KACvBxB,EAAWyB,OAAOF,GAAWP,YAAYU,WAAWH,GAAS,GAL9C,IAKiE7F,UAAY1c,IAC1F,MAAMwf,EAAUxf,EAAEwR,OAAOkF,OACzB,IAAK,MAAMA,KAAU8I,EAEnB,GADA+C,EAAU7L,EAAOhF,QACb4Q,EAAU5L,GACZ,OAAOvX,EAAGuX,GAGd,GAAI8I,EAAQtgB,OAbC,GAcX,OAAOC,IAETqjB,GAAkB,CACnB,EAEHA,GAAkB,GAEtB,CAoGkBG,CAAkC9F,EAAIyF,IAAe,IACrE,CAEA,OAAO7G,EAAOzP,QAAOiQ,IACnB,MAAM2G,GAAmB3G,EAAEkE,YAAc,IAAInL,KAAIiH,GAAKA,EAAEnH,gBACxD,OAAO8N,EAAgBzN,SAASkN,EAAUvN,cAAa,IACtD,IAAM,IACX,CAaA,SAAS+N,EAAKhG,EAAIgB,EAAW5f,GAC3B,OAAO2f,EAAUf,EAAIgB,EAAWxC,GAAe,CAAC+B,EAAOW,EAAK5e,IAC1D2f,EAAO1B,EAAOnf,EAAKkB,IAEvB,CA0HA,MAAM2jB,EAAiB,CACrB,OACA,OAaF,SAASC,EAAkBC,IAV3B,SAA6BA,GAC3B,MAAMC,EAAUD,GAAgBvjB,MAAMwjB,QAAQD,GACxCE,EAAoBD,GACxBD,EAAa9jB,UACX8jB,EAAa,IAAMF,EAAerD,MAAKxhB,KAASA,KAAO+kB,EAAa,OACxE,IAAKC,GAAWC,EACd,MAAM,IAAI9f,MAAM,wCAEpB,CAGE+f,CAAmBH,GAEnB,MAAMI,EAAa,CAAC1iB,EAAGmhB,IAAMnhB,EAAEoE,KAAKgQ,cAAgB+M,EAAE/c,KAAKgQ,eAAiB,EAAI,EAK1EuO,EAAML,EAAatC,KAAK0C,GAgBxBE,EApGR,SAAe5H,EAAK6H,GAClB,MAAMvO,EAAM,IAAIwO,IAChB,IAAK,MAAM1H,KAAQJ,EAAK,CACtB,MAAM8E,EAAS+C,EAAazH,GAC5B,IAAK,MAAMgG,KAAStB,EAAQ,CAC1B,IAAIiD,EAAazO,EACjB,IAAK,IAAI3V,EAAI,EAAGA,EAAIyiB,EAAM5iB,OAAQG,IAAK,CACrC,MAAMqkB,EAAO5B,EAAMrc,OAAOpG,GAC1B,IAAIskB,EAAUF,EAAWZ,IAAIa,GACxBC,IACHA,EAAU,IAAIH,IACdC,EAAW7H,IAAI8H,EAAMC,IAEvBF,EAAaE,CACf,CACA,IAAIC,EAAeH,EAAWZ,IAjBhB,IAkBTe,IACHA,EAAe,GACfH,EAAW7H,IApBC,GAoBgBgI,IAE9BA,EAAallB,KAAKod,EACpB,CACF,CAoCA,MAlCe,CAAC4F,EAAOmC,KACrB,IAAIJ,EAAazO,EACjB,IAAK,IAAI3V,EAAI,EAAGA,EAAIqiB,EAAMxiB,OAAQG,IAAK,CACrC,MAAMqkB,EAAOhC,EAAMjc,OAAOpG,GACpBskB,EAAUF,EAAWZ,IAAIa,GAC/B,IAAIC,EAGF,MAAO,GAFPF,EAAaE,CAIjB,CAEA,GAAIE,EAEF,OADgBJ,EAAWZ,IAvCb,KAwCI,GAGpB,MAAMrD,EAAU,GAEVsE,EAAQ,CAACL,GACf,KAAOK,EAAM5kB,QAAQ,CACnB,MACM6kB,EAAqB,IADRD,EAAME,QACiBzG,WAAWmD,MAAK,CAAChgB,EAAGmhB,IAAMnhB,EAAE,GAAKmhB,EAAE,IAAM,EAAI,IACvF,IAAK,MAAO5jB,EAAKuC,KAAUujB,EAjDb,KAkDR9lB,EACFuhB,EAAQ9gB,QAAQ8B,GAEhBsjB,EAAMplB,KAAK8B,EAGjB,CACA,OAAOgf,EAIX,CAyCqByE,CAAKjB,GAXF1C,IACpB,MAAM1E,EAAM,IAAIC,IAChB,GAAIyE,EAAMH,WACR,IAAK,MAAMkC,KAAa/B,EAAMH,WAC5B,IAAK,MAAM2B,KAASvD,EAAc8D,GAChCzG,EAAIhU,IAAIka,GAId,OAAOlG,KAGHsI,EAAqBjI,GAAKqH,EAAWrH,GAAG,GACxCkI,EAAiBlI,GAAKqH,EAAWrH,GAAG,GAgBpCmI,EAAmB,IAAIZ,IACvBa,EAAc,IAAIb,IACxB,IAAK,MAAMc,KAAetB,EAAc,CACtCqB,EAAYzI,IAAI0I,EAAYxf,KAAKgQ,cAAewP,GAChD,IAAK,MAAMjC,KAAciC,EAAYnE,YAAc,GACjDiE,EAAiBxI,IAAIyG,EAAUvN,cAAewP,EAElD,CAKA,MAAO,CACLjB,MACAkB,OAzBa7C,IACb,MAAMlB,EAASjC,EAAcmD,GAI7B,OAAOzC,EAHqBuB,EAAOxL,KAAI,CAAC8M,EAAOziB,KAC5CA,EAAImhB,EAAOthB,OAAS,EAAIglB,EAAqBC,GAAgBrC,MAElB7F,GAAKA,EAAEnX,OAAM4b,KAAK0C,EAAU,EAqB1EoB,YANkBnC,GAAa+B,EAAiBvB,IAAIR,EAAUvN,eAO9D2P,OANa3f,GAAQuf,EAAYxB,IAAI/d,EAAKgQ,eAQ9C,CAEA,MAAM4P,EAAoD,oBAApBC,gBAItC,SAASC,EAAYtE,GACnB,IAAKA,EACH,OAAOA,EAST,GAJIoE,IACFpE,EAAQuE,gBAAgBvE,WAEnBA,EAAME,OACTF,EAAMK,UAAW,CACnB,MAAMjhB,EAAM4gB,EAAMK,UAAUzhB,OAC5BohB,EAAMF,MAAQ3gB,MAAMC,GACpB,IAAK,IAAIL,EAAI,EAAGA,EAAIK,EAAKL,IACvBihB,EAAMF,MAAM/gB,GAAK,CACfyhB,KAAMR,EAAMK,UAAUthB,GACtBqS,QAAS4O,EAAMM,aAAavhB,GAC5BkhB,QAASD,EAAMO,aAAaxhB,WAGzBihB,EAAMK,iBACNL,EAAMM,oBACNN,EAAMO,YACf,CACA,OAAOP,CACT,CAEA,SAASwE,EAAUhF,GACZA,GACHlU,QAAQmZ,KAAK,0FAEjB,CAEA,MAAMC,EAAe,CACnB,aACA,QACA,QACA,QACA,WAaF,SAASC,EAAcC,EAAUC,GAC/B,GAA0C,IAAtCxW,KAAKC,MAAMsW,EAASxM,OAAS,KAC/B,MAAM,IAAItV,MAAM,oBAAsB+hB,EAAa,MAAQD,EAASxM,OAExE,CAUAvT,eAAeigB,EAAgBD,GAC7B,MAAMD,QAAiBta,MAAMua,GAC7BF,EAAaC,EAAUC,GACvB,MAAMrF,EAAOoF,EAASra,QAAQgY,IAAI,QAClCiC,EAAShF,GACT,MAAMF,QAAkBsF,EAASha,OAEjC,OA/BF,SAA0B0U,GACxB,IAAKA,IACFngB,MAAMwjB,QAAQrD,KACdA,EAAU,IACc,iBAAjBA,EAAU,IAClBoF,EAAavF,MAAKxhB,KAAUA,KAAO2hB,EAAU,MAC7C,MAAM,IAAIxc,MAAM,oCAEpB,CAsBEiiB,CAAgBzF,GACT,CAACE,EAAMF,EAChB,CAiDAza,eAAemgB,EAAcC,GAE3B,IAAIC,EAdN,SAAmCC,GAK/B,IAJA,IAAIvmB,EAASumB,EAAOvmB,OAChBwmB,EAAM,IAAIC,YAAYzmB,GACtBwc,EAAM,IAAIkK,WAAWF,GACrBrmB,GAAK,IACAA,EAAIH,GACTwc,EAAIrc,GAAKomB,EAAOI,WAAWxmB,GAE/B,OAAOqmB,CACX,CAKiBI,CADE/a,KAAKC,UAAUua,IAIhC,MACMQ,EAtCR,SAAmCC,GAK/B,IAJA,IAAIP,EAAS,GACTQ,EAAQ,IAAIL,WAAWI,GACvB9mB,EAAS+mB,EAAMC,WACf7mB,GAAK,IACAA,EAAIH,GACTumB,GAAUU,OAAOC,aAAaH,EAAM5mB,IAExC,OAAOomB,CACX,CA6BuBY,OADGC,OAAOC,OAAOC,OAAO,QAAShB,IAGtD,OADYiB,KAAKV,EAEnB,CAEA5gB,eAAeuhB,EAAiB7J,EAAIsI,GAElC,IAAIvF,EACAE,QA/EN3a,eAAwBggB,GACtB,MAAMD,QAAiBta,MAAMua,EAAY,CAAE7hB,OAAQ,SACnD2hB,EAAaC,EAAUC,GACvB,MAAMrF,EAAOoF,EAASra,QAAQgY,IAAI,QAElC,OADAiC,EAAShF,GACFA,CACT,CAyEmB6G,CAAQxB,GACzB,IAAKrF,EAAM,CACT,MAAM8G,QAAoBxB,EAAeD,GACzCrF,EAAO8G,EAAY,GACnBhH,EAAYgH,EAAY,GACnB9G,IACHA,QAAawF,EAAa1F,GAE9B,CACA,SAngBFza,eAAwB0X,EAAIgD,EAAKC,GAC/B,MAAOoB,EAASC,SAAgB/b,QAAQie,IAAI,CAACnI,EAAUC,GACpDnG,KAAI/W,GAAO4kB,EAAIhG,EAAIhC,EAAgB5c,MACtC,OAAQijB,IAAYpB,GAAQqB,IAAWtB,CACzC,CA+fYgH,CAAQhK,EAAIsI,EAAYrF,QAAc,CAC9C,IAAKF,EAAW,CAEdA,SAD0BwF,EAAeD,IACjB,EAC1B,OACMxF,EAAS9C,EAAI+C,EAAWuF,EAAYrF,EAC5C,CACF,CAaA,MAAMgH,EACJ,WAAAjiB,EAAa,WAAEsgB,EArzBW,mFAqzBqB,OAAE4B,EApzB5B,KAozBmD,YAAEzC,EAAc,IAAO,CAAC,GAC9F9lB,KAAK2mB,WAAaA,EAClB3mB,KAAKuoB,OAASA,EACdvoB,KAAKwoB,QAAU,wBAAwBxoB,KAAKuoB,SAC5CvoB,KAAKyoB,SAAMxd,EACXjL,KAAK0oB,iBAAczd,EACnBjL,KAAK2oB,QAAUpE,EAAiBuB,GAEhC9lB,KAAK4oB,OAAS5oB,KAAK4oB,OAAOC,KAAK7oB,MAC/BA,KAAK8oB,OAAS9oB,KAAK+oB,OACrB,CAEA,WAAMA,GACJ,MAAM1K,EAAKre,KAAKyoB,UA/uBGrK,EA+uBsBpe,KAAKwoB,QA9uB3C7K,EAAcS,KACjBT,EAAcS,GAAUD,EAAeC,IAElCT,EAAcS,IAJvB,IAAuBA,GAyDvB,SAA6BA,EAAQyB,GACnC,IAAIxe,EAAYuc,EAAiBQ,GAC5B/c,IACHA,EAAYuc,EAAiBQ,GAAU,IAEzC/c,EAAUnB,KAAK2f,EACjB,CAkrBImJ,CAAmBhpB,KAAKwoB,QAASxoB,KAAK4oB,QACtC,MAAMjC,EAAa3mB,KAAK2mB,WAClBsC,QA7iBVtiB,eAAwB0X,GACtB,aAAegG,EAAIhG,EAAIhC,EAAgBM,EACzC,CA2iBwBuM,CAAQ7K,GAExB4K,QA/BRtiB,eAAqC0X,EAAIsI,GACvC,IAAKrF,EAAMF,SAAmBwF,EAAeD,GACxCrF,IAGHA,QAAawF,EAAa1F,UAGtBD,EAAS9C,EAAI+C,EAAWuF,EAAYrF,EAC5C,CAuBY6H,CAAqB9K,EAAIsI,GAE/B3mB,KAAK0oB,YAAcR,EAAgB7J,EAAIsI,EAE3C,CAEA,WAAMyC,GACJ,MAAMC,EAAa1iB,UACZ3G,KAAK8oB,SACR9oB,KAAK8oB,OAAS9oB,KAAK+oB,SAEd/oB,KAAK8oB,cAERO,IAIDrpB,KAAKyoB,WACFY,GAEV,CAEA,qBAAMC,CAAiB3N,GAGrB,OAFAO,EAAaP,SACP3b,KAAKopB,QACJpM,QA7eXrW,eAAgC0X,EAAI1C,GAClC,OAAOyD,EAAUf,EAAIjC,EAAaS,GAAe,CAAC2F,EAAYjD,EAAK5e,KACjE,MAAM4iB,EAAQC,YAAYC,MAAM,CAAC9H,EAAO,GAAI,CAACA,EAAQ,EAAG,IAAI,GAAO,GACnE4E,EAAUiC,EAAWmB,MAAMlH,GAAwB8G,EAAO5iB,EAAG,GAEjE,CAwe2B2oB,CAAgBtpB,KAAKyoB,IAAK9M,IAAQnF,IAAI4P,EAC/D,CAEA,2BAAMnD,CAAuBC,GAC3BlH,EAAqBkH,SACfljB,KAAKopB,QAGX,MAAO,IAFSppB,KAAK2oB,QAAQ5C,OAAO7C,MACpBlG,QAAgBiG,EAAsBjjB,KAAKyoB,IAAKvF,IAAQ1M,IAAI4P,GAK9E,CAEA,yBAAMxC,CAAqBC,GACzB7H,EAAqB6H,SACf7jB,KAAKopB,QACX,MAAMG,EAASvpB,KAAK2oB,QAAQ3C,YAAYnC,GACxC,OAAI0F,GAGGnD,QAAiBxC,EAAoB5jB,KAAKyoB,IAAK5E,GACxD,CAEA,6BAAM2F,CAAyBC,GAC7BzN,EAAqByN,SACfzpB,KAAKopB,QACX,MAAMG,EAASvpB,KAAK2oB,QAAQ1C,OAAOwD,GACnC,OAAIF,GAGGnD,QA7cXzf,eAAkC0X,EAAInL,GACpC,OAAOkM,EAAUf,EAAIjC,EAAaS,GAAe,CAAC2F,EAAYjD,EAAK5e,IACjE2f,EAAOkC,EAAYtP,GAASgF,IAC1B,GAAIA,EACF,OAAOvX,EAAGuX,GAEZoI,EAAOkC,EAAWmB,MAAM5G,GAAqB7J,GAASgF,GAAUvX,EAAGuX,GAAU,OAAM,KAGzF,CAoc4BwR,CAAkB1pB,KAAKyoB,IAAKgB,GACtD,CAEA,0BAAME,GAEJ,aADM3pB,KAAKopB,cACG/E,EAAIrkB,KAAKyoB,IAAKpM,EAAgBO,IAA4B,CAC1E,CAEA,0BAAMgN,CAAsBC,GAG1B,OAFA3N,EAAa2N,SACP7pB,KAAKopB,QAtcD/K,EAucCre,KAAKyoB,IAvcShpB,EAucYmd,EAvcP5a,EAuc+B6nB,EAtcxDzK,EAAUf,EAscMhC,EAtcSS,GAAgB,CAAC8B,EAAOW,KACtDX,EAAMmE,IAAI/gB,EAAOvC,GACjB+gB,EAAOjB,EAAI,IAHf,IAAclB,EAAe5e,EAAKuC,CAwchC,CAEA,iCAAM8nB,CAA6BL,GAGjC,OAFAzN,EAAqByN,SACfzpB,KAAKopB,QArcuB/K,EAscCre,KAAKyoB,IAtcFvV,EAscOuW,EArcxCrK,EAAUf,EAAI/B,EAAiBQ,GAAgB,CAAC8B,EAAOW,IAC5De,EAAO1B,EAAO1L,GAASgF,IACrB0G,EAAMmE,KAAK7K,GAAU,GAAK,EAAGhF,GAC7BsN,EAAOjB,EAAI,MAJjB,IAAsClB,EAAInL,CAucxC,CAEA,yBAAM6W,CAAqBC,GAGzB,OAFA9N,EAAa8N,SACPhqB,KAAKopB,eAlcf,SAA8B/K,EAAIkG,EAAkByF,GAClD,OAAc,IAAVA,EACK,GAEF5K,EAAUf,EAAI,CAAC/B,EAAiBF,GAAcS,GAAe,EAAEoN,EAAgBzH,GAAajD,EAAK5e,KACtG,MAAMqgB,EAAU,GAChBiJ,EAAetG,MAAMnH,GAAa0N,gBAAWjf,EAAW,QAAQiT,UAAY1c,IAC1E,MAAM2oB,EAAS3oB,EAAEwR,OAAOkF,OACxB,IAAKiS,EACH,OAAOxpB,EAAGqgB,GAGZ,SAASoJ,EAAWlS,GAElB,GADA8I,EAAQ9gB,KAAKgY,GACT8I,EAAQtgB,SAAWspB,EACrB,OAAOrpB,EAAGqgB,GAEZmJ,EAAOE,UACT,CAEA,MAAMZ,EAAgBU,EAAOG,WACvBf,EAAShF,EAAiB0B,OAAOwD,GACvC,GAAIF,EACF,OAAOa,EAAUb,GAInBjJ,EAAOkC,EAAYiH,GAAe3H,IAChC,GAAIA,EACF,OAAOsI,EAAUtI,GAGnBqI,EAAOE,UAAU,GACjB,CACH,GAEL,CA+ZkBN,CAAoB/pB,KAAKyoB,IAAKzoB,KAAK2oB,QAASqB,IAAQxT,IAAI4P,EACxE,CAEA,eAAIN,CAAatB,GACfxkB,KAAK2oB,QAAUpE,EAAiBC,EAClC,CAEA,eAAIsB,GACF,OAAO9lB,KAAK2oB,QAAQ9D,GACtB,CAEA,eAAM0F,SACEvqB,KAAKopB,QACX,UACQppB,KAAK0oB,WACb,CAAE,MAAOvb,GAAmD,CAC9D,CAGA,MAAAyb,GAKE5oB,KAAKyoB,IAAMzoB,KAAK8oB,OAAS9oB,KAAK0oB,iBAAczd,CAC9C,CAEA,WAAM2U,SACE5f,KAAKuqB,kBACLpL,EAAcnf,KAAKwoB,QAC3B,CAEA,YAAM,GAxzBR,IAAyBpK,QAyzBfpe,KAAKuqB,kBAzzBUnM,EA0zBApe,KAAKwoB,QAzzBrB,IAAI5hB,SAAQ,CAACpC,EAASsZ,KAE3BqB,EAAcf,GAEdP,EAAsBrZ,EAASsZ,EADnBQ,UAAUkM,eAAepM,GACM,IAszB7C,E,2XCx9BF,MAAMtC,EAAY,CAChB,EAAE,EAAG,IAAK,UACV,CAAC,EAAG,KAAM,mBACV,CAAC,EAAG,KAAM,eACV,CAAC,EAAG,KAAM,kBACV,CAAC,EAAG,KAAM,cACV,CAAC,EAAG,MAAO,iBACX,CAAC,EAAG,IAAK,cACT,CAAC,EAAG,KAAM,WACV,CAAC,EAAG,KAAM,WACV,CAAC,EAAG,KAAM,UACVtF,KAAI,EAAE9L,EAAIoX,EAAOxb,MAAU,CAAGoE,KAAIoX,QAAOxb,WAErCmkB,EAAS3O,EAAU3a,MAAM,GAMzBupB,EAAqC,mBAAxBC,oBAAqCA,oBAAsBxhB,WAG9E,SAASyhB,EAAQ9I,GACf,OAAOA,EAAM5O,QAAQyD,SAAS,IAChC,CAWA,MAAMkU,EAAuB,CAC3B,KAAM,KACN,KAAM,GACN,KAAM,KACN,KAAM,KACN,KAAM,GACN,KAAM,EACN,QAAS,EACT,KAAM,EACN,UAAW,EACX,KAAM,EACN,MAAO,GACP,KAAM,IAWFC,EAA2B,CAC/B,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MAQIC,EAAc,0IAIdC,EAA2B,CAAC9oB,EAAGmhB,IAAMnhB,EAAImhB,GAAK,EAAInhB,EAAImhB,EAAI,EAAI,EAQ9D4H,EAAiB,CAACpiB,EAAMqiB,KAC5B,MAAMC,EAASriB,SAAS+E,cAAc,UACtCsd,EAAOC,MAAQD,EAAOE,OAAS,EAE/B,MAAMC,EAAMH,EAAOI,WAAW,KAAM,CAGlCC,oBAAoB,IAQtB,OANAF,EAAIG,aAAe,MACnBH,EAAII,KAAO,SAASX,IACpBO,EAAIK,UAAYT,EAChBI,EAAIM,MAAM,IAAM,KAChBN,EAAIO,SAAShjB,EAAM,EAAG,GAEfyiB,EAAIQ,aAAa,EAAG,EAAG,EAAG,GAAGnf,MAYtC,SAASof,EAAyBljB,GAGhC,MAAMmjB,EAAWf,EAAepiB,EAAM,QAChCojB,EAAWhB,EAAepiB,EAAM,QACtC,OAAOmjB,GAAYC,GAdG,EAACD,EAAUC,KACjC,MAAMC,EAAc,IAAIF,GAAUG,KAAK,KAKvC,OAAOD,IAJa,IAAID,GAAUE,KAAK,OAIAD,EAAYE,WAAW,SAAQ,EAQvCC,CAAgBL,EAAUC,EAC3D,CAuBA,IAAIK,EACJ,MAAMC,EAA0B,KACzBD,IAIHA,EAAU,IAAI1lB,SAAQpC,GACpBkmB,GAAI,IACFlmB,EA1BR,WACE,MAAMua,EAAUpd,OAAOod,QAAQ8L,GAC/B,IAEE,IAAK,MAAO/I,EAAOC,KAAYhD,EAC7B,GAAIgN,EAAwBjK,GAC1B,OAAOC,CAGb,CAAE,MAAOvgB,GACT,CAIA,OAAOud,EAAQ,GAAG,EACpB,CAWgByN,SAIPF,GAIHG,EAAqB,IAAIzH,IA2B/B,SAAS0H,EAAM5sB,GACbA,EAAMiU,iBACNjU,EAAM6sB,iBACR,CAIA,SAASC,EAAsBC,EAAWC,EAAK5P,GAO7C,OANA4P,GAAQD,GAAa,EAAI,GACf,EACRC,EAAM5P,EAAIxc,OAAS,EACVosB,GAAO5P,EAAIxc,SACpBosB,EAAM,GAEDA,CACT,CAGA,SAAStP,EAAQN,EAAKC,GACpB,MAAMC,EAAM,IAAIC,IACV5Q,EAAM,GACZ,IAAK,MAAM6Q,KAAQJ,EAAK,CACtB,MAAMzd,EAAM0d,EAAKG,GACZF,EAAIG,IAAI9d,KACX2d,EAAIhU,IAAI3J,GACRgN,EAAIvM,KAAKod,GAEb,CACA,OAAO7Q,CACT,CAgCA,MAAMsgB,EAAMC,sBAMZ,IA8BIC,EA9BAC,EAAoD,mBAAnBC,eAoBrC,SAASC,EAAoBC,GAG3B,CACE,MAAM9J,EAAQza,SAASwkB,cAEvB,OADA/J,EAAMgK,WAAWF,EAAKG,YACfjK,EAAMkK,wBAAwBrC,KACvC,CACF,CAmDA,SAASsC,EAAYC,EAAOluB,EAAK0d,GAC/B,IAAIyQ,EAASD,EAAMtJ,IAAI5kB,GAKvB,OAJKmuB,IACHA,EAASzQ,IACTwQ,EAAMvQ,IAAI3d,EAAKmuB,IAEVA,CACT,CAEA,SAAStlB,EAAUtG,GACjB,MAAO,GAAKA,CACd,CAQA,MAAM6rB,EAAa,IAAIC,QACjBC,EAAoB,IAAID,QAExBE,EAAgB/rB,OAAO,YAGvBgsB,EAAqB,oBAAqBC,QAAQxuB,UA4BxD,SAASyuB,EAAeC,EAAaC,GACnC,MAAM,WAAEC,GAAeD,EACvB,IAAI,iBAAEE,GAAqBF,EAEvBG,GAAgB,EAEhBD,EACFC,EAxBJ,SAAiCC,EAAYL,GAC3C,IAAIM,EAAWD,EAAWjB,WACtBmB,EAAmB,EAEvB,KAAOD,GAAU,CAGf,GAFiBN,EAAYO,KAEZD,EACf,OAAO,EAETA,EAAWA,EAASE,YACpBD,GACF,CAEA,OAAOA,IAAqBP,EAAY1tB,MAC1C,CASoBmuB,CAAuBN,EAAkBH,IAEzDI,GAAgB,EAChBH,EAAgBC,gBAAarjB,EAC7BojB,EAAgBE,iBAAmBA,EAAmBD,EAAWG,YAG/DD,GAzCN,SAA0BC,EAAYL,GAEhCH,EACFQ,EAAWK,mBAAmBV,IAE9BK,EAAW9f,UAAY,GACvB8f,EAAWM,UAAUX,GAEzB,CAkCIU,CAAgBP,EAAkBH,EAEtC,CA6CA,SAASY,EAAOhN,GACd,IAAIiN,EAAa,GAEbC,GAAY,EACZC,GAAkB,EAClBC,GAAuB,EAE3B,MAAMC,EAAqB,IAAIrK,IACzBsK,EAAiB,GAEvB,IAAK,IAAIzuB,EAAI,EAAGK,EAAM8gB,EAAOthB,OAAQG,EAAIK,EAAKL,IAAK,CACjD,MAAMyiB,EAAQtB,EAAOnhB,GAGrB,GAFAouB,GAAc3L,EAEVziB,IAAMK,EAAM,EACd,MAGF,IAAK,IAAIquB,EAAI,EAAGA,EAAIjM,EAAM5iB,OAAQ6uB,IAAK,CAErC,OADajM,EAAMrc,OAAOsoB,IAExB,IAAK,IAEc,MADAjM,EAAMrc,OAAOsoB,EAAI,GAGhCD,EAAevoB,OAEfmoB,GAAY,EACZI,EAAepvB,OAAOkvB,IAExB,MAEF,IAAK,IACHF,GAAY,EACZC,GAAkB,EAClB,MAEF,IAAK,IACHA,GAAkB,EAIxB,CAEA,MACMK,EAAW9B,EAAW2B,EADPC,EAAeA,EAAe5uB,OAAS,IACE,IAAM,KAEpE,IAAI+uB,EACAC,EACAC,EACJ,GAAIR,EAAiB,CAEnB,MAAMjP,EAAQ,oBAAoB0P,KAAKtM,GACvCmM,EAAgBvP,EAAM,GACtBwP,EAAoBxP,EAAM,GAC1ByP,EAAqB,UAAUC,KAAK5N,EAAOnhB,EAAI,IAAI,EACrD,CAEA,MAAMgvB,EAAU,CACdJ,gBACAC,oBACAC,qBACAG,gBAAiBjvB,GAGnB2uB,EAAStvB,KAAK2vB,GAETX,GAAcC,IAEjBF,GAAc,IAElB,CAEA,MAAMc,EA/KR,SAAwBd,GACtB,MAAMc,EAAWjnB,SAAS+E,cAAc,YAExC,OADAkiB,EAASphB,UAAYsgB,EACdc,CACT,CA2KmBC,CAAcf,GAE/B,MAAO,CACLc,WACAV,qBAEJ,CAEA,SAASY,EAAeT,EAAUngB,EAAS6gB,GACzC,IAAK,IAAIrvB,EAAI,EAAGA,EAAI2uB,EAAS9uB,OAAQG,IAAK,CACxC,MAAMgvB,EAAUL,EAAS3uB,GAMnBwtB,EAAkB,CACtBwB,UACAvB,WANiBuB,EAAQJ,cACvBpgB,EACAA,EAAQme,WAKVe,sBAAkBtjB,EAClBklB,uBAAmBllB,GAGrBilB,EAAiBhwB,KAAKmuB,EACxB,CACF,CA2BA,SAAS+B,EAAWpO,GAElB,MAAM,SAAE+N,EAAQ,mBAAEV,GAAuB3B,EAAWG,EAAY7L,GAAQ,IAAMgN,EAAMhN,KAG9EqO,EAAMN,EAASO,WAAU,GAAMC,QAAQC,kBACvCN,EA/BR,SAAmCO,EAAapB,GAC9C,MAAMa,EAAmB,GAEzB,IAAIQ,EACJ,GAAgC,IAA5BrB,EAAmBsB,OAAeD,EAAmBrB,EAAmBhL,IAAI,IAG9E4L,EAAcS,EAAkBD,EAAaP,OACxC,CAEL,MAAMU,EAAa9nB,SAAS+nB,iBAAiBJ,EAAaK,WAAWC,cAErE,IAAI1hB,EAAUohB,EACVO,GAAgB,EACpB,EAAG,CACD,MAAMxB,EAAWH,EAAmBhL,MAAM2M,GACtCxB,GACFS,EAAcT,EAAUngB,EAAS6gB,EAErC,OAAU7gB,EAAUuhB,EAAWK,WACjC,CAEA,OAAOf,CACT,CAQ2BgB,CAAyBb,EAAKhB,GAEvD,OAAO,SAA4B8B,GAEjC,OAlLJ,SAAgBA,EAAajB,GAC3B,IAAK,MAAM7B,KAAmB6B,EAAkB,CAC9C,MAAM,WACJ5B,EAAU,kBACV6B,EACAN,SAAS,gBACPC,EAAe,cACfL,EAAa,kBACbC,EAAiB,mBACjBC,IAEAtB,EAEE+C,EAAaD,EAAYrB,GAE/B,GAAIK,IAAsBiB,EAO1B,GAFA/C,EAAgB8B,kBAAoBiB,EAEhC3B,EACFnB,EAAW+C,aAAa5B,EAAeC,EAAoBpnB,EAAS8oB,GAAczB,OAC7E,CACL,IAAI2B,EACArwB,MAAMwjB,QAAQ2M,GAChBjD,EAAciD,EAAY/C,GACjB+C,aAAsBlD,SAC/BoD,EAAUF,EACV9C,EAAWiD,YAAYD,IAIvBhD,EAAWkD,UAAYlpB,EAAS8oB,GAE9BE,IACFjD,EAAgBC,WAAagD,EAEjC,CACF,CACF,CAwIIG,CAAMN,EAAajB,GACZG,CACT,CACF,CA8BA,SAASqB,EAAQC,EAAWC,EAAOC,EAASC,EAAQC,EAASC,EAAMC,EAAaC,EAAeC,GAC7F,MAAM,cAAEC,EAAa,cAAEC,EAAa,gBAAEC,GAAoBT,GACpD,KAAEU,EAAI,IAAE/b,GA9BhB,SAA0Bob,GACxB,MAAMY,EAAe9E,EAAWK,EAAmB6D,GAAO,IAAM,IAAI5M,MACpE,IAAIyN,EAAsBzE,EAuB1B,MAAO,CAAExX,IAZT,SAAcqK,EAAOrG,EAAUkY,GAC7B,OAAO7R,EAAMrK,KAAI,CAAC8G,EAAMqG,KACtB,MAAMgP,EAAmBF,EACzBA,EAAsBC,EAAYpV,GAClC,IACE,OAAO9C,EAAS8C,EAAMqG,EACxB,CAAE,QACA8O,EAAsBE,CACxB,IAEJ,EAEcJ,KArBd,SAAevQ,KAAWmP,GAGxB,MAAMyB,EAAwBlF,EAAW8E,EAAcxQ,GAAQ,IAAM,IAAIgD,MAGzE,OAF0B0I,EAAWkF,EAAuBH,GAAqB,IAAMrC,EAAUpO,IAE1F6Q,CAAkB1B,EAC3B,EAeF,CAIwB2B,CAAgBlB,GAEtC,SAASmB,EAAW9V,EAAQ+V,EAAYC,GACtC,OAAOzc,EAAIyG,GAAQ,CAAC6E,EAAOjhB,IAClB0xB,CAAI,iBAAiBS,EAAa,SAAW,8BAA8BA,EAAanyB,IAAM+wB,EAAMsB,iBAAmB,mBAAmBd,EAActQ,EAAO8P,EAAMuB,4BAA4Bd,EAAcvQ,cAC5M,SACCkR,GAAcnyB,IAAM+wB,EAAMsB,iBAAmB,UAAY,KACzDpR,EAAM5O,QAAU,GAAK,yBACf,GAAG+f,KAAUnR,EAAMpX,gBAAgBoX,EAAM5O,QAAU,GAAK,kCAAkC3G,KAAKC,UAAUsV,EAAMT,YAC9HS,EAAM5O,QACFof,EAAgBxQ,EAAO8P,EAAMuB,iBAC7B,gBAILrR,GAAS,GAAGmR,KAAUnR,EAAMpX,MACjC,CAEA,MAgCM0oB,EA/BGb,CAAI,8DAA8DX,EAAMyB,KAAKC,uBAAuB1B,EAAM2B,aAAe,yLAAyL3B,EAAMyB,KAAKG,6FAA6F5B,EAAMoB,aAAcpB,EAAM6B,cAAc/yB,iIAAiIkxB,EAAM8B,mBAAqB,OAAO9B,EAAM8B,qBAAuB,oIAAoI9B,EAAMyB,KAAKG,qEAAqE5B,EAAMyB,KAAKM,qEAAqE/B,EAAMgC,qCAAuC,WAAa,iDAAiDhC,EAAMiC,uBAAyB,aAAe,mBAAmBjC,EAAMkC,+BAA+BlC,EAAMkC,uGAAuGlC,EAAMiC,+FAA+FjC,EAAMmC,oBAAsB,oEAAoEnC,EAAMyB,KAAKW,iHAAiHpC,EAAMiC,uBAAyB,GAAK,oDAAoDjC,EAAMiC,uBAAyB,EAAI,4FAA4FjC,EAAMyB,KAAKY,mDAAmDrC,EAAMsC,iCAAiCtC,EAAMiC,+MAC92Drd,EAAIob,EAAMzP,WAAW,CAAC0H,EAAUhpB,IACzB0xB,CAAI,qBAAqB1xB,mBAAmBA,IAAM+wB,EAAMsC,eAAiB,SAAW,sBAAsBrzB,IAAM+wB,EAAMsC,wCAAwCtC,EAAMyB,KAAKlR,UAAUthB,mBAAmB+wB,EAAMyB,KAAKlR,UAAUthB,OAAOgpB,YACtOA,GAAYA,sFACwE+H,EAAMnH,OAAO/pB,4BAA4BkxB,EAAMyB,KAAKc,8EACnI3d,EAAIob,EAAMnH,QAAS9O,GACV4W,CAAI,4DAA4D5W,EAAMjR,mBAAmBknB,EAAMyB,KAAKe,WAAWzY,EAAMrV,0BAA0BsrB,EAAMoB,YAAcpB,EAAMyC,aAAa3pB,KAAOiR,EAAMjR,cAAcknB,EAAMyB,KAAKe,WAAWzY,EAAMrV,yBAAyBqV,EAAMjR,oCAAoCiR,EAAMmG,yBAC5TnG,GAASA,EAAMjR,gGACoGknB,EAAM0C,OAAS,EAAI,GAAM1C,EAAM2C,kBAAoB,0CAA0C3C,EAAM1jB,QAAU,GAAK,2CAA2C0jB,EAAM1jB,SAAW,4DAA6D0jB,EAAM4C,gBAAkB5C,EAAM1jB,QAAW,OAAS,aAAa0jB,EAAMoB,WAAa,SAAW,2BAA2BpB,EAAMoB,WAAapB,EAAMyB,KAAKoB,mBAAqB7C,EAAMyB,KAAKe,WAAWxC,EAAMyC,aAAa/tB,cAAcsrB,EAAMoB,WAAa,GAAK,OAAOpB,EAAMyC,aAAa3pB,8FACnnB8L,EAAIob,EAAM8C,6BAA6B,CAACC,EAAmB9zB,IAClD0xB,CAAI,4BAA4B1xB,sBAAmE,IAA7C+wB,EAAM8C,4BAA4Bh0B,QAAkE,KAAlDkxB,EAAM8C,4BAA4B,GAAGE,SAAkB,OAAS,0BAC7KhD,EAAMoB,WACFpB,EAAMyB,KAAKoB,mBAEXE,EAAkBC,SACdD,EAAkBC,SAElBhD,EAAM8C,4BAA4Bh0B,OAAS,EACvCkxB,EAAMyB,KAAKe,WAAW7K,OACtBqI,EAAMyB,KAAKe,WAAWxC,EAAMyC,aAAa/tB,qCAGjB,IAANzF,GAAY+wB,EAAMoB,aAAyC,IAA3BpB,EAAMyC,aAAa3pB,GAAgC,GAApB,6BAAkC,eAAeyF,KAAK0kB,KAAKF,EAAkB1X,OAAOvc,OAASkxB,EAAMkD,2DAA2DlD,EAAMoB,WAAa,UAAY,uCAAuCnyB,UAAU+wB,EAAMoB,WAAa,iBAAmB,OACrXD,EAAU4B,EAAkB1X,OAAQ2U,EAAMoB,WAAyB,uBAEhE2B,GAAqBA,EAAkBC,mEACahD,EAAM1jB,QAAU,OAAS,+BAA+B0jB,EAAMyB,KAAK0B,gDAC5HhC,EAAUnB,EAAMoD,kBAAmC,EAAoB,kJAO3EC,EAA0B,CAACxF,EAAejV,KAC9C,IAAK,MAAMnL,KAAWsiB,EAAUphB,iBAAiB,IAAIkf,MACnDjV,EAASnL,EAASA,EAAQ6lB,aAAazF,GACzC,EAGF,GAAI0C,EAAa,CACfR,EAAU1kB,YAAYmmB,GAKtB,IAAK,MAAM+B,IAAa,CAAC,QAAS,WAAY,QAAS,UAAW,SAChEF,EAAwB,WAAWE,KAAa,CAAC9lB,EAAS+lB,KACxD/lB,EAAQxP,iBAAiBs1B,EAAWrD,EAAOsD,GAAc,IAK7DH,EAAwB,YAAY,CAAC5lB,EAASgmB,KAC5CrD,EAAKqD,GAAOhmB,CAAO,IAIrB4iB,EAAYpyB,iBAAiB,SAAS,KACpC8xB,EAAU2D,YAAYlC,EAAQ,GAElC,CAGA6B,EAAwB,eAAe,CAAC5lB,EAASkmB,KAC/C,IAAIC,EAAetD,EAAc7N,IAAIkR,GAChCC,GACHtD,EAAc9U,IAAImY,EAASC,EAAe,IAAIC,SAI3CD,EAAajY,IAAIlO,KACpBmmB,EAAapsB,IAAIiG,GACjB0iB,EAAQwD,GAAQlmB,GAClB,GAEJ,CAGA,MAAMqmB,EAA+B,mBAAnBC,eAAgCA,eAAiBnb,GAAY5T,QAAQpC,UAAUE,KAAK8V,GAqFtG,SAASob,EAA0BC,EAAMC,EAAOC,GAC9C,GAAIF,EAAKn1B,SAAWo1B,EAAMp1B,OACxB,OAAO,EAET,IAAK,IAAIG,EAAI,EAAGA,EAAIg1B,EAAKn1B,OAAQG,IAC/B,IAAKk1B,EAAaF,EAAKh1B,GAAIi1B,EAAMj1B,IAC/B,OAAO,EAGX,OAAO,CACT,CAEA,MAAMm1B,EAA4B,IAAIlI,QAqCtC,MAAMmI,EAAc,IAEd,OAAEC,GAAWv0B,OAEnB,SAASw0B,EAAYC,EAAYC,GAC/B,MAAMrE,EAAO,CAAC,EACRsE,EAAkB,IAAIC,gBACtBtE,EAAcqE,EAAgBE,QAC9B,MAAE5E,EAAK,aAAE6E,GA5IjB,SAAsBxE,GACpB,IACIyE,EADAC,GAAY,EAGhB,MAAMC,EAAmB,IAAI5R,IACvB6R,EAAiB,IAAIxZ,IAE3B,IAAIyZ,EAEJ,MAAMC,EAAQ,KACZ,GAAIJ,EACF,OAEF,MAAMK,EAAiB,IAAIH,GAC3BA,EAAe/T,QACf,IACE,IAAK,MAAMmU,KAAYD,EACrBC,GAEJ,CAAE,QACAH,GAAS,EACLD,EAAelG,OACjBmG,GAAS,EACTpB,EAAGqB,GAEP,GAGInF,EAAQ,IAAIsF,MAAM,CAAC,EAAG,CAC1B,GAAA7S,CAAKrR,EAAQmkB,GACX,GAAIT,EAAiB,CACnB,IAAIU,EAAYR,EAAiBvS,IAAI8S,GAChCC,IACHA,EAAY,IAAI/Z,IAChBuZ,EAAiBxZ,IAAI+Z,EAAMC,IAE7BA,EAAUhuB,IAAIstB,EAChB,CACA,OAAO1jB,EAAOmkB,EAChB,EACA,GAAA/Z,CAAKpK,EAAQmkB,EAAME,GACjB,GAAIrkB,EAAOmkB,KAAUE,EAAU,CAC7BrkB,EAAOmkB,GAAQE,EACf,MAAMD,EAAYR,EAAiBvS,IAAI8S,GACvC,GAAIC,EAAW,CACb,IAAK,MAAMH,KAAYG,EACrBP,EAAeztB,IAAI6tB,GAEhBH,IACHA,GAAS,EACTpB,EAAGqB,GAEP,CACF,CACA,OAAO,CACT,IAqBF,OAJA9E,EAAYpyB,iBAAiB,SAAS,KACpC82B,GAAY,CAAI,IAGX,CACL/E,QACA6E,aApBoBjc,IACpB,MAAM8c,EAAW,KACf,MAAMC,EAAcb,EACpBA,EAAkBY,EAClB,IACE,OAAO9c,GACT,CAAE,QACAkc,EAAkBa,CACpB,GAEF,OAAOD,GAAS,EAYpB,CA4DkCE,CAAYvF,GACtCC,EAAgB,IAAIlN,IAG1BkR,EAAOtE,EAAO,CACZ6F,mBAAexsB,EACfooB,UAAMpoB,EACNysB,cAAUzsB,EACV6a,iBAAa7a,EACb0sB,2BAAuB1sB,EACvB2sB,kBAAc3sB,IAIhBirB,EAAOtE,EAAOyE,GAGdH,EAAOtE,EAAO,CACZiG,aAAa,EACbpE,cAAe,GACfiB,4BAA6B,GAC7BoD,cAAe,GACfC,WAAY,GACZ/E,YAAY,EACZE,kBAAmB,EACnBhlB,aAASjD,EACT4oB,wBAAwB,EACxBD,sCAAsC,EACtCT,gBAAiB,EACjBe,eAAgB,EAChBH,wBAAoB9oB,EACpBsoB,iBAAatoB,EACb6oB,oBAAqB,GACrB3R,UAAW,GACX6S,iBAAkB,GAClBgD,2BAAuB/sB,EACvB6pB,WA70BwB,EA80BxBR,OAAO,EACPC,kBAAmB,EACnB9J,OAAQA,EACR+J,gBAAgB,EAChBd,wBAAoBzoB,IAMtBwrB,GAAa,KACP7E,EAAMyC,eAAiBzC,EAAMnH,OAAOmH,EAAM2C,qBAC5C3C,EAAMyC,aAAezC,EAAMnH,OAAOmH,EAAM2C,mBAC1C,IAOF,MAAMzgB,EAAQpJ,IACZ0rB,EAAWjrB,eAAeT,GAAIoJ,OAAO,EAGjCmkB,EAAiBnW,GAASsU,EAAWjrB,eAAe,OAAO2W,EAAMpX,MAGjEwtB,EAAY,CAAC5xB,EAAM2M,KACvB+e,EAAKvB,YAAY0H,cAAc,IAAIC,YAAY9xB,EAAM,CACnD2M,SACAolB,SAAS,EACTC,UAAU,IACT,EAOCC,EAAqB,CAACr2B,EAAGmhB,IAAMnhB,EAAEwI,KAAO2Y,EAAE3Y,GAE1C8tB,EAAqC,CAACt2B,EAAGmhB,KAC7C,MAAQuR,SAAU6D,EAAWxb,OAAQyb,GAAYx2B,GACzC0yB,SAAU+D,EAAW1b,OAAQ2b,GAAYvV,EAEjD,OAAIoV,IAAcE,GAIX/C,EAAyB8C,EAASE,EAASL,EAAkB,EAQhEM,EAAuBC,IACtBlD,EAAyBhE,EAAM6B,cAAeqF,EAAWP,KAC5D3G,EAAM6B,cAAgBqF,EACxB,EAIIC,EAAoBC,IACpBpH,EAAMoB,aAAegG,IACvBpH,EAAMoB,WAAagG,EACrB,EAYI1G,EAAkB,CAACxQ,EAAOqR,IAC7BA,GAAmBrR,EAAMF,OAASE,EAAMF,MAAMuR,IAAqBrR,EAAM5O,QAetE2e,EAAU,CACdO,cAboB,CAACtQ,EAAOqR,KAAoB,OAppBrCjW,EAqpBN,CACF4E,EAAMxb,MAAQgsB,EAAgBxQ,EAAOqR,GACtCrR,EAAMN,cACFM,EAAMH,YAAcsU,GACxBzoB,OAAO2S,SAxpBJ3C,EAAON,GAAKO,GAAKA,KAwpBH0O,KAAK,MAzpB5B,IAAejP,CA0pBZ,EAOgBmV,cALMvQ,GACrBA,EAAMN,aAAeM,EAAMH,YAAcsU,GAAa9J,KAAK,MAI7BmG,mBAE1BR,EAAS,CACbmH,sBAyeF,SAAgCn5B,GAC9B8xB,EAAMiC,wBAA0BjC,EAAMiC,uBACtCjC,EAAMsC,eAAiBtC,EAAMuB,gBAEzBvB,EAAMiC,yBACRnH,EAAK5sB,GACLitB,GAAI,IAAMjZ,EAAM,mBAEpB,EAhfEolB,aAmcFvyB,eAA6B7G,GAC3B,MAAM,OAAEkT,GAAWlT,EAEnB,IAAKkT,EAAOhK,UAAUsB,SAAS,SAE7B,OAEFoiB,EAAK5sB,GAGUq5B,EAFJnmB,EAAOtI,GAAG0uB,UAAU,GAGjC,EA7cEC,WA2YF,SAAqBv5B,GACnB,MAAM,OAAEkT,GAAWlT,EACbw5B,EAAgBtmB,EAAO0B,QAAQ,eAErC,IAAK4kB,EACH,OAEF,MAAMllB,EAAU2G,SAASue,EAAc7uB,QAAQ2J,QAAS,IACxD4d,EAAKuH,cAAcv3B,MAAQ,GAC3B4vB,EAAMkG,cAAgB,GACtBlG,EAAMmG,WAAa,GACnBnG,EAAMsB,kBAAoB,EAC1BtB,EAAM2C,kBAAoB3C,EAAMnH,OAAOvJ,WAAUzD,GAAKA,EAAE/S,KAAO0J,GACjE,EAvZEolB,aAyZF,SAAuB15B,GACrB,MAAM,OAAEkT,EAAM,IAAEvT,GAAQK,EAElB25B,EAAUC,IACVA,IACFhN,EAAK5sB,GACL45B,EAAG5lB,QACL,EAGF,OAAQrU,GACN,IAAK,YACH,OAAOg6B,EAAQzmB,EAAOqC,wBACxB,IAAK,aACH,OAAOokB,EAAQzmB,EAAOpB,oBACxB,IAAK,OACH,OAAO6nB,EAAQzmB,EAAOhH,cAAcwkB,mBACtC,IAAK,MACH,OAAOiJ,EAAQzmB,EAAOhH,cAAc2tB,kBAE1C,EA5aEC,gBA2WF,SAA0B95B,GACxB,IAAK8xB,EAAMoB,aAAepB,EAAM6B,cAAc/yB,OAC5C,OAGF,MAAMm5B,EAAsBC,IAC1BpN,EAAK5sB,GACL8xB,EAAMsB,iBAAmBtG,EAAqBkN,EAAUlI,EAAMsB,iBAAkBtB,EAAM6B,cAAc,EAGtG,OAAQ3zB,EAAML,KACZ,IAAK,YACH,OAAOo6B,GAAmB,GAC5B,IAAK,UACH,OAAOA,GAAmB,GAC5B,IAAK,QACH,IAAgC,IAA5BjI,EAAMsB,iBAKR,OADAxG,EAAK5sB,GACEq5B,EAAWvH,EAAM6B,cAAc7B,EAAMsB,kBAAkBxoB,IAH9DknB,EAAMsB,iBAAmB,EAMjC,EAlYE6G,uBAwdF,SAAiCj6B,GAC/B,MAAQkT,QAAQ,GAAEtI,IAAS5K,EACrBogB,EAAQxV,GAAMA,EAAGwV,MAAM,kBAE7B,IAAKA,EACH,OAEFwM,EAAK5sB,GAELk6B,EADiBjf,SAASmF,EAAM,GAAI,IAEtC,EAjeE+Z,0BAyiBFtzB,eAA0C7G,GAExC,MAAM,cAAEo6B,GAAkBp6B,EAGrBo6B,GAAsC,kBAArBA,EAAcxvB,KAClCknB,EAAMiC,wBAAyB,EAEnC,EAhjBEsG,yBAyfF,SAAmCr6B,GAGjC,IAAK8xB,EAAMiC,uBACT,OAEF,MAAMuG,EAAuBzzB,UAC3B+lB,EAAK5sB,GACL8xB,EAAMsC,eAAiBmG,CAAY,EAGrC,OAAQv6B,EAAML,KACZ,IAAK,UACH,OAAO26B,EAAqBxN,GAAqB,EAAMgF,EAAMsC,eAAgBtC,EAAMzP,YACrF,IAAK,YACH,OAAOiY,EAAqBxN,GAAqB,EAAOgF,EAAMsC,eAAgBtC,EAAMzP,YACtF,IAAK,OACH,OAAOiY,EAAqB,GAC9B,IAAK,MACH,OAAOA,EAAqBxI,EAAMzP,UAAUzhB,OAAS,GACvD,IAAK,QAIH,OADAgsB,EAAK5sB,GACEk6B,EAAepI,EAAMsC,gBAC9B,IAAK,SAGH,OAFAxH,EAAK5sB,GACL8xB,EAAMiC,wBAAyB,EACxB/f,EAAM,mBAEnB,EAthBEwmB,uBAwhBF,SAAiCx6B,GAG/B,IAAK8xB,EAAMiC,uBACT,OAEF,GACO,MADC/zB,EAAML,IAKV,OADAitB,EAAK5sB,GACEk6B,EAAepI,EAAMsC,eAElC,EApiBEqG,cAgjBF,SAAwBz6B,GACtB8xB,EAAMkG,cAAgBh4B,EAAMkT,OAAOhR,KACrC,GAhjBM+vB,EAAU,CACdyI,wBAkLF,SAAkCnN,IA/5BpC,SAA+BA,EAAM4E,EAAawI,GAChD,IAAIC,EACAxN,GACFwN,EAAiB,IAAIvN,eAAesN,GACpCC,EAAeC,QAAQtN,IAEvBN,EAAI0N,GAINxI,EAAYpyB,iBAAiB,SAAS,KAChC66B,GACFA,EAAeE,YACjB,GAEJ,CAi5BIC,CAAqBxN,EAAM4E,GAAa,KAEtC,CAEE,MAAM6I,EAAQC,iBAAiB/I,EAAKvB,aAC9BuK,EAAgBjgB,SAAS+f,EAAMG,iBAAiB,iBAAkB,IAClEC,EAAmD,QAAxCJ,EAAMG,iBAAiB,aAGxCrJ,EAAMkD,WAAakG,EACnBpJ,EAAM0C,MAAQ4G,CAChB,IAEJ,EA/LEC,qBAmMF,SAA+B9N,IAnYjC,SAAqCA,EAAM4E,EAAapS,GAEtD,CAEE,MAAMub,EAAO/N,EAAK3Y,QAAQ,aAE1B,IAAIuiB,EAAWjB,EAA0B3R,IAAI+W,GACxCnE,IAIHA,EAAW,IAAIoE,qBAAqBxb,EAAU,CAC5Cub,OAEAE,WAAY,kBAEZC,UAAW,IAIbvF,EAA0B5Y,IAAIge,EAAMnE,GAGpChF,EAAYpyB,iBAAiB,SAAS,KACpCo3B,EAAS2D,YAAY,KAIzB3D,EAAS0D,QAAQtN,EACnB,CACF,CAsWImO,CAA2BnO,EAAM4E,GAAclT,IAC7C,IAAK,MAAM,OAAE/L,EAAM,eAAEyoB,KAAoB1c,EACvC/L,EAAOhK,UAAU6K,OAAO,WAAY4nB,EACtC,GAEJ,GAtMA,IAAItJ,GAAc,EAsIlB,SAASuJ,IAGP,MAAM,YAAE5V,EAAW,SAAE4R,GAAa9F,EAC5B+J,EAAsB7V,GAAemQ,EACvCyB,EAAS5R,cAAgB6V,IAG3BjE,EAAS5R,YAAc6V,EAE3B,CA/IAlF,GAAa,KACX/E,EAAO0E,EAAYxE,EAAOC,EAASC,EAAQC,EAASC,EAAMC,EAAaC,EAAeC,GACtFA,GAAc,CAAK,IAQhBP,EAAMgG,cACTrL,IAA0B7nB,MAAKk3B,IAGxBA,IACHhK,EAAM1jB,QAAU0jB,EAAMyB,KAAKwI,wBAC7B,IAQJpF,GAAa,KAuBP7E,EAAM8F,UArBV/wB,iBACE,IAAIm1B,GAAwB,EAC5B,MAAMC,EAAgB5yB,YAAW,KAC/B2yB,GAAwB,EACxBlK,EAAM1jB,QAAU0jB,EAAMyB,KAAK2I,cAAc,GAl+BV,KAo+BjC,UACQpK,EAAM8F,SAAStO,QACrBwI,EAAM4C,gBAAiB,CACzB,CAAE,MAAOrnB,GACPC,QAAQsD,MAAMvD,GACdykB,EAAM1jB,QAAU0jB,EAAMyB,KAAK4I,mBAC7B,CAAE,QACAC,aAAaH,GACTD,IACFA,GAAwB,EACxBlK,EAAM1jB,QAAU,GAEpB,CACF,CAIEiuB,EACF,IAOF1F,GAAa,KACX7E,EAAM2B,YAAc,yBACF3B,EAAMnH,OAAO/pB,wCACNkxB,EAAMoB,WAAa,EAAI,gCACV,IAOxCyD,GAAa,KACP7E,EAAM9L,aAAe8L,EAAM8F,UAC7BgE,GACF,IAGFjF,GAAa,KACP7E,EAAM9L,aAAe8L,EAAM9L,YAAYplB,OACrCkxB,EAAMnH,SAAW3O,IACnB8V,EAAMnH,OAAS3O,GAER8V,EAAMnH,SAAWA,IACtBmH,EAAM2C,mBAGR3C,EAAM2C,oBAER3C,EAAMnH,OAASA,EACjB,IAOFgM,GAAa,MACX9vB,iBACMirB,EAAM4C,iBACR5C,EAAMuB,sBAAwBvB,EAAM8F,SAAS/N,uBAEjD,CAEeyS,EAAyB,IAG1C3F,GAAa,KACX7E,EAAMzP,UAAYlhB,MA9kCC,GA8kCqBo7B,OAAO7lB,KAAI,CAACiH,EAAG5c,IA/6B3D,SAAwBob,EAAK4N,GAC3B,GAAiB,IAAbA,EACF,OAAO5N,EAET,MAAMqgB,EAAWrgB,EAAIsgB,QAXX,KAYV,OAAkB,IAAdD,EACKrgB,EAAImd,UAAU,EAAGkD,GACtB3U,OAAO6U,cAbW,OAaqB3S,EAAW,GAClD5N,EAAImd,UAAUkD,IAEdrgB,EAAIwgB,SAnBiB,OAoBvBxgB,EAAMA,EAAImd,UAAU,EAAGnd,EAAIvb,OAAS,IAE/Bub,EArBiB,SAqBS0L,OAAO6U,cAlBT,MAkBkD3S,EAAW,GAC9F,CAi6BiE6S,CAAc9K,EAAM6F,cAAe52B,IAAG,IAGrG41B,GAAa,KACX7E,EAAMmC,mBAAqBnC,EAAMzP,UAAUyP,EAAMuB,gBAAgB,IAGnEsD,GAAa,KACX7E,EAAMkC,oBAAsBlC,EAAMyB,KAAKsJ,cAAclxB,QAAQ,aAAcmmB,EAAMyB,KAAKlR,UAAUyP,EAAMuB,iBAAiB,IAOzHsD,GAAa,KASP7E,EAAM4C,gBARV7tB,iBACE,MAAM,SAAE+wB,GAAa9F,EACfgL,SAAch2B,QAAQie,IAAIiG,EAAyBtU,KAAItD,GAC3DwkB,EAASlO,wBAAwBtW,OAC9B1F,OAAO2S,SACZyR,EAAMoG,sBAAwB4E,CAChC,CAGiBC,EACjB,IAeFpG,GAAa,KAYP7E,EAAM4C,gBAAkB5C,EAAMoG,uBAXlCrxB,iBACE+0B,IACA,MAAM,SAAEhE,EAAQ,sBAAEM,EAAqB,WAAElD,GAAelD,EAClDkL,QAAoBpF,EAAS3N,oBAAoB+K,GACjDiI,QAAkBC,EAAgBxf,EAAO,IAC1Csf,KACA9E,IACFva,GAAMA,EAAEvK,SAAWuK,EAAEnX,OAAOnF,MAAM,EAAG2zB,IACxClD,EAAMoD,iBAAmB+H,CAC3B,CAGiBE,EACjB,IA6CFxG,GAAa,MACX9vB,iBACE,MAAM,WAAEoxB,EAAU,aAAE1D,EAAY,eAAEG,EAAc,YAAE1O,GAAgB8L,EAClE,GAAK4C,EAGE,GAAIuD,EAAWr3B,QAzrCG,EAyrC+B,CACtD,MAAMo4B,QA6EZnyB,eAAuCuc,GACrC,OAAO8Z,QAAsBE,QAA4BtL,EAAM8F,SAASzU,sBAAsBC,IAChG,CA/E8Bia,CAAuBpF,GAC3CnG,EAAMmG,aAAeA,IACvBc,EAAoBC,GACpBC,GAAiB,GAErB,KAAO,CACL,MAAQruB,GAAI+K,GAAmB4e,EAE/B,IAAwB,IAApB5e,GAA0BqQ,GAAeA,EAAYplB,OAAS,CAChE,MAAMo4B,QA8DdnyB,eAAiCgV,GAE/B,MAAMmG,GAAmB,IAAXnG,EAAeiW,EAAM9L,kBAAoB8L,EAAM8F,SAASpO,gBAAgB3N,GACtF,OAAOqhB,QAAsBE,EAAsBpb,GACrD,CAlEgCsb,CAAiB3nB,GACrCmc,EAAMyC,aAAa3pB,KAAO+K,IAC5BojB,EAAoBC,GACpBC,GAAiB,GAErB,CACF,MAlBEnH,EAAM6B,cAAgB,GACtB7B,EAAMoB,YAAa,CAkBvB,CAEeqK,EAAc,IAG/B,MAAMC,EAAsB,KAC1BvQ,GAAI,KAr5BR,IAAmC1d,KAq5BI2iB,EAAKuL,mBAl5BxCluB,EAAQf,UAAY,EAk5BoC,GAAC,EAmC3D,SAASkvB,EAAgB1b,GACvB,OAAQA,EAAM5O,UAAY0X,EAAO9I,IAAU2K,EAAmBpI,IAAIvC,EAAM5O,QAC1E,CAEAvM,eAAeu2B,EAAuBjgB,GACpC,MAAMwgB,EAAoB7L,EAAMgG,oBAAsBrL,IAEtD,OAAOtP,EAAOzP,QAAO,EAAGuU,cAAeA,GAAWA,GAAW0b,GAC/D,CAEA92B,eAAeq2B,EAAiB/f,GAC9B,OA5iCJ,SAA+BA,EAAQwgB,GACrC,MAAMC,EAAmB9b,IACvB,MAAMnV,EAAM,CAAC,EACb,IAAK,MAAMkxB,KAAQ/b,EAIQ,iBAAd+b,EAAKrb,MAAqBqb,EAAK5b,SAAW0b,IACnDhxB,EAAIkxB,EAAKrb,MAAQqb,EAAKzqB,SAG1B,OAAOzG,GAGT,OAAOwQ,EAAOzG,KAAI,EAAGtD,UAAS0O,QAAOD,aAAYN,MAAK/a,OAAMsuB,WAAUpT,iBAAiB,CACrFtO,UACA5M,OACAqb,aACAN,MACAuT,WACApT,aACA9W,GAAIwI,GAAW5M,EACfsb,MAAOA,GAAS8b,EAAiB9b,MAErC,CAohCWgc,CAAqB3gB,EAAQ2U,EAAMgG,oBAAsBrL,IAClE,CA6IA5lB,eAAewyB,EAAY1P,GACzB,MAAM3H,QAAc8P,EAAM8F,SAASlO,wBAAwBC,GACrDoU,EAAe,IAAIjM,EAAM6B,iBAAkB7B,EAAMoD,kBACpD8I,MAAKrgB,GAAMA,EAAE/S,KAAO+e,IACjBsU,EAAmBF,EAAa3qB,SAAWof,EAAgBuL,EAAcjM,EAAMuB,uBAC/EvB,EAAM8F,SAAS5N,4BAA4BL,GACjDyO,EAAU,cAAe,CACvBpW,QACA+H,SAAU+H,EAAMuB,mBACZ4K,GAAoB,CAAE7qB,QAAS6qB,MAC/BF,EAAav3B,MAAQ,CAAEA,KAAMu3B,EAAav3B,OAElD,CAmBA,SAAS0zB,EAAgBnQ,GACvB+H,EAAMuB,gBAAkBtJ,EACxB+H,EAAMiC,wBAAyB,EAC/B/f,EAAM,mBACNokB,EAAU,mBAAoB,CAAErO,aACjB+H,EAAM8F,SAAS9N,qBAAqBC,EACrD,CAkGA,OA7TA4M,GAAa,KACX,MAAM,cAAEhD,EAAa,aAAEmE,GAAiBhG,EAClCoM,EAAmBvK,EACtBjmB,QAAOsU,GAASA,EAAM5O,UACtB1F,QAAOsU,GAAS8I,EAAO9I,KAAW2K,EAAmBlP,IAAIuE,EAAM5O,WAClE,IAAK0kB,GAAgBoG,EAAiBt9B,OAEpCm4B,EAAoBpF,GACpB1G,GAAI,IASR,SAAmCiR,GACjC,MAAMC,EA98BV,SAA0BD,EAAkBE,EAAejG,GACzD,IAAIgG,GAAe,EACnB,IAAK,MAAMnc,KAASkc,EAAkB,CACpC,MACMG,EAAa/Q,EADH6K,EAAenW,SAEG,IAAvBmL,IACTA,EAAqBG,EAAmB8Q,IAM1C,MAAME,EAAYD,EAAa,IAAMlR,EACrCR,EAAmBrP,IAAI0E,EAAM5O,QAASkrB,GAEjCA,IACHH,GAAe,EAEnB,CACA,OAAOA,CACT,CA07ByBI,CAAgBL,EAAkBhM,EAAKkM,cAAejG,GACvEgG,EAEFX,IAIA1L,EAAM6B,cAAgB,IAAI7B,EAAM6B,cAEpC,CAnBc6K,CAAyBN,SAC9B,CACL,MAAMlF,EAAYlB,EAAenE,EAAgBA,EAAcjmB,OAAOgwB,GACtE3E,EAAoBC,GAEpBwE,GACF,KAuCF7G,GAAa,SAQbA,GAAa,KAzV6B,CAAC8H,IACpC3I,EAAyBhE,EAAM8C,4BAA6B6J,EAAyB/F,KACxF5G,EAAM8C,4BAA8B6J,EACtC,EAiXAC,CA1BA,WACE,MAAM,WAAExL,EAAU,cAAES,GAAkB7B,EACtC,GAAIoB,EACF,MAAO,CACL,CACE4B,SAAU,GACV3X,OAAQwW,IAId,MAAMgL,EAAoB,IAAIzZ,IAC9B,IAAK,MAAMlD,KAAS2R,EAAe,CACjC,MAAMmB,EAAW9S,EAAM8S,UAAY,GACnC,IAAI3X,EAASwhB,EAAkBpa,IAAIuQ,GAC9B3X,IACHA,EAAS,GACTwhB,EAAkBrhB,IAAIwX,EAAU3X,IAElCA,EAAO/c,KAAK4hB,EACd,CACA,MAAO,IAAI2c,EAAkB1f,WAC1BvI,KAAI,EAAEoe,EAAU3X,MAAY,CAAG2X,WAAU3X,aACzCiF,MAAK,CAAChgB,EAAGmhB,IAAMuO,EAAM+F,sBAAsBz1B,EAAE0yB,SAAUvR,EAAEuR,WAC9D,CAEgC8J,GAC0B,IAO5DjI,GAAa,KACX7E,EAAM8B,oBAAiD,IAA5B9B,EAAMsB,kBAA2BtB,EAAM6B,cAAc7B,EAAMsB,kBAAkBxoB,EAAE,IAO5G+rB,GAAa,KACX,MAAM,cAAEqB,GAAkBlG,EAC1BlH,GAAI,KACFkH,EAAMmG,YAAcD,GAAiB,IAAIphB,OACzCkb,EAAMsB,kBAAoB,CAAC,GAC3B,IA0IJuD,GAAa,KACP7E,EAAMiC,uBACR7B,EAAK2M,iBAAiB9+B,iBAAiB,iBAAiB,KACtD+xB,EAAMgC,sCAAuC,CAAI,GAChD,CAAEzzB,MAAM,IAEXyxB,EAAMgC,sCAAuC,CAC/C,IAgEK,CACL,IAAAgL,CAAMC,GACJ3I,EAAOtE,EAAOiN,EAChB,EACA,QAAAC,GACExI,EAAgByI,OAClB,EAEJ,CAKA,IAAIC,EAAS,CACX7K,gBAAiB,aACjB0H,wBAAyB,6CACzB9G,eAAgB,YAChBiH,eAAgB,WAChBC,oBAAqB,wBACrB3I,YAAa,eACbK,kBAAmB,qFACnBH,YAAa,SACbiB,mBAAoB,iBACpBT,oBAAqB,iEACrB2I,cAAe,4CACf1I,eAAgB,aAChB9R,UAAW,CACT,UACA,QACA,eACA,SACA,cACA,QAEFiS,WAAY,CACV7K,OAAQ,SACR,kBAAmB,wBACnB,cAAe,kBACf,iBAAkB,qBAClB,aAAc,iBACd,gBAAiB,oBACjB0V,WAAY,aACZC,QAAS,UACTC,QAAS,UACTC,MAAO,UAMX,MAAMC,EAAQ,CACZ,cACA,wBACA,WACA,aACA,OACA,SACA,gBACA,gBAIIC,EAAe,6BAA6BvU,KAElD,MAAMwU,UAAsBC,YAC1B,WAAAn5B,CAAagwB,GACXoJ,QACAz/B,KAAK0/B,aAAa,CAAEC,KAAM,SAC1B,MAAM7E,EAAQhyB,SAAS+E,cAAc,SACrCitB,EAAM5xB,YArBO,kyLAqBoBo2B,EACjCt/B,KAAKo2B,WAAWnpB,YAAY6tB,GAC5B96B,KAAK4/B,KAAO,CAEVrX,OA9DiB,KA+DjB5B,WAhEsB,mFAiEtB8Q,cA1jD0B,MA2jD1BE,sBAAuB3M,EACvBlF,YAAa,KACbuN,KAAM2L,EACNpH,aAAc,QACXvB,GAGL,IAAK,MAAMc,KAAQkI,EACJ,aAATlI,GAAuBx1B,OAAOjC,UAAUmC,eAAeuB,KAAKpD,KAAMm3B,KACpEn3B,KAAK4/B,KAAKzI,GAAQn3B,KAAKm3B,UAChBn3B,KAAKm3B,IAGhBn3B,KAAK6/B,UACP,CAEA,iBAAAC,GAGO9/B,KAAK+/B,OACR//B,KAAK+/B,KAAO5J,EAAWn2B,KAAKo2B,WAAYp2B,KAAK4/B,MAEjD,CAEA,oBAAAI,GAGEtK,GAAG,KAED,IAAK11B,KAAKigC,aAAejgC,KAAK+/B,KAAM,CAClC//B,KAAK+/B,KAAKjB,WACV9+B,KAAK+/B,UAAO90B,EAEZ,MAAM,SAAEysB,GAAa13B,KAAK4/B,KAC1BlI,EAAS9X,QAENsgB,OAAM/yB,GAAOC,QAAQsD,MAAMvD,IAChC,IAEJ,CAEA,6BAAWgzB,GACT,MAAO,CAAC,SAAU,cAAe,kBAAmB,gBACtD,CAEA,wBAAAC,CAA0BC,EAAUC,EAAUjJ,GAC5Cr3B,KAAKugC,KAGHF,EAAS50B,QAAQ,aAAa,CAACgS,EAAG+iB,IAAOA,EAAGC,gBAE/B,kBAAbJ,EAA+BK,WAAWrJ,GAAYA,EAE1D,CAEA,IAAAkJ,CAAMpJ,EAAME,GACVr3B,KAAK4/B,KAAKzI,GAAQE,EACdr3B,KAAK+/B,MACP//B,KAAK+/B,KAAKnB,KAAK,CAAE,CAACzH,GAAOE,IAEvB,CAAC,SAAU,cAAc1gB,SAASwgB,IACpCn3B,KAAK6/B,UAET,CAEA,SAAAc,GACE,MAAM,OAAEpY,EAAM,WAAE5B,EAAU,SAAE+Q,GAAa13B,KAAK4/B,KAEzClI,GAAYA,EAASnP,SAAWA,GAAUmP,EAAS/Q,aAAeA,GACrE3mB,KAAKugC,KAAK,WAAY,IAAI,UAAS,CAAEhY,SAAQ5B,eAEjD,CAIA,QAAAkZ,GACEnK,GAAG,IACD11B,KAAK2gC,aAET,EAGF,MAAMC,EAAc,CAAC,EAErB,IAAK,MAAMzJ,KAAQkI,EACjBuB,EAAYzJ,GAAQ,CAClB,GAAA9S,GAME,MALa,aAAT8S,GAGFn3B,KAAK2gC,YAEA3gC,KAAK4/B,KAAKzI,EACnB,EACA,GAAA/Z,CAAK0P,GACH,GAAa,aAATqK,EACF,MAAM,IAAIvyB,MAAM,yBAElB5E,KAAKugC,KAAKpJ,EAAMrK,EAClB,GAIJnrB,OAAOk/B,iBAAiBtB,EAAc7/B,UAAWkhC,GAG5CE,eAAezc,IAAI,iBACtByc,eAAet+B,OAAO,eAAgB+8B,E,0GC3tDxC,IAAIv9B,GAAQ,EACZ,IACIA,EAAkC,oBAAnB++B,gBACX,oBAAqB,IAAIA,cACjC,CACA,MAAO5zB,GAGP,CACO,MAAM6zB,EAAUh/B,C,2ECFhB,SAASi/B,EAAOzhC,GACnB,IAAIyc,EAAM,GACV,IAAK,IAAIpb,KAAKrB,EACNA,EAAIqC,eAAehB,KACfob,EAAIvb,SACJub,GAAO,KACXA,GAAOnG,mBAAmBjV,GAAK,IAAMiV,mBAAmBtW,EAAIqB,KAGpE,OAAOob,CACX,CAOO,SAASilB,EAAOC,GACnB,IAAIC,EAAM,CAAC,EACPC,EAAQF,EAAGnhB,MAAM,KACrB,IAAK,IAAInf,EAAI,EAAGyC,EAAI+9B,EAAM3gC,OAAQG,EAAIyC,EAAGzC,IAAK,CAC1C,IAAIygC,EAAOD,EAAMxgC,GAAGmf,MAAM,KAC1BohB,EAAIG,mBAAmBD,EAAK,KAAOC,mBAAmBD,EAAK,GAC/D,CACA,OAAOF,CACX,C,iJCdA,MAAMI,EAAK,sPACLC,EAAQ,CACV,SAAU,WAAY,YAAa,WAAY,OAAQ,WAAY,OAAQ,OAAQ,WAAY,OAAQ,YAAa,OAAQ,QAAS,UAElI,SAASzS,EAAM/S,GAClB,GAAIA,EAAIvb,OAAS,IACb,KAAM,eAEV,MAAMiK,EAAMsR,EAAKoH,EAAIpH,EAAIsgB,QAAQ,KAAM/6B,EAAIya,EAAIsgB,QAAQ,MAC7C,GAANlZ,IAAiB,GAAN7hB,IACXya,EAAMA,EAAImd,UAAU,EAAG/V,GAAKpH,EAAImd,UAAU/V,EAAG7hB,GAAGiK,QAAQ,KAAM,KAAOwQ,EAAImd,UAAU53B,EAAGya,EAAIvb,SAE9F,IAAIghC,EAAIF,EAAG5R,KAAK3T,GAAO,IAAK0lB,EAAM,CAAC,EAAG9gC,EAAI,GAC1C,KAAOA,KACH8gC,EAAIF,EAAM5gC,IAAM6gC,EAAE7gC,IAAM,GAU5B,OARU,GAANwiB,IAAiB,GAAN7hB,IACXmgC,EAAIC,OAASj3B,EACbg3B,EAAIE,KAAOF,EAAIE,KAAKzI,UAAU,EAAGuI,EAAIE,KAAKnhC,OAAS,GAAG+K,QAAQ,KAAM,KACpEk2B,EAAIG,UAAYH,EAAIG,UAAUr2B,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAAIA,QAAQ,KAAM,KAC9Ek2B,EAAII,SAAU,GAElBJ,EAAIK,UAIR,SAAmBxiC,EAAKyiC,GACpB,MAAMC,EAAO,WAAYC,EAAQF,EAAKx2B,QAAQy2B,EAAM,KAAKliB,MAAM,KACvC,KAApBiiB,EAAK9gC,MAAM,EAAG,IAA6B,IAAhB8gC,EAAKvhC,QAChCyhC,EAAMrhC,OAAO,EAAG,GAEE,KAAlBmhC,EAAK9gC,OAAO,IACZghC,EAAMrhC,OAAOqhC,EAAMzhC,OAAS,EAAG,GAEnC,OAAOyhC,CACX,CAboBH,CAAUL,EAAKA,EAAU,MACzCA,EAAIS,SAaR,SAAkBT,EAAKze,GACnB,MAAMvW,EAAO,CAAC,EAMd,OALAuW,EAAMzX,QAAQ,6BAA6B,SAAU42B,EAAIC,EAAIC,GACrDD,IACA31B,EAAK21B,GAAMC,EAEnB,IACO51B,CACX,CArBmBy1B,CAAST,EAAKA,EAAW,OACjCA,CACX,C,qKC5CO,MAAMa,EACqC,mBAAZ57B,SAAqD,mBAApBA,QAAQpC,QAE/D7D,GAAOiG,QAAQpC,UAAUE,KAAK/D,GAG/B,CAACA,EAAI8hC,IAAiBA,EAAa9hC,EAAI,GAGzC+hC,EACW,oBAATC,KACAA,KAEgB,oBAAXC,OACLA,OAGAC,SAAS,cAATA,GAGFC,EAAoB,cAC1B,SAASC,IAAoB,C,+pCClB7B,MAAMC,EAAW,EAAAC,OAAOD,Q,ulBCI/B,MAAME,EAAiD,mBAArBrjC,kBACC,mBAAxBY,oBACL0iC,EAA0B,GAC5BD,GAGArjC,iBAAiB,WAAW,KACxBsjC,EAAwBh/B,SAAS0b,GAAaA,KAAW,IAC1D,GAyBA,MAAMujB,UAA6B,EAAA7jC,QAOtC,WAAA8G,CAAYs7B,EAAK0B,GAiBb,GAhBA5D,QACAz/B,KAAKsjC,WAAa,EAAAR,kBAClB9iC,KAAKujC,YAAc,GACnBvjC,KAAKwjC,eAAiB,EACtBxjC,KAAKyjC,eAAiB,EACtBzjC,KAAK0jC,cAAgB,EACrB1jC,KAAK2jC,aAAe,EAKpB3jC,KAAK4jC,iBAAmBC,IACpBlC,GAAO,iBAAoBA,IAC3B0B,EAAO1B,EACPA,EAAM,MAENA,EAAK,CACL,MAAMmC,GAAY,IAAA9U,OAAM2S,GACxB0B,EAAKU,SAAWD,EAAUjC,KAC1BwB,EAAKW,OACsB,UAAvBF,EAAUd,UAA+C,QAAvBc,EAAUd,SAChDK,EAAKY,KAAOH,EAAUG,KAClBH,EAAU5gB,QACVmgB,EAAKngB,MAAQ4gB,EAAU5gB,MAC/B,MACSmgB,EAAKxB,OACVwB,EAAKU,UAAW,IAAA/U,OAAMqU,EAAKxB,MAAMA,OAErC,IAAAqC,uBAAsBlkC,KAAMqjC,GAC5BrjC,KAAKgkC,OACD,MAAQX,EAAKW,OACPX,EAAKW,OACe,oBAAbG,UAA4B,WAAaA,SAASnB,SAC/DK,EAAKU,WAAaV,EAAKY,OAEvBZ,EAAKY,KAAOjkC,KAAKgkC,OAAS,MAAQ,MAEtChkC,KAAK+jC,SACDV,EAAKU,WACoB,oBAAbI,SAA2BA,SAASJ,SAAW,aAC/D/jC,KAAKikC,KACDZ,EAAKY,OACoB,oBAAbE,UAA4BA,SAASF,KACvCE,SAASF,KACTjkC,KAAKgkC,OACD,MACA,MAClBhkC,KAAKokC,WAAa,GAClBpkC,KAAKqkC,kBAAoB,CAAC,EAC1BhB,EAAKe,WAAWjgC,SAAS1C,IACrB,MAAM6iC,EAAgB7iC,EAAE/B,UAAU4G,KAClCtG,KAAKokC,WAAWlkC,KAAKokC,GACrBtkC,KAAKqkC,kBAAkBC,GAAiB7iC,CAAC,IAE7CzB,KAAKqjC,KAAO1hC,OAAOu0B,OAAO,CACtB+L,KAAM,aACNsC,OAAO,EACPjqB,iBAAiB,EACjBkqB,SAAS,EACTC,eAAgB,IAChBC,iBAAiB,EACjBC,kBAAkB,EAClBC,oBAAoB,EACpBC,kBAAmB,CACftJ,UAAW,MAEfuJ,iBAAkB,CAAC,EACnBC,qBAAqB,GACtB1B,GACHrjC,KAAKqjC,KAAKpB,KACNjiC,KAAKqjC,KAAKpB,KAAKx2B,QAAQ,MAAO,KACzBzL,KAAKqjC,KAAKsB,iBAAmB,IAAM,IACb,iBAApB3kC,KAAKqjC,KAAKngB,QACjBljB,KAAKqjC,KAAKngB,OAAQ,IAAAge,QAAOlhC,KAAKqjC,KAAKngB,QAEnCggB,IACIljC,KAAKqjC,KAAK0B,sBAIV/kC,KAAKglC,2BAA6B,KAC1BhlC,KAAKilC,YAELjlC,KAAKilC,UAAUzkC,qBACfR,KAAKilC,UAAUrlB,QACnB,EAEJ/f,iBAAiB,eAAgBG,KAAKglC,4BAA4B,IAEhD,cAAlBhlC,KAAK+jC,WACL/jC,KAAKklC,sBAAwB,KACzBllC,KAAKmlC,SAAS,kBAAmB,CAC7BC,YAAa,2BACf,EAENjC,EAAwBjjC,KAAKF,KAAKklC,yBAGtCllC,KAAKqjC,KAAK/oB,kBACVta,KAAKqlC,YAAa,IAAAtC,oBAEtB/iC,KAAKslC,OACT,CAQA,eAAAC,CAAgBj/B,GACZ,MAAM4c,EAAQvhB,OAAOu0B,OAAO,CAAC,EAAGl2B,KAAKqjC,KAAKngB,OAE1CA,EAAMsiB,IAAM,EAAAxC,SAEZ9f,EAAM+hB,UAAY3+B,EAEdtG,KAAK0K,KACLwY,EAAMuiB,IAAMzlC,KAAK0K,IACrB,MAAM24B,EAAO1hC,OAAOu0B,OAAO,CAAC,EAAGl2B,KAAKqjC,KAAM,CACtCngB,QACA9I,OAAQpa,KACR+jC,SAAU/jC,KAAK+jC,SACfC,OAAQhkC,KAAKgkC,OACbC,KAAMjkC,KAAKikC,MACZjkC,KAAKqjC,KAAKyB,iBAAiBx+B,IAC9B,OAAO,IAAItG,KAAKqkC,kBAAkB/9B,GAAM+8B,EAC5C,CAMA,KAAAiC,GACI,GAA+B,IAA3BtlC,KAAKokC,WAAW1jC,OAKhB,YAHAV,KAAKyiC,cAAa,KACdziC,KAAKoB,aAAa,QAAS,0BAA0B,GACtD,GAGP,MAAMkjC,EAAgBtkC,KAAKqjC,KAAKqB,iBAC5BtB,EAAqBsC,wBACqB,IAA1C1lC,KAAKokC,WAAW7H,QAAQ,aACtB,YACAv8B,KAAKokC,WAAW,GACtBpkC,KAAK2lC,WAAa,UAClB,MAAMV,EAAYjlC,KAAKulC,gBAAgBjB,GACvCW,EAAU30B,OACVtQ,KAAK4lC,aAAaX,EACtB,CAMA,YAAAW,CAAaX,GACLjlC,KAAKilC,WACLjlC,KAAKilC,UAAUzkC,qBAGnBR,KAAKilC,UAAYA,EAEjBA,EACKrlC,GAAG,QAASI,KAAK6lC,SAAShd,KAAK7oB,OAC/BJ,GAAG,SAAUI,KAAK8lC,UAAUjd,KAAK7oB,OACjCJ,GAAG,QAASI,KAAK+lC,SAASld,KAAK7oB,OAC/BJ,GAAG,SAAUomC,GAAWhmC,KAAKmlC,SAAS,kBAAmBa,IAClE,CAMA,MAAAC,GACIjmC,KAAK2lC,WAAa,OAClBvC,EAAqBsC,sBACjB,cAAgB1lC,KAAKilC,UAAU3+B,KACnCtG,KAAKoB,aAAa,QAClBpB,KAAK+2B,OACT,CAMA,SAAA+O,CAAUI,GACN,GAAI,YAAclmC,KAAK2lC,YACnB,SAAW3lC,KAAK2lC,YAChB,YAAc3lC,KAAK2lC,WAInB,OAHA3lC,KAAKoB,aAAa,SAAU8kC,GAE5BlmC,KAAKoB,aAAa,aACV8kC,EAAOhjC,MACX,IAAK,OACDlD,KAAKmmC,YAAY55B,KAAKyiB,MAAMkX,EAAOv5B,OACnC,MACJ,IAAK,OACD3M,KAAKomC,YAAY,QACjBpmC,KAAKoB,aAAa,QAClBpB,KAAKoB,aAAa,QAClBpB,KAAKqmC,oBACL,MACJ,IAAK,QACD,MAAMl5B,EAAM,IAAIvI,MAAM,gBAEtBuI,EAAIm5B,KAAOJ,EAAOv5B,KAClB3M,KAAK+lC,SAAS54B,GACd,MACJ,IAAK,UACDnN,KAAKoB,aAAa,OAAQ8kC,EAAOv5B,MACjC3M,KAAKoB,aAAa,UAAW8kC,EAAOv5B,MAMpD,CAOA,WAAAw5B,CAAYx5B,GACR3M,KAAKoB,aAAa,YAAauL,GAC/B3M,KAAK0K,GAAKiC,EAAK84B,IACfzlC,KAAKilC,UAAU/hB,MAAMuiB,IAAM94B,EAAK84B,IAChCzlC,KAAKyjC,cAAgB92B,EAAK45B,aAC1BvmC,KAAK0jC,aAAe/2B,EAAK65B,YACzBxmC,KAAK2jC,YAAch3B,EAAK85B,WACxBzmC,KAAKimC,SAED,WAAajmC,KAAK2lC,YAEtB3lC,KAAKqmC,mBACT,CAMA,iBAAAA,GACIrmC,KAAK0mC,eAAe1mC,KAAK2mC,mBACzB,MAAMC,EAAQ5mC,KAAKyjC,cAAgBzjC,KAAK0jC,aACxC1jC,KAAK4jC,iBAAmB77B,KAAK8+B,MAAQD,EACrC5mC,KAAK2mC,kBAAoB3mC,KAAKyiC,cAAa,KACvCziC,KAAKmlC,SAAS,eAAe,GAC9ByB,GACC5mC,KAAKqjC,KAAKyD,WACV9mC,KAAK2mC,kBAAkBI,OAE/B,CAMA,QAAAlB,GACI7lC,KAAKujC,YAAYziC,OAAO,EAAGd,KAAKwjC,gBAIhCxjC,KAAKwjC,eAAiB,EAClB,IAAMxjC,KAAKujC,YAAY7iC,OACvBV,KAAKoB,aAAa,SAGlBpB,KAAK+2B,OAEb,CAMA,KAAAA,GACI,GAAI,WAAa/2B,KAAK2lC,YAClB3lC,KAAKilC,UAAUtiC,WACd3C,KAAKgnC,WACNhnC,KAAKujC,YAAY7iC,OAAQ,CACzB,MAAMumC,EAAUjnC,KAAKknC,sBACrBlnC,KAAKilC,UAAUkC,KAAKF,GAGpBjnC,KAAKwjC,eAAiByD,EAAQvmC,OAC9BV,KAAKoB,aAAa,QACtB,CACJ,CAOA,mBAAA8lC,GAII,KAH+BlnC,KAAK2jC,aACR,YAAxB3jC,KAAKilC,UAAU3+B,MACftG,KAAKujC,YAAY7iC,OAAS,GAE1B,OAAOV,KAAKujC,YAEhB,IAAI6D,EAAc,EAClB,IAAK,IAAIvmC,EAAI,EAAGA,EAAIb,KAAKujC,YAAY7iC,OAAQG,IAAK,CAC9C,MAAM8L,EAAO3M,KAAKujC,YAAY1iC,GAAG8L,KAIjC,GAHIA,IACAy6B,IAAe,IAAA1f,YAAW/a,IAE1B9L,EAAI,GAAKumC,EAAcpnC,KAAK2jC,YAC5B,OAAO3jC,KAAKujC,YAAYpiC,MAAM,EAAGN,GAErCumC,GAAe,CACnB,CACA,OAAOpnC,KAAKujC,WAChB,CAUc,eAAA8D,GACV,IAAKrnC,KAAK4jC,iBACN,OAAO,EACX,MAAM0D,EAAav/B,KAAK8+B,MAAQ7mC,KAAK4jC,iBAOrC,OANI0D,IACAtnC,KAAK4jC,iBAAmB,GACxB,IAAApB,WAAS,KACLxiC,KAAKmlC,SAAS,eAAe,GAC9BnlC,KAAKyiC,eAEL6E,CACX,CASA,KAAAC,CAAM95B,EAAK+5B,EAASznC,GAEhB,OADAC,KAAKomC,YAAY,UAAW34B,EAAK+5B,EAASznC,GACnCC,IACX,CASA,IAAAmnC,CAAK15B,EAAK+5B,EAASznC,GAEf,OADAC,KAAKomC,YAAY,UAAW34B,EAAK+5B,EAASznC,GACnCC,IACX,CAUA,WAAAomC,CAAYljC,EAAMyJ,EAAM66B,EAASznC,GAS7B,GARI,mBAAsB4M,IACtB5M,EAAK4M,EACLA,OAAO1B,GAEP,mBAAsBu8B,IACtBznC,EAAKynC,EACLA,EAAU,MAEV,YAAcxnC,KAAK2lC,YAAc,WAAa3lC,KAAK2lC,WACnD,QAEJ6B,EAAUA,GAAW,CAAC,GACdC,UAAW,IAAUD,EAAQC,SACrC,MAAMvB,EAAS,CACXhjC,KAAMA,EACNyJ,KAAMA,EACN66B,QAASA,GAEbxnC,KAAKoB,aAAa,eAAgB8kC,GAClClmC,KAAKujC,YAAYrjC,KAAKgmC,GAClBnmC,GACAC,KAAKG,KAAK,QAASJ,GACvBC,KAAK+2B,OACT,CAIA,KAAAnX,GACI,MAAMA,EAAQ,KACV5f,KAAKmlC,SAAS,gBACdnlC,KAAKilC,UAAUrlB,OAAO,EAEpB8nB,EAAkB,KACpB1nC,KAAKI,IAAI,UAAWsnC,GACpB1nC,KAAKI,IAAI,eAAgBsnC,GACzB9nB,GAAO,EAEL+nB,EAAiB,KAEnB3nC,KAAKG,KAAK,UAAWunC,GACrB1nC,KAAKG,KAAK,eAAgBunC,EAAgB,EAqB9C,MAnBI,YAAc1nC,KAAK2lC,YAAc,SAAW3lC,KAAK2lC,aACjD3lC,KAAK2lC,WAAa,UACd3lC,KAAKujC,YAAY7iC,OACjBV,KAAKG,KAAK,SAAS,KACXH,KAAKgnC,UACLW,IAGA/nB,GACJ,IAGC5f,KAAKgnC,UACVW,IAGA/nB,KAGD5f,IACX,CAMA,QAAA+lC,CAAS54B,GAEL,GADAi2B,EAAqBsC,uBAAwB,EACzC1lC,KAAKqjC,KAAKuE,kBACV5nC,KAAKokC,WAAW1jC,OAAS,GACL,YAApBV,KAAK2lC,WAEL,OADA3lC,KAAKokC,WAAW5e,QACTxlB,KAAKslC,QAEhBtlC,KAAKoB,aAAa,QAAS+L,GAC3BnN,KAAKmlC,SAAS,kBAAmBh4B,EACrC,CAMA,QAAAg4B,CAASa,EAAQZ,GACb,GAAI,YAAcplC,KAAK2lC,YACnB,SAAW3lC,KAAK2lC,YAChB,YAAc3lC,KAAK2lC,WAAY,CAS/B,GAPA3lC,KAAK0mC,eAAe1mC,KAAK2mC,mBAEzB3mC,KAAKilC,UAAUzkC,mBAAmB,SAElCR,KAAKilC,UAAUrlB,QAEf5f,KAAKilC,UAAUzkC,qBACX0iC,IACIljC,KAAKglC,4BACLvkC,oBAAoB,eAAgBT,KAAKglC,4BAA4B,GAErEhlC,KAAKklC,uBAAuB,CAC5B,MAAMrkC,EAAIsiC,EAAwB5G,QAAQv8B,KAAKklC,wBACpC,IAAPrkC,GACAsiC,EAAwBriC,OAAOD,EAAG,EAE1C,CAGJb,KAAK2lC,WAAa,SAElB3lC,KAAK0K,GAAK,KAEV1K,KAAKoB,aAAa,QAAS4kC,EAAQZ,GAGnCplC,KAAKujC,YAAc,GACnBvjC,KAAKwjC,eAAiB,CAC1B,CACJ,EAEJJ,EAAqBJ,SAAW,EAAAA,SAwBzB,MAAM6E,UAA0BzE,EACnC,WAAA/8B,GACIo5B,SAASn/B,WACTN,KAAK8nC,UAAY,EACrB,CACA,MAAA7B,GAEI,GADAxG,MAAMwG,SACF,SAAWjmC,KAAK2lC,YAAc3lC,KAAKqjC,KAAKmB,QACxC,IAAK,IAAI3jC,EAAI,EAAGA,EAAIb,KAAK8nC,UAAUpnC,OAAQG,IACvCb,KAAK+nC,OAAO/nC,KAAK8nC,UAAUjnC,GAGvC,CAOA,MAAAknC,CAAOzhC,GACH,IAAI2+B,EAAYjlC,KAAKulC,gBAAgBj/B,GACjC0hC,GAAS,EACb5E,EAAqBsC,uBAAwB,EAC7C,MAAMuC,EAAkB,KAChBD,IAEJ/C,EAAUkC,KAAK,CAAC,CAAEjkC,KAAM,OAAQyJ,KAAM,WACtCs4B,EAAU9kC,KAAK,UAAWsN,IACtB,IAAIu6B,EAEJ,GAAI,SAAWv6B,EAAIvK,MAAQ,UAAYuK,EAAId,KAAM,CAG7C,GAFA3M,KAAKgnC,WAAY,EACjBhnC,KAAKoB,aAAa,YAAa6jC,IAC1BA,EACD,OACJ7B,EAAqBsC,sBACjB,cAAgBT,EAAU3+B,KAC9BtG,KAAKilC,UAAUiD,OAAM,KACbF,GAEA,WAAahoC,KAAK2lC,aAEtBwC,IACAnoC,KAAK4lC,aAAaX,GAClBA,EAAUkC,KAAK,CAAC,CAAEjkC,KAAM,aACxBlD,KAAKoB,aAAa,UAAW6jC,GAC7BA,EAAY,KACZjlC,KAAKgnC,WAAY,EACjBhnC,KAAK+2B,QAAO,GAEpB,KACK,CACD,MAAM5pB,EAAM,IAAIvI,MAAM,eAEtBuI,EAAI83B,UAAYA,EAAU3+B,KAC1BtG,KAAKoB,aAAa,eAAgB+L,EACtC,KACF,EAEN,SAASi7B,IACDJ,IAGJA,GAAS,EACTG,IACAlD,EAAUrlB,QACVqlB,EAAY,KAChB,CAEA,MAAMjnB,EAAW7Q,IACb,MAAMuD,EAAQ,IAAI9L,MAAM,gBAAkBuI,GAE1CuD,EAAMu0B,UAAYA,EAAU3+B,KAC5B8hC,IACApoC,KAAKoB,aAAa,eAAgBsP,EAAM,EAE5C,SAAS23B,IACLrqB,EAAQ,mBACZ,CAEA,SAASkB,IACLlB,EAAQ,gBACZ,CAEA,SAASsqB,EAAUC,GACXtD,GAAasD,EAAGjiC,OAAS2+B,EAAU3+B,MACnC8hC,GAER,CAEA,MAAMD,EAAU,KACZlD,EAAU1kC,eAAe,OAAQ0nC,GACjChD,EAAU1kC,eAAe,QAASyd,GAClCinB,EAAU1kC,eAAe,QAAS8nC,GAClCroC,KAAKI,IAAI,QAAS8e,GAClBlf,KAAKI,IAAI,YAAakoC,EAAU,EAEpCrD,EAAU9kC,KAAK,OAAQ8nC,GACvBhD,EAAU9kC,KAAK,QAAS6d,GACxBinB,EAAU9kC,KAAK,QAASkoC,GACxBroC,KAAKG,KAAK,QAAS+e,GACnBlf,KAAKG,KAAK,YAAamoC,IACyB,IAA5CtoC,KAAK8nC,UAAUvL,QAAQ,iBACd,iBAATj2B,EAEAtG,KAAKyiC,cAAa,KACTuF,GACD/C,EAAU30B,MACd,GACD,KAGH20B,EAAU30B,MAElB,CACA,WAAA61B,CAAYx5B,GACR3M,KAAK8nC,UAAY9nC,KAAKwoC,gBAAgB77B,EAAK87B,UAC3ChJ,MAAM0G,YAAYx5B,EACtB,CAOA,eAAA67B,CAAgBC,GACZ,MAAMC,EAAmB,GACzB,IAAK,IAAI7nC,EAAI,EAAGA,EAAI4nC,EAAS/nC,OAAQG,KAC5Bb,KAAKokC,WAAW7H,QAAQkM,EAAS5nC,KAClC6nC,EAAiBxoC,KAAKuoC,EAAS5nC,IAEvC,OAAO6nC,CACX,EAqBG,MAAMzF,UAAe4E,EACxB,WAAAxhC,CAAYs7B,EAAK0B,EAAO,CAAC,GACrB,MAAMvhC,EAAmB,iBAAR6/B,EAAmBA,EAAM0B,IACrCvhC,EAAEsiC,YACFtiC,EAAEsiC,YAAyC,iBAApBtiC,EAAEsiC,WAAW,MACrCtiC,EAAEsiC,YAActiC,EAAEsiC,YAAc,CAAC,UAAW,YAAa,iBACpD5tB,KAAK8tB,GAAkB,aAAmBA,KAC1C92B,QAAQ/L,KAAQA,KAEzBg+B,MAAMkC,EAAK7/B,EACf,E,yXCjtBG,MAAM6mC,UAAuB/jC,MAChC,WAAAyB,CAAY2/B,EAAQZ,EAAawD,GAC7BnJ,MAAMuG,GACNhmC,KAAKolC,YAAcA,EACnBplC,KAAK4oC,QAAUA,EACf5oC,KAAKkD,KAAO,gBAChB,EAEG,MAAM2lC,UAAkB,EAAAtpC,QAO3B,WAAA8G,CAAYg9B,GACR5D,QACAz/B,KAAK2C,UAAW,GAChB,IAAAuhC,uBAAsBlkC,KAAMqjC,GAC5BrjC,KAAKqjC,KAAOA,EACZrjC,KAAKkjB,MAAQmgB,EAAKngB,MAClBljB,KAAKoa,OAASipB,EAAKjpB,OACnBpa,KAAK8oC,gBAAkBzF,EAAK0F,WAChC,CAUA,OAAAC,CAAQhD,EAAQZ,EAAawD,GAEzB,OADAnJ,MAAMr+B,aAAa,QAAS,IAAIunC,EAAe3C,EAAQZ,EAAawD,IAC7D5oC,IACX,CAIA,IAAAsQ,GAGI,OAFAtQ,KAAK2lC,WAAa,UAClB3lC,KAAKipC,SACEjpC,IACX,CAIA,KAAA4f,GAKI,MAJwB,YAApB5f,KAAK2lC,YAAgD,SAApB3lC,KAAK2lC,aACtC3lC,KAAKkpC,UACLlpC,KAAKmpC,WAEFnpC,IACX,CAMA,IAAAmnC,CAAKF,GACuB,SAApBjnC,KAAK2lC,YACL3lC,KAAKunC,MAAMN,EAKnB,CAMA,MAAAhB,GACIjmC,KAAK2lC,WAAa,OAClB3lC,KAAK2C,UAAW,EAChB88B,MAAMr+B,aAAa,OACvB,CAOA,MAAAgoC,CAAOz8B,GACH,MAAMu5B,GAAS,IAAAmD,cAAa18B,EAAM3M,KAAKoa,OAAOkpB,YAC9CtjC,KAAKspC,SAASpD,EAClB,CAMA,QAAAoD,CAASpD,GACLzG,MAAMr+B,aAAa,SAAU8kC,EACjC,CAMA,OAAAiD,CAAQI,GACJvpC,KAAK2lC,WAAa,SAClBlG,MAAMr+B,aAAa,QAASmoC,EAChC,CAMA,KAAArB,CAAMsB,GAAW,CACjB,SAAAC,CAAUC,EAAQxmB,EAAQ,CAAC,GACvB,OAAQwmB,EACJ,MACA1pC,KAAK2pC,YACL3pC,KAAK4pC,QACL5pC,KAAKqjC,KAAKpB,KACVjiC,KAAK6pC,OAAO3mB,EACpB,CACA,SAAAymB,GACI,MAAM5F,EAAW/jC,KAAKqjC,KAAKU,SAC3B,OAAkC,IAA3BA,EAASxH,QAAQ,KAAcwH,EAAW,IAAMA,EAAW,GACtE,CACA,KAAA6F,GACI,OAAI5pC,KAAKqjC,KAAKY,OACRjkC,KAAKqjC,KAAKW,QAAU8F,OAA0B,MAAnB9pC,KAAKqjC,KAAKY,QACjCjkC,KAAKqjC,KAAKW,QAAqC,KAA3B8F,OAAO9pC,KAAKqjC,KAAKY,OACpC,IAAMjkC,KAAKqjC,KAAKY,KAGhB,EAEf,CACA,MAAA4F,CAAO3mB,GACH,MAAM6mB,GAAe,IAAA9I,QAAO/d,GAC5B,OAAO6mB,EAAarpC,OAAS,IAAMqpC,EAAe,EACtD,E,iVCzIG,MAAM3F,EAAa,CACtB4F,UAAW,EAAAC,GACXC,aAAc,EAAAC,GACdC,QAAS,EAAAC,I,2LCIN,MAAMC,UAAc,EAAAC,QACvB,MAAAC,GACIxqC,KAAKyqC,SACA/lC,MAAM+H,IACP,IAAKA,EAAIi+B,GACL,OAAO1qC,KAAKgpC,QAAQ,mBAAoBv8B,EAAIyN,OAAQzN,GAExDA,EAAI5D,OAAOnE,MAAMiI,GAAS3M,KAAKopC,OAAOz8B,IAAM,IAE3CuzB,OAAO/yB,IACRnN,KAAKgpC,QAAQ,mBAAoB77B,EAAI,GAE7C,CACA,OAAAw9B,CAAQh+B,EAAM6N,GACVxa,KAAKyqC,OAAO99B,GACPjI,MAAM+H,IACP,IAAKA,EAAIi+B,GACL,OAAO1qC,KAAKgpC,QAAQ,oBAAqBv8B,EAAIyN,OAAQzN,GAEzD+N,GAAU,IAET0lB,OAAO/yB,IACRnN,KAAKgpC,QAAQ,oBAAqB77B,EAAI,GAE9C,CACA,MAAAs9B,CAAO99B,GACH,IAAIi+B,EACJ,MAAMC,OAAkB5/B,IAAT0B,EACTN,EAAU,IAAIy+B,QAAQ9qC,KAAKqjC,KAAK0H,cAKtC,OAJIF,GACAx+B,EAAQ+Q,IAAI,eAAgB,4BAEE,QAAjCwtB,EAAK5qC,KAAKoa,OAAOirB,kBAA+B,IAAPuF,GAAyBA,EAAGI,cAAc3+B,GAC7ED,MAAMpM,KAAK2hC,MAAO,CACrB78B,OAAQ+lC,EAAS,OAAS,MAC1Bv+B,KAAMu+B,EAASl+B,EAAO,KACtBN,UACA4+B,YAAajrC,KAAKqjC,KAAK/oB,gBAAkB,UAAY,SACtD5V,MAAM+H,IACL,IAAIm+B,EAGJ,OADkC,QAAjCA,EAAK5qC,KAAKoa,OAAOirB,kBAA+B,IAAPuF,GAAyBA,EAAGM,aAAaz+B,EAAIJ,QAAQ8+B,gBACxF1+B,CAAG,GAElB,E,idCjDJ,SAASwc,IAAU,CACZ,MAAMmiB,UAAgB,EAAAb,QAOzB,WAAAlkC,CAAYg9B,GAER,GADA5D,MAAM4D,GACkB,oBAAbc,SAA0B,CACjC,MAAMkH,EAAQ,WAAalH,SAASnB,SACpC,IAAIiB,EAAOE,SAASF,KAEfA,IACDA,EAAOoH,EAAQ,MAAQ,MAE3BrrC,KAAKsrC,GACoB,oBAAbnH,UACJd,EAAKU,WAAaI,SAASJ,UAC3BE,IAASZ,EAAKY,IAC1B,CACJ,CAQA,OAAA0G,CAAQh+B,EAAM5M,GACV,MAAMge,EAAM/d,KAAKurC,QAAQ,CACrBzmC,OAAQ,OACR6H,KAAMA,IAEVoR,EAAIne,GAAG,UAAWG,GAClBge,EAAIne,GAAG,SAAS,CAAC4rC,EAAW5C,KACxB5oC,KAAKgpC,QAAQ,iBAAkBwC,EAAW5C,EAAQ,GAE1D,CAMA,MAAA4B,GACI,MAAMzsB,EAAM/d,KAAKurC,UACjBxtB,EAAIne,GAAG,OAAQI,KAAKopC,OAAOvgB,KAAK7oB,OAChC+d,EAAIne,GAAG,SAAS,CAAC4rC,EAAW5C,KACxB5oC,KAAKgpC,QAAQ,iBAAkBwC,EAAW5C,EAAQ,IAEtD5oC,KAAKyrC,QAAU1tB,CACnB,EAEG,MAAM2tB,UAAgB,EAAAnsC,QAOzB,WAAA8G,CAAYslC,EAAehK,EAAK0B,GAC5B5D,QACAz/B,KAAK2rC,cAAgBA,GACrB,IAAAzH,uBAAsBlkC,KAAMqjC,GAC5BrjC,KAAK4rC,MAAQvI,EACbrjC,KAAK6rC,QAAUxI,EAAKv+B,QAAU,MAC9B9E,KAAK8rC,KAAOnK,EACZ3hC,KAAK+rC,WAAQ9gC,IAAco4B,EAAK12B,KAAO02B,EAAK12B,KAAO,KACnD3M,KAAKgsC,SACT,CAMA,OAAAA,GACI,IAAIpB,EACJ,MAAMvH,GAAO,IAAA4I,MAAKjsC,KAAK4rC,MAAO,QAAS,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,aAClHvI,EAAK6I,UAAYlsC,KAAK4rC,MAAMN,GAC5B,MAAMa,EAAOnsC,KAAKosC,KAAOpsC,KAAK2rC,cAActI,GAC5C,IACI8I,EAAI77B,KAAKtQ,KAAK6rC,QAAS7rC,KAAK8rC,MAAM,GAClC,IACI,GAAI9rC,KAAK4rC,MAAMb,aAAc,CAEzBoB,EAAIE,uBAAyBF,EAAIE,uBAAsB,GACvD,IAAK,IAAIxrC,KAAKb,KAAK4rC,MAAMb,aACjB/qC,KAAK4rC,MAAMb,aAAalpC,eAAehB,IACvCsrC,EAAIG,iBAAiBzrC,EAAGb,KAAK4rC,MAAMb,aAAalqC,GAG5D,CACJ,CACA,MAAOW,GAAK,CACZ,GAAI,SAAWxB,KAAK6rC,QAChB,IACIM,EAAIG,iBAAiB,eAAgB,2BACzC,CACA,MAAO9qC,GAAK,CAEhB,IACI2qC,EAAIG,iBAAiB,SAAU,MACnC,CACA,MAAO9qC,GAAK,CACoB,QAA/BopC,EAAK5qC,KAAK4rC,MAAMW,iBAA8B,IAAP3B,GAAyBA,EAAG4B,WAAWL,GAE3E,oBAAqBA,IACrBA,EAAI7xB,gBAAkBta,KAAK4rC,MAAMtxB,iBAEjCta,KAAK4rC,MAAMa,iBACXN,EAAIO,QAAU1sC,KAAK4rC,MAAMa,gBAE7BN,EAAIQ,mBAAqB,KACrB,IAAI/B,EACmB,IAAnBuB,EAAIxG,aAC4B,QAA/BiF,EAAK5qC,KAAK4rC,MAAMW,iBAA8B,IAAP3B,GAAyBA,EAAGM,aAEpEiB,EAAIS,kBAAkB,gBAEtB,IAAMT,EAAIxG,aAEV,MAAQwG,EAAIjyB,QAAU,OAASiyB,EAAIjyB,OACnCla,KAAK6sC,UAKL7sC,KAAKyiC,cAAa,KACdziC,KAAK+lC,SAA+B,iBAAfoG,EAAIjyB,OAAsBiyB,EAAIjyB,OAAS,EAAE,GAC/D,GACP,EAEJiyB,EAAIhF,KAAKnnC,KAAK+rC,MAClB,CACA,MAAOvqC,GAOH,YAHAxB,KAAKyiC,cAAa,KACdziC,KAAK+lC,SAASvkC,EAAE,GACjB,EAEP,CACwB,oBAAbsH,WACP9I,KAAK8sC,OAASpB,EAAQqB,gBACtBrB,EAAQsB,SAAShtC,KAAK8sC,QAAU9sC,KAExC,CAMA,QAAA+lC,CAAS54B,GACLnN,KAAKoB,aAAa,QAAS+L,EAAKnN,KAAKosC,MACrCpsC,KAAKitC,UAAS,EAClB,CAMA,QAAAA,CAASC,GACL,QAAI,IAAuBltC,KAAKosC,MAAQ,OAASpsC,KAAKosC,KAAtD,CAIA,GADApsC,KAAKosC,KAAKO,mBAAqB1jB,EAC3BikB,EACA,IACIltC,KAAKosC,KAAKrN,OACd,CACA,MAAOv9B,GAAK,CAEQ,oBAAbsH,iBACA4iC,EAAQsB,SAAShtC,KAAK8sC,QAEjC9sC,KAAKosC,KAAO,IAXZ,CAYJ,CAMA,OAAAS,GACI,MAAMlgC,EAAO3M,KAAKosC,KAAKe,aACV,OAATxgC,IACA3M,KAAKoB,aAAa,OAAQuL,GAC1B3M,KAAKoB,aAAa,WAClBpB,KAAKitC,WAEb,CAMA,KAAAlO,GACI/+B,KAAKitC,UACT,EASJ,GAPAvB,EAAQqB,cAAgB,EACxBrB,EAAQsB,SAAW,CAAC,EAMI,oBAAblkC,SAEP,GAA2B,mBAAhBskC,YAEPA,YAAY,WAAYC,QAEvB,GAAgC,mBAArBxtC,iBAAiC,CAC7C,MAAMytC,EAAmB,eAAgB,EAAhB,eAA6B,WAAa,SACnEztC,iBAAiBytC,EAAkBD,GAAe,EACtD,CAEJ,SAASA,IACL,IAAK,IAAIxsC,KAAK6qC,EAAQsB,SACdtB,EAAQsB,SAASnrC,eAAehB,IAChC6qC,EAAQsB,SAASnsC,GAAGk+B,OAGhC,CACA,MAAMwO,EAAU,WACZ,MAAMpB,EAAMqB,EAAW,CACnBtB,SAAS,IAEb,OAAOC,GAA4B,OAArBA,EAAIsB,YACrB,CALe,GAaT,MAAMpD,UAAYe,EACrB,WAAA/kC,CAAYg9B,GACR5D,MAAM4D,GACN,MAAM0F,EAAc1F,GAAQA,EAAK0F,YACjC/oC,KAAK8oC,eAAiByE,IAAYxE,CACtC,CACA,OAAAwC,CAAQlI,EAAO,CAAC,GAEZ,OADA1hC,OAAOu0B,OAAOmN,EAAM,CAAEiI,GAAItrC,KAAKsrC,IAAMtrC,KAAKqjC,MACnC,IAAIqI,EAAQ8B,EAAYxtC,KAAK2hC,MAAO0B,EAC/C,EAEJ,SAASmK,EAAWnK,GAChB,MAAM6I,EAAU7I,EAAK6I,QAErB,IACI,GAAI,oBAAuBnL,kBAAoBmL,GAAW,EAAAlL,SACtD,OAAO,IAAID,cAEnB,CACA,MAAOv/B,GAAK,CACZ,IAAK0qC,EACD,IACI,OAAO,IAAI,iBAAW,CAAC,UAAUvjC,OAAO,UAAUwjB,KAAK,OAAM,oBACjE,CACA,MAAO3qB,GAAK,CAEpB,C,iSC3QO,MAAM+oC,UAAgB,EAAA1B,UACzB,WAAAxiC,GACIo5B,SAASn/B,WACTN,KAAK0tC,UAAW,CACpB,CACA,QAAIpnC,GACA,MAAO,SACX,CAOA,MAAA2iC,GACIjpC,KAAK2tC,OACT,CAOA,KAAAzF,CAAMsB,GACFxpC,KAAK2lC,WAAa,UAClB,MAAMuC,EAAQ,KACVloC,KAAK2lC,WAAa,SAClB6D,GAAS,EAEb,GAAIxpC,KAAK0tC,WAAa1tC,KAAK2C,SAAU,CACjC,IAAIirC,EAAQ,EACR5tC,KAAK0tC,WACLE,IACA5tC,KAAKG,KAAK,gBAAgB,aACpBytC,GAAS1F,GACf,KAECloC,KAAK2C,WACNirC,IACA5tC,KAAKG,KAAK,SAAS,aACbytC,GAAS1F,GACf,IAER,MAEIA,GAER,CAMA,KAAAyF,GACI3tC,KAAK0tC,UAAW,EAChB1tC,KAAKwqC,SACLxqC,KAAKoB,aAAa,OACtB,CAMA,MAAAgoC,CAAOz8B,IAeH,IAAAkhC,eAAclhC,EAAM3M,KAAKoa,OAAOkpB,YAAYn/B,SAd1B+hC,IAMd,GAJI,YAAclmC,KAAK2lC,YAA8B,SAAhBO,EAAOhjC,MACxClD,KAAKimC,SAGL,UAAYC,EAAOhjC,KAEnB,OADAlD,KAAKmpC,QAAQ,CAAE/D,YAAa,oCACrB,EAGXplC,KAAKspC,SAASpD,EAAO,IAKrB,WAAalmC,KAAK2lC,aAElB3lC,KAAK0tC,UAAW,EAChB1tC,KAAKoB,aAAa,gBACd,SAAWpB,KAAK2lC,YAChB3lC,KAAK2tC,QAKjB,CAMA,OAAAzE,GACI,MAAMtpB,EAAQ,KACV5f,KAAKunC,MAAM,CAAC,CAAErkC,KAAM,UAAW,EAE/B,SAAWlD,KAAK2lC,WAChB/lB,IAKA5f,KAAKG,KAAK,OAAQyf,EAE1B,CAOA,KAAA2nB,CAAMN,GACFjnC,KAAK2C,UAAW,GAChB,IAAAmrC,eAAc7G,GAAUt6B,IACpB3M,KAAK2qC,QAAQh+B,GAAM,KACf3M,KAAK2C,UAAW,EAChB3C,KAAKoB,aAAa,QAAQ,GAC5B,GAEV,CAMA,GAAAugC,GACI,MAAM+H,EAAS1pC,KAAKqjC,KAAKW,OAAS,QAAU,OACtC9gB,EAAQljB,KAAKkjB,OAAS,CAAC,EAQ7B,OANI,IAAUljB,KAAKqjC,KAAK0K,oBACpB7qB,EAAMljB,KAAKqjC,KAAKoB,iBAAkB,IAAAuJ,iBAEjChuC,KAAK8oC,gBAAmB5lB,EAAMuiB,MAC/BviB,EAAM+qB,IAAM,GAETjuC,KAAKypC,UAAUC,EAAQxmB,EAClC,E,uWC1IJ,MAAMgrB,EAAqC,oBAAdx4B,WACI,iBAAtBA,UAAUy4B,SACmB,gBAApCz4B,UAAUy4B,QAAQ73B,cACf,MAAM83B,UAAe,EAAAvF,UACxB,QAAIviC,GACA,MAAO,WACX,CACA,MAAA2iC,GACI,MAAMtH,EAAM3hC,KAAK2hC,MACX0M,EAAYruC,KAAKqjC,KAAKgL,UAEtBhL,EAAO6K,EACP,CAAC,GACD,IAAAjC,MAAKjsC,KAAKqjC,KAAM,QAAS,oBAAqB,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,eAAgB,kBAAmB,SAAU,aAAc,SAAU,uBAChMrjC,KAAKqjC,KAAK0H,eACV1H,EAAKh3B,QAAUrM,KAAKqjC,KAAK0H,cAE7B,IACI/qC,KAAKsuC,GAAKtuC,KAAKuuC,aAAa5M,EAAK0M,EAAWhL,EAChD,CACA,MAAOl2B,GACH,OAAOnN,KAAKoB,aAAa,QAAS+L,EACtC,CACAnN,KAAKsuC,GAAGhL,WAAatjC,KAAKoa,OAAOkpB,WACjCtjC,KAAKwuC,mBACT,CAMA,iBAAAA,GACIxuC,KAAKsuC,GAAGG,OAAS,KACTzuC,KAAKqjC,KAAKyD,WACV9mC,KAAKsuC,GAAGI,QAAQ3H,QAEpB/mC,KAAKimC,QAAQ,EAEjBjmC,KAAKsuC,GAAGpvB,QAAWyvB,GAAe3uC,KAAKmpC,QAAQ,CAC3C/D,YAAa,8BACbwD,QAAS+F,IAEb3uC,KAAKsuC,GAAGM,UAAaC,GAAO7uC,KAAKopC,OAAOyF,EAAGliC,MAC3C3M,KAAKsuC,GAAGtwB,QAAWxc,GAAMxB,KAAKgpC,QAAQ,kBAAmBxnC,EAC7D,CACA,KAAA+lC,CAAMN,GACFjnC,KAAK2C,UAAW,EAGhB,IAAK,IAAI9B,EAAI,EAAGA,EAAIomC,EAAQvmC,OAAQG,IAAK,CACrC,MAAMqlC,EAASe,EAAQpmC,GACjBiuC,EAAajuC,IAAMomC,EAAQvmC,OAAS,GAC1C,IAAAquC,cAAa7I,EAAQlmC,KAAK8oC,gBAAiBn8B,IAIvC,IACI3M,KAAK2qC,QAAQzE,EAAQv5B,EACzB,CACA,MAAOnL,GACP,CACIstC,IAGA,IAAAtM,WAAS,KACLxiC,KAAK2C,UAAW,EAChB3C,KAAKoB,aAAa,QAAQ,GAC3BpB,KAAKyiC,aACZ,GAER,CACJ,CACA,OAAAyG,QAC2B,IAAZlpC,KAAKsuC,KACZtuC,KAAKsuC,GAAG1uB,QACR5f,KAAKsuC,GAAK,KAElB,CAMA,GAAA3M,GACI,MAAM+H,EAAS1pC,KAAKqjC,KAAKW,OAAS,MAAQ,KACpC9gB,EAAQljB,KAAKkjB,OAAS,CAAC,EAS7B,OAPIljB,KAAKqjC,KAAK0K,oBACV7qB,EAAMljB,KAAKqjC,KAAKoB,iBAAkB,IAAAuJ,iBAGjChuC,KAAK8oC,iBACN5lB,EAAM+qB,IAAM,GAETjuC,KAAKypC,UAAUC,EAAQxmB,EAClC,EAEJ,MAAM8rB,EAAgB,iBAAWC,WAAa,iBAAWC,aAUlD,MAAMjF,UAAWmE,EACpB,YAAAG,CAAa5M,EAAK0M,EAAWhL,GACzB,OAAQ6K,EAIF,IAAIc,EAAcrN,EAAK0M,EAAWhL,GAHlCgL,EACI,IAAIW,EAAcrN,EAAK0M,GACvB,IAAIW,EAAcrN,EAEhC,CACA,OAAAgJ,CAAQwE,EAASxiC,GACb3M,KAAKsuC,GAAGnH,KAAKx6B,EACjB,E,oSC/GG,MAAMw9B,UAAW,EAAAtB,UACpB,QAAIviC,GACA,MAAO,cACX,CACA,MAAA2iC,GACI,IAEIjpC,KAAKovC,WAAa,IAAIC,aAAarvC,KAAKypC,UAAU,SAAUzpC,KAAKqjC,KAAKyB,iBAAiB9kC,KAAKsG,MAChG,CACA,MAAO6G,GACH,OAAOnN,KAAKoB,aAAa,QAAS+L,EACtC,CACAnN,KAAKovC,WAAWE,OACX5qC,MAAK,KACN1E,KAAKmpC,SAAS,IAEbjJ,OAAO/yB,IACRnN,KAAKgpC,QAAQ,qBAAsB77B,EAAI,IAG3CnN,KAAKovC,WAAWhmB,MAAM1kB,MAAK,KACvB1E,KAAKovC,WAAWG,4BAA4B7qC,MAAM8qC,IAC9C,MAAMC,GAAgB,IAAAC,2BAA0B5F,OAAO6F,iBAAkB3vC,KAAKoa,OAAOkpB,YAC/EsM,EAASJ,EAAOK,SAASC,YAAYL,GAAeM,YACpDC,GAAgB,IAAAC,6BACtBD,EAAcH,SAASK,OAAOV,EAAO7sC,UACrC3C,KAAKmwC,QAAUH,EAAcrtC,SAASytC,YACtC,MAAMC,EAAO,KACTT,EACKS,OACA3rC,MAAK,EAAGG,OAAM7C,YACX6C,IAGJ7E,KAAKspC,SAAStnC,GACdquC,IAAM,IAELnQ,OAAO/yB,IAAD,GACT,EAENkjC,IACA,MAAMnK,EAAS,CAAEhjC,KAAM,QACnBlD,KAAKkjB,MAAMuiB,MACXS,EAAOv5B,KAAO,WAAW3M,KAAKkjB,MAAMuiB,SAExCzlC,KAAKmwC,QAAQ5I,MAAMrB,GAAQxhC,MAAK,IAAM1E,KAAKimC,UAAS,GACtD,GAEV,CACA,KAAAsB,CAAMN,GACFjnC,KAAK2C,UAAW,EAChB,IAAK,IAAI9B,EAAI,EAAGA,EAAIomC,EAAQvmC,OAAQG,IAAK,CACrC,MAAMqlC,EAASe,EAAQpmC,GACjBiuC,EAAajuC,IAAMomC,EAAQvmC,OAAS,EAC1CV,KAAKmwC,QAAQ5I,MAAMrB,GAAQxhC,MAAK,KACxBoqC,IACA,IAAAtM,WAAS,KACLxiC,KAAK2C,UAAW,EAChB3C,KAAKoB,aAAa,QAAQ,GAC3BpB,KAAKyiC,aACZ,GAER,CACJ,CACA,OAAAyG,GACI,IAAI0B,EACuB,QAA1BA,EAAK5qC,KAAKovC,kBAA+B,IAAPxE,GAAyBA,EAAGhrB,OACnE,E,2NC7EG,SAASqsB,EAAKzsC,KAAQ8wC,GACzB,OAAOA,EAAKC,QAAO,CAACC,EAAKC,KACjBjxC,EAAIqC,eAAe4uC,KACnBD,EAAIC,GAAKjxC,EAAIixC,IAEVD,IACR,CAAC,EACR,CAEA,MAAME,EAAqB,iBAAWvnC,WAChCwnC,EAAuB,iBAAWzU,aACjC,SAASgI,EAAsB1kC,EAAK6jC,GACnCA,EAAKuN,iBACLpxC,EAAIijC,aAAeiO,EAAmB7nB,KAAK,kBAC3CrpB,EAAIknC,eAAiBiK,EAAqB9nB,KAAK,oBAG/CrpB,EAAIijC,aAAe,iBAAWt5B,WAAW0f,KAAK,kBAC9CrpB,EAAIknC,eAAiB,iBAAWxK,aAAarT,KAAK,kBAE1D,CAEA,MAAMgoB,EAAkB,KAEjB,SAASnpB,EAAWloB,GACvB,MAAmB,iBAARA,EAMf,SAAoByc,GAChB,IAAI7Z,EAAI,EAAG1B,EAAS,EACpB,IAAK,IAAIG,EAAI,EAAGyC,EAAI2Y,EAAIvb,OAAQG,EAAIyC,EAAGzC,IACnCuB,EAAI6Z,EAAIoL,WAAWxmB,GACfuB,EAAI,IACJ1B,GAAU,EAEL0B,EAAI,KACT1B,GAAU,EAEL0B,EAAI,OAAUA,GAAK,MACxB1B,GAAU,GAGVG,IACAH,GAAU,GAGlB,OAAOA,CACX,CAxBeowC,CAAWtxC,GAGf2Q,KAAK0kB,MAAMr1B,EAAIkoB,YAAcloB,EAAImxB,MAAQkgB,EACpD,CAwBO,SAAS7C,IACZ,OAAQjmC,KAAK8+B,MAAMv+B,SAAS,IAAI8wB,UAAU,GACtCjpB,KAAKE,SAAS/H,SAAS,IAAI8wB,UAAU,EAAG,EAChD,C,oJC1DA,MAAM2X,EAAepvC,OAAOmB,OAAO,MACnCiuC,EAAmB,KAAI,IACvBA,EAAoB,MAAI,IACxBA,EAAmB,KAAI,IACvBA,EAAmB,KAAI,IACvBA,EAAsB,QAAI,IAC1BA,EAAsB,QAAI,IAC1BA,EAAmB,KAAI,IACvB,MAAMC,EAAuBrvC,OAAOmB,OAAO,MAC3CnB,OAAOkF,KAAKkqC,GAAc5sC,SAAS1E,IAC/BuxC,EAAqBD,EAAatxC,IAAQA,CAAG,IAEjD,MAAMwxC,EAAe,CAAE/tC,KAAM,QAASyJ,KAAM,e,gICX5C,MAAMukC,EAAQ,mEAERC,EAA+B,oBAAf/pB,WAA6B,GAAK,IAAIA,WAAW,KACvE,IAAK,IAAIvmB,EAAI,EAAGA,EAAIqwC,GAAcrwC,IAC9BswC,EAAOD,EAAM7pB,WAAWxmB,IAAMA,EAE3B,MAAMogC,EAAUmQ,IACnB,IAAyCvwC,EAArC4mB,EAAQ,IAAIL,WAAWgqB,GAAiBlwC,EAAMumB,EAAM/mB,OAAQ2wC,EAAS,GACzE,IAAKxwC,EAAI,EAAGA,EAAIK,EAAKL,GAAK,EACtBwwC,GAAUH,EAAMzpB,EAAM5mB,IAAM,GAC5BwwC,GAAUH,GAAmB,EAAXzpB,EAAM5mB,KAAW,EAAM4mB,EAAM5mB,EAAI,IAAM,GACzDwwC,GAAUH,GAAuB,GAAfzpB,EAAM5mB,EAAI,KAAY,EAAM4mB,EAAM5mB,EAAI,IAAM,GAC9DwwC,GAAUH,EAAqB,GAAfzpB,EAAM5mB,EAAI,IAQ9B,OANIK,EAAM,GAAM,EACZmwC,EAASA,EAAOjY,UAAU,EAAGiY,EAAO3wC,OAAS,GAAK,IAE7CQ,EAAM,GAAM,IACjBmwC,EAASA,EAAOjY,UAAU,EAAGiY,EAAO3wC,OAAS,GAAK,MAE/C2wC,CAAM,EAEJnQ,EAAUmQ,IACnB,IAA8DxwC,EAAUywC,EAAUC,EAAUC,EAAUC,EAAlGC,EAA+B,IAAhBL,EAAO3wC,OAAeQ,EAAMmwC,EAAO3wC,OAAWkD,EAAI,EACnC,MAA9BytC,EAAOA,EAAO3wC,OAAS,KACvBgxC,IACkC,MAA9BL,EAAOA,EAAO3wC,OAAS,IACvBgxC,KAGR,MAAMN,EAAc,IAAIjqB,YAAYuqB,GAAejqB,EAAQ,IAAIL,WAAWgqB,GAC1E,IAAKvwC,EAAI,EAAGA,EAAIK,EAAKL,GAAK,EACtBywC,EAAWH,EAAOE,EAAOhqB,WAAWxmB,IACpC0wC,EAAWJ,EAAOE,EAAOhqB,WAAWxmB,EAAI,IACxC2wC,EAAWL,EAAOE,EAAOhqB,WAAWxmB,EAAI,IACxC4wC,EAAWN,EAAOE,EAAOhqB,WAAWxmB,EAAI,IACxC4mB,EAAM7jB,KAAQ0tC,GAAY,EAAMC,GAAY,EAC5C9pB,EAAM7jB,MAAoB,GAAX2tC,IAAkB,EAAMC,GAAY,EACnD/pB,EAAM7jB,MAAoB,EAAX4tC,IAAiB,EAAiB,GAAXC,EAE1C,OAAOL,CAAW,C,kQCvCtB,MAAMO,EAA+C,mBAAhBxqB,YACxBkiB,EAAe,CAACuI,EAAetO,KACxC,GAA6B,iBAAlBsO,EACP,MAAO,CACH1uC,KAAM,UACNyJ,KAAMklC,EAAUD,EAAetO,IAGvC,MAAMpgC,EAAO0uC,EAAc3qC,OAAO,GAClC,GAAa,MAAT/D,EACA,MAAO,CACHA,KAAM,UACNyJ,KAAMmlC,EAAmBF,EAAcxY,UAAU,GAAIkK,IAI7D,OADmB,EAAA0N,qBAAqB9tC,GAIjC0uC,EAAclxC,OAAS,EACxB,CACEwC,KAAM,EAAA8tC,qBAAqB9tC,GAC3ByJ,KAAMilC,EAAcxY,UAAU,IAEhC,CACEl2B,KAAM,EAAA8tC,qBAAqB9tC,IARxB,EAAA+tC,YASN,EAEHa,EAAqB,CAACnlC,EAAM22B,KAC9B,GAAIqO,EAAuB,CACvB,MAAMI,GAAU,IAAA7Q,QAAOv0B,GACvB,OAAOklC,EAAUE,EAASzO,EAC9B,CAEI,MAAO,CAAE+N,QAAQ,EAAM1kC,OAC3B,EAEEklC,EAAY,CAACllC,EAAM22B,IAEZ,SADDA,EAEI32B,aAAgBqlC,KAETrlC,EAIA,IAAIqlC,KAAK,CAACrlC,IAIjBA,aAAgBwa,YAETxa,EAIAA,EAAK6a,M,8MCzD5B,MAAMyqB,EAAiC,mBAATD,MACT,oBAATA,MACqC,6BAAzCrwC,OAAOjC,UAAU4I,SAASlF,KAAK4uC,MACjCL,EAA+C,mBAAhBxqB,YAE/B+qB,EAAU1yC,GACyB,mBAAvB2nB,YAAY+qB,OACpB/qB,YAAY+qB,OAAO1yC,GACnBA,GAAOA,EAAIgoB,kBAAkBL,YAEjC4nB,EAAe,EAAG7rC,OAAMyJ,QAAQm8B,EAAgBtuB,IAC9Cy3B,GAAkBtlC,aAAgBqlC,KAC9BlJ,EACOtuB,EAAS7N,GAGTwlC,EAAmBxlC,EAAM6N,GAG/Bm3B,IACJhlC,aAAgBwa,aAAe+qB,EAAOvlC,IACnCm8B,EACOtuB,EAAS7N,GAGTwlC,EAAmB,IAAIH,KAAK,CAACrlC,IAAQ6N,GAI7CA,EAAS,EAAAu2B,aAAa7tC,IAASyJ,GAAQ,KAE5CwlC,EAAqB,CAACxlC,EAAM6N,KAC9B,MAAM43B,EAAa,IAAIC,WAKvB,OAJAD,EAAWE,OAAS,WAChB,MAAM/hB,EAAU6hB,EAAWl6B,OAAO8H,MAAM,KAAK,GAC7CxF,EAAS,KAAO+V,GAAW,IAC/B,EACO6hB,EAAWG,cAAc5lC,EAAK,EAEzC,SAAS6lC,EAAQ7lC,GACb,OAAIA,aAAgBya,WACTza,EAEFA,aAAgBwa,YACd,IAAIC,WAAWza,GAGf,IAAIya,WAAWza,EAAK6a,OAAQ7a,EAAK8lC,WAAY9lC,EAAK+a,WAEjE,CACA,IAAIgrB,EACG,SAASC,EAAqBzM,EAAQ1rB,GACzC,OAAIy3B,GAAkB/L,EAAOv5B,gBAAgBqlC,KAClC9L,EAAOv5B,KAAKimC,cAAcluC,KAAK8tC,GAAS9tC,KAAK8V,GAE/Cm3B,IACJzL,EAAOv5B,gBAAgBwa,aAAe+qB,EAAOhM,EAAOv5B,OAC9C6N,EAASg4B,EAAQtM,EAAOv5B,YAEnCoiC,EAAa7I,GAAQ,GAAQ2M,IACpBH,IACDA,EAAe,IAAII,aAEvBt4B,EAASk4B,EAAazR,OAAO4R,GAAS,GAE9C,C,0dC/DA,MAAME,EAAYprB,OAAOC,aAAa,IAChCkmB,EAAgB,CAAC7G,EAASzsB,KAE5B,MAAM9Z,EAASumC,EAAQvmC,OACjBsyC,EAAiB,IAAI/xC,MAAMP,GACjC,IAAIuyC,EAAQ,EACZhM,EAAQ9iC,SAAQ,CAAC+hC,EAAQrlC,MAErB,IAAAkuC,cAAa7I,GAAQ,GAAQ0L,IACzBoB,EAAenyC,GAAK+wC,IACdqB,IAAUvyC,GACZ8Z,EAASw4B,EAAe7mB,KAAK4mB,GACjC,GACF,GACJ,EAEAlF,EAAgB,CAACqF,EAAgB5P,KACnC,MAAM0P,EAAiBE,EAAelzB,MAAM+yB,GACtC9L,EAAU,GAChB,IAAK,IAAIpmC,EAAI,EAAGA,EAAImyC,EAAetyC,OAAQG,IAAK,CAC5C,MAAMsyC,GAAgB,IAAA9J,cAAa2J,EAAenyC,GAAIyiC,GAEtD,GADA2D,EAAQ/mC,KAAKizC,GACc,UAAvBA,EAAcjwC,KACd,KAER,CACA,OAAO+jC,CAAO,EAEX,SAASgJ,IACZ,OAAO,IAAImD,gBAAgB,CACvB,SAAAC,CAAUnN,EAAQoN,IACd,IAAAX,sBAAqBzM,GAAS0L,IAC1B,MAAM2B,EAAgB3B,EAAclxC,OACpC,IAAI8yC,EAEJ,GAAID,EAAgB,IAChBC,EAAS,IAAIpsB,WAAW,GACxB,IAAIqsB,SAASD,EAAOhsB,QAAQksB,SAAS,EAAGH,QAEvC,GAAIA,EAAgB,MAAO,CAC5BC,EAAS,IAAIpsB,WAAW,GACxB,MAAMusB,EAAO,IAAIF,SAASD,EAAOhsB,QACjCmsB,EAAKD,SAAS,EAAG,KACjBC,EAAKC,UAAU,EAAGL,EACtB,KACK,CACDC,EAAS,IAAIpsB,WAAW,GACxB,MAAMusB,EAAO,IAAIF,SAASD,EAAOhsB,QACjCmsB,EAAKD,SAAS,EAAG,KACjBC,EAAKE,aAAa,EAAGC,OAAOP,GAChC,CAEIrN,EAAOv5B,MAA+B,iBAAhBu5B,EAAOv5B,OAC7B6mC,EAAO,IAAM,KAEjBF,EAAWS,QAAQP,GACnBF,EAAWS,QAAQnC,EAAc,GAEzC,GAER,CACA,IAAIoC,EACJ,SAASC,EAAYC,GACjB,OAAOA,EAAO3D,QAAO,CAACC,EAAK2D,IAAU3D,EAAM2D,EAAMzzC,QAAQ,EAC7D,CACA,SAAS0zC,EAAaF,EAAQvjB,GAC1B,GAAIujB,EAAO,GAAGxzC,SAAWiwB,EACrB,OAAOujB,EAAO1uB,QAElB,MAAMgC,EAAS,IAAIJ,WAAWuJ,GAC9B,IAAIpB,EAAI,EACR,IAAK,IAAI1uB,EAAI,EAAGA,EAAI8vB,EAAM9vB,IACtB2mB,EAAO3mB,GAAKqzC,EAAO,GAAG3kB,KAClBA,IAAM2kB,EAAO,GAAGxzC,SAChBwzC,EAAO1uB,QACP+J,EAAI,GAMZ,OAHI2kB,EAAOxzC,QAAU6uB,EAAI2kB,EAAO,GAAGxzC,SAC/BwzC,EAAO,GAAKA,EAAO,GAAG/yC,MAAMouB,IAEzB/H,CACX,CACO,SAASkoB,EAA0BjJ,EAAYnD,GAC7C0Q,IACDA,EAAe,IAAIK,aAEvB,MAAMH,EAAS,GACf,IAAItiB,EAAQ,EACR0iB,GAAkB,EAClBC,GAAW,EACf,OAAO,IAAInB,gBAAgB,CACvB,SAAAC,CAAUc,EAAOb,GAEb,IADAY,EAAOh0C,KAAKi0C,KACC,CACT,GAAc,IAAVviB,EAAqC,CACrC,GAAIqiB,EAAYC,GAAU,EACtB,MAEJ,MAAMV,EAASY,EAAaF,EAAQ,GACpCK,IAAkC,KAAtBf,EAAO,IACnBc,EAA6B,IAAZd,EAAO,GAEpB5hB,EADA0iB,EAAiB,IACT,EAEgB,MAAnBA,EACG,EAGA,CAEhB,MACK,GAAc,IAAV1iB,EAAiD,CACtD,GAAIqiB,EAAYC,GAAU,EACtB,MAEJ,MAAMM,EAAcJ,EAAaF,EAAQ,GACzCI,EAAiB,IAAIb,SAASe,EAAYhtB,OAAQgtB,EAAY/B,WAAY+B,EAAY9zC,QAAQ+zC,UAAU,GACxG7iB,EAAQ,CACZ,MACK,GAAc,IAAVA,EAAiD,CACtD,GAAIqiB,EAAYC,GAAU,EACtB,MAEJ,MAAMM,EAAcJ,EAAaF,EAAQ,GACnCP,EAAO,IAAIF,SAASe,EAAYhtB,OAAQgtB,EAAY/B,WAAY+B,EAAY9zC,QAC5EkB,EAAI+xC,EAAKe,UAAU,GACzB,GAAI9yC,EAAIuO,KAAKwkC,IAAI,EAAG,IAAW,EAAG,CAE9BrB,EAAWS,QAAQ,EAAA9C,cACnB,KACJ,CACAqD,EAAiB1yC,EAAIuO,KAAKwkC,IAAI,EAAG,IAAMhB,EAAKe,UAAU,GACtD9iB,EAAQ,CACZ,KACK,CACD,GAAIqiB,EAAYC,GAAUI,EACtB,MAEJ,MAAM3nC,EAAOynC,EAAaF,EAAQI,GAClChB,EAAWS,SAAQ,IAAA1K,cAAakL,EAAW5nC,EAAOqnC,EAAa9S,OAAOv0B,GAAO22B,IAC7E1R,EAAQ,CACZ,CACA,GAAuB,IAAnB0iB,GAAwBA,EAAiB7N,EAAY,CACrD6M,EAAWS,QAAQ,EAAA9C,cACnB,KACJ,CACJ,CACJ,GAER,CACO,MAAMjO,EAAW,C,0EC/IjB,SAAS4R,EAAQvR,GACpBA,EAAOA,GAAQ,CAAC,EAChBrjC,KAAK60C,GAAKxR,EAAKyR,KAAO,IACtB90C,KAAK+0C,IAAM1R,EAAK0R,KAAO,IACvB/0C,KAAKg1C,OAAS3R,EAAK2R,QAAU,EAC7Bh1C,KAAKi1C,OAAS5R,EAAK4R,OAAS,GAAK5R,EAAK4R,QAAU,EAAI5R,EAAK4R,OAAS,EAClEj1C,KAAKk1C,SAAW,CACpB,C,8BAOAN,EAAQl1C,UAAUy1C,SAAW,WACzB,IAAIN,EAAK70C,KAAK60C,GAAK1kC,KAAKwkC,IAAI30C,KAAKg1C,OAAQh1C,KAAKk1C,YAC9C,GAAIl1C,KAAKi1C,OAAQ,CACb,IAAIG,EAAOjlC,KAAKE,SACZglC,EAAYllC,KAAKC,MAAMglC,EAAOp1C,KAAKi1C,OAASJ,GAChDA,EAA8B,EAAxB1kC,KAAKC,MAAa,GAAPglC,GAAwCP,EAAKQ,EAAtBR,EAAKQ,CACjD,CACA,OAAgC,EAAzBllC,KAAK2kC,IAAID,EAAI70C,KAAK+0C,IAC7B,EAMAH,EAAQl1C,UAAUuG,MAAQ,WACtBjG,KAAKk1C,SAAW,CACpB,EAMAN,EAAQl1C,UAAU41C,OAAS,SAAUR,GACjC90C,KAAK60C,GAAKC,CACd,EAMAF,EAAQl1C,UAAU61C,OAAS,SAAUR,GACjC/0C,KAAK+0C,IAAMA,CACf,EAMAH,EAAQl1C,UAAU81C,UAAY,SAAUP,GACpCj1C,KAAKi1C,OAASA,CAClB,C,qaC3DA,MAAMtnB,EAAQ,CAAC,EACf,SAASwjB,EAAOxP,EAAK0B,GACE,iBAAR1B,IACP0B,EAAO1B,EACPA,OAAM12B,GAEVo4B,EAAOA,GAAQ,CAAC,EAChB,MAAMoS,GAAS,IAAAp0B,KAAIsgB,EAAK0B,EAAKpB,MAAQ,cAC/BL,EAAS6T,EAAO7T,OAChBl3B,EAAK+qC,EAAO/qC,GACZu3B,EAAOwT,EAAOxT,KACdyT,EAAgB/nB,EAAMjjB,IAAOu3B,KAAQtU,EAAMjjB,GAAU,KAK3D,IAAI2P,EAaJ,OAjBsBgpB,EAAKsS,UACvBtS,EAAK,0BACL,IAAUA,EAAKuS,WACfF,EAGAr7B,EAAK,IAAI,EAAAw7B,QAAQjU,EAAQyB,IAGpB1V,EAAMjjB,KACPijB,EAAMjjB,GAAM,IAAI,EAAAmrC,QAAQjU,EAAQyB,IAEpChpB,EAAKsT,EAAMjjB,IAEX+qC,EAAOvyB,QAAUmgB,EAAKngB,QACtBmgB,EAAKngB,MAAQuyB,EAAOrT,UAEjB/nB,EAAGD,OAAOq7B,EAAOxT,KAAMoB,EAClC,CAGA1hC,OAAOu0B,OAAOib,EAAQ,CAClB0E,QAAO,UACP5S,OAAM,SACN5oB,GAAI82B,EACJ2E,QAAS3E,G,kdCrCN,MAAM0E,UAAgB,EAAAt2C,QACzB,WAAA8G,CAAYs7B,EAAK0B,GACb,IAAIuH,EACJnL,QACAz/B,KAAK+1C,KAAO,CAAC,EACb/1C,KAAKg2C,KAAO,GACRrU,GAAO,iBAAoBA,IAC3B0B,EAAO1B,EACPA,OAAM12B,IAEVo4B,EAAOA,GAAQ,CAAC,GACXpB,KAAOoB,EAAKpB,MAAQ,aACzBjiC,KAAKqjC,KAAOA,GACZ,IAAAa,uBAAsBlkC,KAAMqjC,GAC5BrjC,KAAKi2C,cAAmC,IAAtB5S,EAAK4S,cACvBj2C,KAAKk2C,qBAAqB7S,EAAK6S,sBAAwBrS,KACvD7jC,KAAKm2C,kBAAkB9S,EAAK8S,mBAAqB,KACjDn2C,KAAKo2C,qBAAqB/S,EAAK+S,sBAAwB,KACvDp2C,KAAKq2C,oBAAwD,QAAnCzL,EAAKvH,EAAKgT,2BAAwC,IAAPzL,EAAgBA,EAAK,IAC1F5qC,KAAKs2C,QAAU,IAAI,EAAA1B,QAAQ,CACvBE,IAAK90C,KAAKm2C,oBACVpB,IAAK/0C,KAAKo2C,uBACVnB,OAAQj1C,KAAKq2C,wBAEjBr2C,KAAK0sC,QAAQ,MAAQrJ,EAAKqJ,QAAU,IAAQrJ,EAAKqJ,SACjD1sC,KAAKu2C,YAAc,SACnBv2C,KAAK2hC,IAAMA,EACX,MAAM6U,EAAUnT,EAAKoT,QAAU,EAC/Bz2C,KAAK02C,QAAU,IAAIF,EAAQG,QAC3B32C,KAAK42C,QAAU,IAAIJ,EAAQK,QAC3B72C,KAAK82C,cAAoC,IAArBzT,EAAK0T,YACrB/2C,KAAK82C,cACL92C,KAAKsQ,MACb,CACA,YAAA2lC,CAAalyC,GACT,OAAKzD,UAAUI,QAEfV,KAAKg3C,gBAAkBjzC,EAClBA,IACD/D,KAAKi3C,eAAgB,GAElBj3C,MALIA,KAAKg3C,aAMpB,CACA,oBAAAd,CAAqBnyC,GACjB,YAAUkH,IAANlH,EACO/D,KAAKk3C,uBAChBl3C,KAAKk3C,sBAAwBnzC,EACtB/D,KACX,CACA,iBAAAm2C,CAAkBpyC,GACd,IAAI6mC,EACJ,YAAU3/B,IAANlH,EACO/D,KAAKm3C,oBAChBn3C,KAAKm3C,mBAAqBpzC,EACF,QAAvB6mC,EAAK5qC,KAAKs2C,eAA4B,IAAP1L,GAAyBA,EAAG0K,OAAOvxC,GAC5D/D,KACX,CACA,mBAAAq2C,CAAoBtyC,GAChB,IAAI6mC,EACJ,YAAU3/B,IAANlH,EACO/D,KAAKo3C,sBAChBp3C,KAAKo3C,qBAAuBrzC,EACJ,QAAvB6mC,EAAK5qC,KAAKs2C,eAA4B,IAAP1L,GAAyBA,EAAG4K,UAAUzxC,GAC/D/D,KACX,CACA,oBAAAo2C,CAAqBryC,GACjB,IAAI6mC,EACJ,YAAU3/B,IAANlH,EACO/D,KAAKq3C,uBAChBr3C,KAAKq3C,sBAAwBtzC,EACL,QAAvB6mC,EAAK5qC,KAAKs2C,eAA4B,IAAP1L,GAAyBA,EAAG2K,OAAOxxC,GAC5D/D,KACX,CACA,OAAA0sC,CAAQ3oC,GACJ,OAAKzD,UAAUI,QAEfV,KAAKs3C,SAAWvzC,EACT/D,MAFIA,KAAKs3C,QAGpB,CAOA,oBAAAC,IAESv3C,KAAKw3C,eACNx3C,KAAKg3C,eACqB,IAA1Bh3C,KAAKs2C,QAAQpB,UAEbl1C,KAAKy3C,WAEb,CAQA,IAAAnnC,CAAKvQ,GACD,IAAKC,KAAKu2C,YAAYha,QAAQ,QAC1B,OAAOv8B,KACXA,KAAK03C,OAAS,IAAI,SAAO13C,KAAK2hC,IAAK3hC,KAAKqjC,MACxC,MAAMjpB,EAASpa,KAAK03C,OACd/U,EAAO3iC,KACbA,KAAKu2C,YAAc,UACnBv2C,KAAKi3C,eAAgB,EAErB,MAAMU,GAAiB,IAAA/3C,IAAGwa,EAAQ,QAAQ,WACtCuoB,EAAK8L,SACL1uC,GAAMA,GACV,IACMipC,EAAW77B,IACbnN,KAAKmoC,UACLnoC,KAAKu2C,YAAc,SACnBv2C,KAAKoB,aAAa,QAAS+L,GACvBpN,EACAA,EAAGoN,GAIHnN,KAAKu3C,sBACT,EAGEK,GAAW,IAAAh4C,IAAGwa,EAAQ,QAAS4uB,GACrC,IAAI,IAAUhpC,KAAKs3C,SAAU,CACzB,MAAM5K,EAAU1sC,KAAKs3C,SAEfO,EAAQ73C,KAAKyiC,cAAa,KAC5BkV,IACA3O,EAAQ,IAAIpkC,MAAM,YAClBwV,EAAOwF,OAAO,GACf8sB,GACC1sC,KAAKqjC,KAAKyD,WACV+Q,EAAM9Q,QAEV/mC,KAAKg2C,KAAK91C,MAAK,KACXF,KAAK0mC,eAAemR,EAAM,GAElC,CAGA,OAFA73C,KAAKg2C,KAAK91C,KAAKy3C,GACf33C,KAAKg2C,KAAK91C,KAAK03C,GACR53C,IACX,CAOA,OAAA81C,CAAQ/1C,GACJ,OAAOC,KAAKsQ,KAAKvQ,EACrB,CAMA,MAAA0uC,GAEIzuC,KAAKmoC,UAELnoC,KAAKu2C,YAAc,OACnBv2C,KAAKoB,aAAa,QAElB,MAAMgZ,EAASpa,KAAK03C,OACpB13C,KAAKg2C,KAAK91C,MAAK,IAAAN,IAAGwa,EAAQ,OAAQpa,KAAK83C,OAAOjvB,KAAK7oB,QAAQ,IAAAJ,IAAGwa,EAAQ,OAAQpa,KAAK+3C,OAAOlvB,KAAK7oB,QAAQ,IAAAJ,IAAGwa,EAAQ,QAASpa,KAAKge,QAAQ6K,KAAK7oB,QAAQ,IAAAJ,IAAGwa,EAAQ,QAASpa,KAAKkf,QAAQ2J,KAAK7oB,QAE3L,IAAAJ,IAAGI,KAAK42C,QAAS,UAAW52C,KAAKg4C,UAAUnvB,KAAK7oB,OACpD,CAMA,MAAA83C,GACI93C,KAAKoB,aAAa,OACtB,CAMA,MAAA22C,CAAOprC,GACH,IACI3M,KAAK42C,QAAQxtC,IAAIuD,EACrB,CACA,MAAOnL,GACHxB,KAAKkf,QAAQ,cAAe1d,EAChC,CACJ,CAMA,SAAAw2C,CAAU9R,IAEN,IAAA1D,WAAS,KACLxiC,KAAKoB,aAAa,SAAU8kC,EAAO,GACpClmC,KAAKyiC,aACZ,CAMA,OAAAzkB,CAAQ7Q,GACJnN,KAAKoB,aAAa,QAAS+L,EAC/B,CAOA,MAAAiN,CAAO69B,EAAK5U,GACR,IAAIjpB,EAASpa,KAAK+1C,KAAKkC,GAQvB,OAPK79B,EAIIpa,KAAK82C,eAAiB18B,EAAO89B,QAClC99B,EAAO07B,WAJP17B,EAAS,IAAI,EAAA6oB,OAAOjjC,KAAMi4C,EAAK5U,GAC/BrjC,KAAK+1C,KAAKkC,GAAO79B,GAKdA,CACX,CAOA,QAAA+9B,CAAS/9B,GACL,MAAM27B,EAAOp0C,OAAOkF,KAAK7G,KAAK+1C,MAC9B,IAAK,MAAMkC,KAAOlC,EAAM,CAEpB,GADe/1C,KAAK+1C,KAAKkC,GACdC,OACP,MAER,CACAl4C,KAAKo4C,QACT,CAOA,OAAAjJ,CAAQjJ,GACJ,MAAM8M,EAAiBhzC,KAAK02C,QAAQzV,OAAOiF,GAC3C,IAAK,IAAIrlC,EAAI,EAAGA,EAAImyC,EAAetyC,OAAQG,IACvCb,KAAK03C,OAAOnQ,MAAMyL,EAAenyC,GAAIqlC,EAAOsB,QAEpD,CAMA,OAAAW,GACInoC,KAAKg2C,KAAK7xC,SAASk0C,GAAeA,MAClCr4C,KAAKg2C,KAAKt1C,OAAS,EACnBV,KAAK42C,QAAQ0B,SACjB,CAMA,MAAAF,GACIp4C,KAAKi3C,eAAgB,EACrBj3C,KAAKw3C,eAAgB,EACrBx3C,KAAKkf,QAAQ,eACjB,CAMA,UAAA0b,GACI,OAAO56B,KAAKo4C,QAChB,CAUA,OAAAl5B,CAAQ8mB,EAAQZ,GACZ,IAAIwF,EACJ5qC,KAAKmoC,UACkB,QAAtByC,EAAK5qC,KAAK03C,cAA2B,IAAP9M,GAAyBA,EAAGhrB,QAC3D5f,KAAKs2C,QAAQrwC,QACbjG,KAAKu2C,YAAc,SACnBv2C,KAAKoB,aAAa,QAAS4kC,EAAQZ,GAC/BplC,KAAKg3C,gBAAkBh3C,KAAKi3C,eAC5Bj3C,KAAKy3C,WAEb,CAMA,SAAAA,GACI,GAAIz3C,KAAKw3C,eAAiBx3C,KAAKi3C,cAC3B,OAAOj3C,KACX,MAAM2iC,EAAO3iC,KACb,GAAIA,KAAKs2C,QAAQpB,UAAYl1C,KAAKk3C,sBAC9Bl3C,KAAKs2C,QAAQrwC,QACbjG,KAAKoB,aAAa,oBAClBpB,KAAKw3C,eAAgB,MAEpB,CACD,MAAM5Q,EAAQ5mC,KAAKs2C,QAAQnB,WAC3Bn1C,KAAKw3C,eAAgB,EACrB,MAAMK,EAAQ73C,KAAKyiC,cAAa,KACxBE,EAAKsU,gBAETj3C,KAAKoB,aAAa,oBAAqBuhC,EAAK2T,QAAQpB,UAEhDvS,EAAKsU,eAETtU,EAAKryB,MAAMnD,IACHA,GACAw1B,EAAK6U,eAAgB,EACrB7U,EAAK8U,YACLz3C,KAAKoB,aAAa,kBAAmB+L,IAGrCw1B,EAAK4V,aACT,IACF,GACH3R,GACC5mC,KAAKqjC,KAAKyD,WACV+Q,EAAM9Q,QAEV/mC,KAAKg2C,KAAK91C,MAAK,KACXF,KAAK0mC,eAAemR,EAAM,GAElC,CACJ,CAMA,WAAAU,GACI,MAAMC,EAAUx4C,KAAKs2C,QAAQpB,SAC7Bl1C,KAAKw3C,eAAgB,EACrBx3C,KAAKs2C,QAAQrwC,QACbjG,KAAKoB,aAAa,YAAao3C,EACnC,E,8DC7WG,SAAS54C,EAAGJ,EAAKqvC,EAAI9uC,GAExB,OADAP,EAAII,GAAGivC,EAAI9uC,GACJ,WACHP,EAAIY,IAAIyuC,EAAI9uC,EAChB,CACJ,C,gTCEA,MAAM04C,EAAkB92C,OAAO+2C,OAAO,CAClC5C,QAAS,EACT6C,cAAe,EACf/d,WAAY,EACZge,cAAe,EAEfC,YAAa,EACbt4C,eAAgB,IA0Bb,MAAM0iC,UAAe,EAAA1jC,QAIxB,WAAA8G,CAAYgU,EAAI49B,EAAK5U,GACjB5D,QAeAz/B,KAAK84C,WAAY,EAKjB94C,KAAK+4C,WAAY,EAIjB/4C,KAAKg5C,cAAgB,GAIrBh5C,KAAKi5C,WAAa,GAOlBj5C,KAAKk5C,OAAS,GAKdl5C,KAAKm5C,UAAY,EACjBn5C,KAAKo5C,IAAM,EAwBXp5C,KAAKq5C,KAAO,CAAC,EACbr5C,KAAKo/B,MAAQ,CAAC,EACdp/B,KAAKqa,GAAKA,EACVra,KAAKi4C,IAAMA,EACP5U,GAAQA,EAAKiW,OACbt5C,KAAKs5C,KAAOjW,EAAKiW,MAErBt5C,KAAK4rC,MAAQjqC,OAAOu0B,OAAO,CAAC,EAAGmN,GAC3BrjC,KAAKqa,GAAGy8B,cACR92C,KAAKsQ,MACb,CAeA,gBAAIipC,GACA,OAAQv5C,KAAK84C,SACjB,CAMA,SAAAU,GACI,GAAIx5C,KAAKg2C,KACL,OACJ,MAAM37B,EAAKra,KAAKqa,GAChBra,KAAKg2C,KAAO,EACR,IAAAp2C,IAAGya,EAAI,OAAQra,KAAKyuC,OAAO5lB,KAAK7oB,QAChC,IAAAJ,IAAGya,EAAI,SAAUra,KAAKy5C,SAAS5wB,KAAK7oB,QACpC,IAAAJ,IAAGya,EAAI,QAASra,KAAKge,QAAQ6K,KAAK7oB,QAClC,IAAAJ,IAAGya,EAAI,QAASra,KAAKkf,QAAQ2J,KAAK7oB,OAE1C,CAkBA,UAAIk4C,GACA,QAASl4C,KAAKg2C,IAClB,CAWA,OAAAF,GACI,OAAI91C,KAAK84C,YAET94C,KAAKw5C,YACAx5C,KAAKqa,GAAkB,eACxBra,KAAKqa,GAAG/J,OACR,SAAWtQ,KAAKqa,GAAGk8B,aACnBv2C,KAAKyuC,UALEzuC,IAOf,CAIA,IAAAsQ,GACI,OAAOtQ,KAAK81C,SAChB,CAgBA,IAAA3O,IAAQnmC,GAGJ,OAFAA,EAAK04C,QAAQ,WACb15C,KAAKe,KAAKV,MAAML,KAAMgB,GACfhB,IACX,CAkBA,IAAAe,CAAK8tC,KAAO7tC,GACR,IAAI4pC,EAAI+O,EAAIC,EACZ,GAAInB,EAAgB52C,eAAegtC,GAC/B,MAAM,IAAIjqC,MAAM,IAAMiqC,EAAGvmC,WAAa,8BAG1C,GADAtH,EAAK04C,QAAQ7K,GACT7uC,KAAK4rC,MAAMiO,UAAY75C,KAAKo/B,MAAM0a,YAAc95C,KAAKo/B,MAAM2a,SAE3D,OADA/5C,KAAKg6C,YAAYh5C,GACVhB,KAEX,MAAMkmC,EAAS,CACXhjC,KAAM,EAAA+2C,WAAWC,MACjBvtC,KAAM3L,EAEVklC,QAAiB,CAAC,GAGlB,GAFAA,EAAOsB,QAAQC,UAAmC,IAAxBznC,KAAKo/B,MAAMqI,SAEjC,mBAAsBzmC,EAAKA,EAAKN,OAAS,GAAI,CAC7C,MAAMgK,EAAK1K,KAAKo5C,MACVe,EAAMn5C,EAAK+F,MACjB/G,KAAKo6C,qBAAqB1vC,EAAIyvC,GAC9BjU,EAAOx7B,GAAKA,CAChB,CACA,MAAM2vC,EAAyG,QAAlFV,EAA+B,QAAzB/O,EAAK5qC,KAAKqa,GAAGq9B,cAA2B,IAAP9M,OAAgB,EAASA,EAAG3F,iBAA8B,IAAP0U,OAAgB,EAASA,EAAGh3C,SAC7Is9B,EAAcjgC,KAAK84C,aAAyC,QAAzBc,EAAK55C,KAAKqa,GAAGq9B,cAA2B,IAAPkC,OAAgB,EAASA,EAAGvS,mBAYtG,OAXsBrnC,KAAKo/B,MAAM2a,WAAaM,IAGrCpa,GACLjgC,KAAKs6C,wBAAwBpU,GAC7BlmC,KAAKkmC,OAAOA,IAGZlmC,KAAKi5C,WAAW/4C,KAAKgmC,IAEzBlmC,KAAKo/B,MAAQ,CAAC,EACPp/B,IACX,CAIA,oBAAAo6C,CAAqB1vC,EAAIyvC,GACrB,IAAIvP,EACJ,MAAM8B,EAAwC,QAA7B9B,EAAK5qC,KAAKo/B,MAAMsN,eAA4B,IAAP9B,EAAgBA,EAAK5qC,KAAK4rC,MAAM2O,WACtF,QAAgBtvC,IAAZyhC,EAEA,YADA1sC,KAAKq5C,KAAK3uC,GAAMyvC,GAIpB,MAAMtC,EAAQ73C,KAAKqa,GAAGooB,cAAa,YACxBziC,KAAKq5C,KAAK3uC,GACjB,IAAK,IAAI7J,EAAI,EAAGA,EAAIb,KAAKi5C,WAAWv4C,OAAQG,IACpCb,KAAKi5C,WAAWp4C,GAAG6J,KAAOA,GAC1B1K,KAAKi5C,WAAWn4C,OAAOD,EAAG,GAGlCs5C,EAAI/2C,KAAKpD,KAAM,IAAI4E,MAAM,2BAA2B,GACrD8nC,GACG3sC,EAAK,IAAIiB,KAEXhB,KAAKqa,GAAGqsB,eAAemR,GACvBsC,EAAI95C,MAAML,KAAMgB,EAAK,EAEzBjB,EAAGy6C,WAAY,EACfx6C,KAAKq5C,KAAK3uC,GAAM3K,CACpB,CAiBA,WAAA06C,CAAY5L,KAAO7tC,GACf,OAAO,IAAI4F,SAAQ,CAACpC,EAASsZ,KACzB,MAAM/d,EAAK,CAAC26C,EAAMC,IACPD,EAAO58B,EAAO48B,GAAQl2C,EAAQm2C,GAEzC56C,EAAGy6C,WAAY,EACfx5C,EAAKd,KAAKH,GACVC,KAAKe,KAAK8tC,KAAO7tC,EAAK,GAE9B,CAMA,WAAAg5C,CAAYh5C,GACR,IAAIm5C,EACiC,mBAA1Bn5C,EAAKA,EAAKN,OAAS,KAC1By5C,EAAMn5C,EAAK+F,OAEf,MAAMm/B,EAAS,CACXx7B,GAAI1K,KAAKm5C,YACTyB,SAAU,EACVC,SAAS,EACT75C,OACAo+B,MAAOz9B,OAAOu0B,OAAO,CAAE4jB,WAAW,GAAQ95C,KAAKo/B,QAEnDp+B,EAAKd,MAAK,CAACiN,KAAQ2tC,KACf,GAAI5U,IAAWlmC,KAAKk5C,OAAO,GAEvB,OAkBJ,OAhByB,OAAR/rC,EAET+4B,EAAO0U,SAAW56C,KAAK4rC,MAAMiO,UAC7B75C,KAAKk5C,OAAO1zB,QACR20B,GACAA,EAAIhtC,KAKZnN,KAAKk5C,OAAO1zB,QACR20B,GACAA,EAAI,QAASW,IAGrB5U,EAAO2U,SAAU,EACV76C,KAAK+6C,aAAa,IAE7B/6C,KAAKk5C,OAAOh5C,KAAKgmC,GACjBlmC,KAAK+6C,aACT,CAOA,WAAAA,CAAYC,GAAQ,GAChB,IAAKh7C,KAAK84C,WAAoC,IAAvB94C,KAAKk5C,OAAOx4C,OAC/B,OAEJ,MAAMwlC,EAASlmC,KAAKk5C,OAAO,GACvBhT,EAAO2U,UAAYG,IAGvB9U,EAAO2U,SAAU,EACjB3U,EAAO0U,WACP56C,KAAKo/B,MAAQ8G,EAAO9G,MACpBp/B,KAAKe,KAAKV,MAAML,KAAMkmC,EAAOllC,MACjC,CAOA,MAAAklC,CAAOA,GACHA,EAAO+R,IAAMj4C,KAAKi4C,IAClBj4C,KAAKqa,GAAG80B,QAAQjJ,EACpB,CAMA,MAAAuI,GAC4B,mBAAbzuC,KAAKs5C,KACZt5C,KAAKs5C,MAAM3sC,IACP3M,KAAKi7C,mBAAmBtuC,EAAK,IAIjC3M,KAAKi7C,mBAAmBj7C,KAAKs5C,KAErC,CAOA,kBAAA2B,CAAmBtuC,GACf3M,KAAKkmC,OAAO,CACRhjC,KAAM,EAAA+2C,WAAWiB,QACjBvuC,KAAM3M,KAAKm7C,KACLx5C,OAAOu0B,OAAO,CAAEklB,IAAKp7C,KAAKm7C,KAAME,OAAQr7C,KAAKs7C,aAAe3uC,GAC5DA,GAEd,CAOA,OAAAqR,CAAQ7Q,GACCnN,KAAK84C,WACN94C,KAAKoB,aAAa,gBAAiB+L,EAE3C,CAQA,OAAA+R,CAAQ8mB,EAAQZ,GACZplC,KAAK84C,WAAY,SACV94C,KAAK0K,GACZ1K,KAAKoB,aAAa,aAAc4kC,EAAQZ,GACxCplC,KAAKu7C,YACT,CAOA,UAAAA,GACI55C,OAAOkF,KAAK7G,KAAKq5C,MAAMl1C,SAASuG,IAE5B,IADmB1K,KAAKi5C,WAAWh4B,MAAMilB,GAAWve,OAAOue,EAAOx7B,MAAQA,IACzD,CAEb,MAAMyvC,EAAMn6C,KAAKq5C,KAAK3uC,UACf1K,KAAKq5C,KAAK3uC,GACbyvC,EAAIK,WACJL,EAAI/2C,KAAKpD,KAAM,IAAI4E,MAAM,gCAEjC,IAER,CAOA,QAAA60C,CAASvT,GAEL,GADsBA,EAAO+R,MAAQj4C,KAAKi4C,IAG1C,OAAQ/R,EAAOhjC,MACX,KAAK,EAAA+2C,WAAWiB,QACRhV,EAAOv5B,MAAQu5B,EAAOv5B,KAAK84B,IAC3BzlC,KAAKw7C,UAAUtV,EAAOv5B,KAAK84B,IAAKS,EAAOv5B,KAAKyuC,KAG5Cp7C,KAAKoB,aAAa,gBAAiB,IAAIwD,MAAM,8LAEjD,MACJ,KAAK,EAAAq1C,WAAWC,MAChB,KAAK,EAAAD,WAAWwB,aACZz7C,KAAK07C,QAAQxV,GACb,MACJ,KAAK,EAAA+T,WAAW0B,IAChB,KAAK,EAAA1B,WAAW2B,WACZ57C,KAAK67C,MAAM3V,GACX,MACJ,KAAK,EAAA+T,WAAW6B,WACZ97C,KAAK+7C,eACL,MACJ,KAAK,EAAA9B,WAAW+B,cACZh8C,KAAKs4C,UACL,MAAMnrC,EAAM,IAAIvI,MAAMshC,EAAOv5B,KAAKuB,SAElCf,EAAIR,KAAOu5B,EAAOv5B,KAAKA,KACvB3M,KAAKoB,aAAa,gBAAiB+L,GAG/C,CAOA,OAAAuuC,CAAQxV,GACJ,MAAMllC,EAAOklC,EAAOv5B,MAAQ,GACxB,MAAQu5B,EAAOx7B,IACf1J,EAAKd,KAAKF,KAAKm6C,IAAIjU,EAAOx7B,KAE1B1K,KAAK84C,UACL94C,KAAKi8C,UAAUj7C,GAGfhB,KAAKg5C,cAAc94C,KAAKyB,OAAO+2C,OAAO13C,GAE9C,CACA,SAAAi7C,CAAUj7C,GACN,GAAIhB,KAAKk8C,eAAiBl8C,KAAKk8C,cAAcx7C,OAAQ,CACjD,MAAMW,EAAYrB,KAAKk8C,cAAc/6C,QACrC,IAAK,MAAM0e,KAAYxe,EACnBwe,EAASxf,MAAML,KAAMgB,EAE7B,CACAy+B,MAAM1+B,KAAKV,MAAML,KAAMgB,GACnBhB,KAAKm7C,MAAQn6C,EAAKN,QAA2C,iBAA1BM,EAAKA,EAAKN,OAAS,KACtDV,KAAKs7C,YAAct6C,EAAKA,EAAKN,OAAS,GAE9C,CAMA,GAAAy5C,CAAIzvC,GACA,MAAMi4B,EAAO3iC,KACb,IAAIiF,GAAO,EACX,OAAO,YAAajE,GAEZiE,IAEJA,GAAO,EACP09B,EAAKuD,OAAO,CACRhjC,KAAM,EAAA+2C,WAAW0B,IACjBjxC,GAAIA,EACJiC,KAAM3L,IAEd,CACJ,CAOA,KAAA66C,CAAM3V,GACF,MAAMiU,EAAMn6C,KAAKq5C,KAAKnT,EAAOx7B,IACV,mBAARyvC,WAGJn6C,KAAKq5C,KAAKnT,EAAOx7B,IAEpByvC,EAAIK,WACJtU,EAAOv5B,KAAK+sC,QAAQ,MAGxBS,EAAI95C,MAAML,KAAMkmC,EAAOv5B,MAC3B,CAMA,SAAA6uC,CAAU9wC,EAAI0wC,GACVp7C,KAAK0K,GAAKA,EACV1K,KAAK+4C,UAAYqC,GAAOp7C,KAAKm7C,OAASC,EACtCp7C,KAAKm7C,KAAOC,EACZp7C,KAAK84C,WAAY,EACjB94C,KAAKm8C,eACLn8C,KAAKoB,aAAa,WAClBpB,KAAK+6C,aAAY,EACrB,CAMA,YAAAoB,GACIn8C,KAAKg5C,cAAc70C,SAASnD,GAAShB,KAAKi8C,UAAUj7C,KACpDhB,KAAKg5C,cAAgB,GACrBh5C,KAAKi5C,WAAW90C,SAAS+hC,IACrBlmC,KAAKs6C,wBAAwBpU,GAC7BlmC,KAAKkmC,OAAOA,EAAO,IAEvBlmC,KAAKi5C,WAAa,EACtB,CAMA,YAAA8C,GACI/7C,KAAKs4C,UACLt4C,KAAKkf,QAAQ,uBACjB,CAQA,OAAAo5B,GACQt4C,KAAKg2C,OAELh2C,KAAKg2C,KAAK7xC,SAASk0C,GAAeA,MAClCr4C,KAAKg2C,UAAO/qC,GAEhBjL,KAAKqa,GAAa,SAAEra,KACxB,CAiBA,UAAA46B,GAUI,OATI56B,KAAK84C,WACL94C,KAAKkmC,OAAO,CAAEhjC,KAAM,EAAA+2C,WAAW6B,aAGnC97C,KAAKs4C,UACDt4C,KAAK84C,WAEL94C,KAAKkf,QAAQ,wBAEVlf,IACX,CAMA,KAAA4f,GACI,OAAO5f,KAAK46B,YAChB,CAUA,QAAA6M,CAASA,GAEL,OADAznC,KAAKo/B,MAAMqI,SAAWA,EACfznC,IACX,CAUA,YAAI+5C,GAEA,OADA/5C,KAAKo/B,MAAM2a,UAAW,EACf/5C,IACX,CAcA,OAAA0sC,CAAQA,GAEJ,OADA1sC,KAAKo/B,MAAMsN,QAAUA,EACd1sC,IACX,CAYA,KAAAo8C,CAAMv8B,GAGF,OAFA7f,KAAKk8C,cAAgBl8C,KAAKk8C,eAAiB,GAC3Cl8C,KAAKk8C,cAAch8C,KAAK2f,GACjB7f,IACX,CAYA,UAAAq8C,CAAWx8B,GAGP,OAFA7f,KAAKk8C,cAAgBl8C,KAAKk8C,eAAiB,GAC3Cl8C,KAAKk8C,cAAcxC,QAAQ75B,GACpB7f,IACX,CAmBA,MAAAs8C,CAAOz8B,GACH,IAAK7f,KAAKk8C,cACN,OAAOl8C,KAEX,GAAI6f,EAAU,CACV,MAAMxe,EAAYrB,KAAKk8C,cACvB,IAAK,IAAIr7C,EAAI,EAAGA,EAAIQ,EAAUX,OAAQG,IAClC,GAAIgf,IAAaxe,EAAUR,GAEvB,OADAQ,EAAUP,OAAOD,EAAG,GACbb,IAGnB,MAEIA,KAAKk8C,cAAgB,GAEzB,OAAOl8C,IACX,CAKA,YAAAu8C,GACI,OAAOv8C,KAAKk8C,eAAiB,EACjC,CAcA,aAAAM,CAAc38B,GAGV,OAFA7f,KAAKy8C,sBAAwBz8C,KAAKy8C,uBAAyB,GAC3Dz8C,KAAKy8C,sBAAsBv8C,KAAK2f,GACzB7f,IACX,CAcA,kBAAA08C,CAAmB78B,GAGf,OAFA7f,KAAKy8C,sBAAwBz8C,KAAKy8C,uBAAyB,GAC3Dz8C,KAAKy8C,sBAAsB/C,QAAQ75B,GAC5B7f,IACX,CAmBA,cAAA28C,CAAe98B,GACX,IAAK7f,KAAKy8C,sBACN,OAAOz8C,KAEX,GAAI6f,EAAU,CACV,MAAMxe,EAAYrB,KAAKy8C,sBACvB,IAAK,IAAI57C,EAAI,EAAGA,EAAIQ,EAAUX,OAAQG,IAClC,GAAIgf,IAAaxe,EAAUR,GAEvB,OADAQ,EAAUP,OAAOD,EAAG,GACbb,IAGnB,MAEIA,KAAKy8C,sBAAwB,GAEjC,OAAOz8C,IACX,CAKA,oBAAA48C,GACI,OAAO58C,KAAKy8C,uBAAyB,EACzC,CAQA,uBAAAnC,CAAwBpU,GACpB,GAAIlmC,KAAKy8C,uBAAyBz8C,KAAKy8C,sBAAsB/7C,OAAQ,CACjE,MAAMW,EAAYrB,KAAKy8C,sBAAsBt7C,QAC7C,IAAK,MAAM0e,KAAYxe,EACnBwe,EAASxf,MAAML,KAAMkmC,EAAOv5B,KAEpC,CACJ,E,uJCt2BG,SAAS0U,EAAIsgB,EAAKM,EAAO,GAAI4a,GAChC,IAAIr9C,EAAMmiC,EAEVkb,EAAMA,GAA4B,oBAAb1Y,UAA4BA,SAC7C,MAAQxC,IACRA,EAAMkb,EAAI7Z,SAAW,KAAO6Z,EAAIhb,MAEjB,iBAARF,IACH,MAAQA,EAAI16B,OAAO,KAEf06B,EADA,MAAQA,EAAI16B,OAAO,GACb41C,EAAI7Z,SAAWrB,EAGfkb,EAAIhb,KAAOF,GAGpB,sBAAsBmb,KAAKnb,KAExBA,OADA,IAAuBkb,EACjBA,EAAI7Z,SAAW,KAAOrB,EAGtB,WAAaA,GAI3BniC,GAAM,IAAAwvB,OAAM2S,IAGXniC,EAAIykC,OACD,cAAc6Y,KAAKt9C,EAAIwjC,UACvBxjC,EAAIykC,KAAO,KAEN,eAAe6Y,KAAKt9C,EAAIwjC,YAC7BxjC,EAAIykC,KAAO,QAGnBzkC,EAAIyiC,KAAOziC,EAAIyiC,MAAQ,IACvB,MACMJ,GADkC,IAA3BriC,EAAIqiC,KAAKtF,QAAQ,KACV,IAAM/8B,EAAIqiC,KAAO,IAAMriC,EAAIqiC,KAS/C,OAPAriC,EAAIkL,GAAKlL,EAAIwjC,SAAW,MAAQnB,EAAO,IAAMriC,EAAIykC,KAAOhC,EAExDziC,EAAIu9C,KACAv9C,EAAIwjC,SACA,MACAnB,GACCgb,GAAOA,EAAI5Y,OAASzkC,EAAIykC,KAAO,GAAK,IAAMzkC,EAAIykC,MAChDzkC,CACX,C,oMClDO,SAASw9C,EAAkB9W,GAC9B,MAAM+W,EAAU,GACVC,EAAahX,EAAOv5B,KACpBwwC,EAAOjX,EAGb,OAFAiX,EAAKxwC,KAAOywC,EAAmBF,EAAYD,GAC3CE,EAAKE,YAAcJ,EAAQv8C,OACpB,CAAEwlC,OAAQiX,EAAMF,QAASA,EACpC,CACA,SAASG,EAAmBzwC,EAAMswC,GAC9B,IAAKtwC,EACD,OAAOA,EACX,IAAI,IAAA4nC,UAAS5nC,GAAO,CAChB,MAAM2wC,EAAc,CAAEC,cAAc,EAAMC,IAAKP,EAAQv8C,QAEvD,OADAu8C,EAAQ/8C,KAAKyM,GACN2wC,CACX,CACK,GAAIr8C,MAAMwjB,QAAQ9X,GAAO,CAC1B,MAAM8wC,EAAU,IAAIx8C,MAAM0L,EAAKjM,QAC/B,IAAK,IAAIG,EAAI,EAAGA,EAAI8L,EAAKjM,OAAQG,IAC7B48C,EAAQ58C,GAAKu8C,EAAmBzwC,EAAK9L,GAAIo8C,GAE7C,OAAOQ,CACX,CACK,GAAoB,iBAAT9wC,KAAuBA,aAAgB5E,MAAO,CAC1D,MAAM01C,EAAU,CAAC,EACjB,IAAK,MAAMh+C,KAAOkN,EACVhL,OAAOjC,UAAUmC,eAAeuB,KAAKuJ,EAAMlN,KAC3Cg+C,EAAQh+C,GAAO29C,EAAmBzwC,EAAKlN,GAAMw9C,IAGrD,OAAOQ,CACX,CACA,OAAO9wC,CACX,CASO,SAAS+wC,EAAkBxX,EAAQ+W,GAGtC,OAFA/W,EAAOv5B,KAAOgxC,EAAmBzX,EAAOv5B,KAAMswC,UACvC/W,EAAOmX,YACPnX,CACX,CACA,SAASyX,EAAmBhxC,EAAMswC,GAC9B,IAAKtwC,EACD,OAAOA,EACX,GAAIA,IAA8B,IAAtBA,EAAK4wC,aAAuB,CAIpC,GAHyC,iBAAb5wC,EAAK6wC,KAC7B7wC,EAAK6wC,KAAO,GACZ7wC,EAAK6wC,IAAMP,EAAQv8C,OAEnB,OAAOu8C,EAAQtwC,EAAK6wC,KAGpB,MAAM,IAAI54C,MAAM,sBAExB,CACK,GAAI3D,MAAMwjB,QAAQ9X,GACnB,IAAK,IAAI9L,EAAI,EAAGA,EAAI8L,EAAKjM,OAAQG,IAC7B8L,EAAK9L,GAAK88C,EAAmBhxC,EAAK9L,GAAIo8C,QAGzC,GAAoB,iBAATtwC,EACZ,IAAK,MAAMlN,KAAOkN,EACVhL,OAAOjC,UAAUmC,eAAeuB,KAAKuJ,EAAMlN,KAC3CkN,EAAKlN,GAAOk+C,EAAmBhxC,EAAKlN,GAAMw9C,IAItD,OAAOtwC,CACX,C,8UC5EA,MAAM8rC,EAAkB,CACpB,UACA,gBACA,aACA,gBACA,cACA,kBAOSzV,EAAW,EACjB,IAAIiX,GACX,SAAWA,GACPA,EAAWA,EAAoB,QAAI,GAAK,UACxCA,EAAWA,EAAuB,WAAI,GAAK,aAC3CA,EAAWA,EAAkB,MAAI,GAAK,QACtCA,EAAWA,EAAgB,IAAI,GAAK,MACpCA,EAAWA,EAA0B,cAAI,GAAK,gBAC9CA,EAAWA,EAAyB,aAAI,GAAK,eAC7CA,EAAWA,EAAuB,WAAI,GAAK,YAC9C,CARD,CAQGA,IAAeA,EAAa,CAAC,IAIzB,MAAMtD,EAMT,WAAAtwC,CAAYu3C,GACR59C,KAAK49C,SAAWA,CACpB,CAOA,MAAA3c,CAAOzhC,GACH,OAAIA,EAAI0D,OAAS+2C,EAAWC,OAAS16C,EAAI0D,OAAS+2C,EAAW0B,OACrD,IAAAkC,WAAUr+C,GAWX,CAACQ,KAAK89C,eAAet+C,IAVbQ,KAAK+9C,eAAe,CACvB76C,KAAM1D,EAAI0D,OAAS+2C,EAAWC,MACxBD,EAAWwB,aACXxB,EAAW2B,WACjB3D,IAAKz4C,EAAIy4C,IACTtrC,KAAMnN,EAAImN,KACVjC,GAAIlL,EAAIkL,IAKxB,CAIA,cAAAozC,CAAet+C,GAEX,IAAIyc,EAAM,GAAKzc,EAAI0D,KAmBnB,OAjBI1D,EAAI0D,OAAS+2C,EAAWwB,cACxBj8C,EAAI0D,OAAS+2C,EAAW2B,aACxB3/B,GAAOzc,EAAI69C,YAAc,KAIzB79C,EAAIy4C,KAAO,MAAQz4C,EAAIy4C,MACvBh8B,GAAOzc,EAAIy4C,IAAM,KAGjB,MAAQz4C,EAAIkL,KACZuR,GAAOzc,EAAIkL,IAGX,MAAQlL,EAAImN,OACZsP,GAAO1P,KAAKC,UAAUhN,EAAImN,KAAM3M,KAAK49C,WAElC3hC,CACX,CAMA,cAAA8hC,CAAev+C,GACX,MAAMw+C,GAAiB,IAAAhB,mBAAkBx9C,GACnC29C,EAAOn9C,KAAK89C,eAAeE,EAAe9X,QAC1C+W,EAAUe,EAAef,QAE/B,OADAA,EAAQvD,QAAQyD,GACTF,CACX,EAGJ,SAASgB,EAASj8C,GACd,MAAiD,oBAA1CL,OAAOjC,UAAU4I,SAASlF,KAAKpB,EAC1C,CAMO,MAAM60C,UAAgB,EAAAt3C,QAMzB,WAAA8G,CAAY63C,GACRze,QACAz/B,KAAKk+C,QAAUA,CACnB,CAMA,GAAA90C,CAAI5J,GACA,IAAI0mC,EACJ,GAAmB,iBAAR1mC,EAAkB,CACzB,GAAIQ,KAAKm+C,cACL,MAAM,IAAIv5C,MAAM,mDAEpBshC,EAASlmC,KAAKo+C,aAAa5+C,GAC3B,MAAM6+C,EAAgBnY,EAAOhjC,OAAS+2C,EAAWwB,aAC7C4C,GAAiBnY,EAAOhjC,OAAS+2C,EAAW2B,YAC5C1V,EAAOhjC,KAAOm7C,EAAgBpE,EAAWC,MAAQD,EAAW0B,IAE5D37C,KAAKm+C,cAAgB,IAAIG,EAAoBpY,GAElB,IAAvBA,EAAOmX,aACP5d,MAAMr+B,aAAa,UAAW8kC,IAKlCzG,MAAMr+B,aAAa,UAAW8kC,EAEtC,KACK,MAAI,IAAAqO,UAAS/0C,KAAQA,EAAI6xC,OAe1B,MAAM,IAAIzsC,MAAM,iBAAmBpF,GAbnC,IAAKQ,KAAKm+C,cACN,MAAM,IAAIv5C,MAAM,oDAGhBshC,EAASlmC,KAAKm+C,cAAcI,eAAe/+C,GACvC0mC,IAEAlmC,KAAKm+C,cAAgB,KACrB1e,MAAMr+B,aAAa,UAAW8kC,GAM1C,CACJ,CAOA,YAAAkY,CAAaniC,GACT,IAAIpb,EAAI,EAER,MAAM+C,EAAI,CACNV,KAAM4mC,OAAO7tB,EAAIhV,OAAO,KAE5B,QAA2BgE,IAAvBgvC,EAAWr2C,EAAEV,MACb,MAAM,IAAI0B,MAAM,uBAAyBhB,EAAEV,MAG/C,GAAIU,EAAEV,OAAS+2C,EAAWwB,cACtB73C,EAAEV,OAAS+2C,EAAW2B,WAAY,CAClC,MAAMrnC,EAAQ1T,EAAI,EAClB,KAA2B,MAApBob,EAAIhV,SAASpG,IAAcA,GAAKob,EAAIvb,SAC3C,MAAMwmB,EAAMjL,EAAImd,UAAU7kB,EAAO1T,GACjC,GAAIqmB,GAAO4iB,OAAO5iB,IAA0B,MAAlBjL,EAAIhV,OAAOpG,GACjC,MAAM,IAAI+D,MAAM,uBAEpBhB,EAAEy5C,YAAcvT,OAAO5iB,EAC3B,CAEA,GAAI,MAAQjL,EAAIhV,OAAOpG,EAAI,GAAI,CAC3B,MAAM0T,EAAQ1T,EAAI,EAClB,OAASA,GAAG,CAER,GAAI,MADMob,EAAIhV,OAAOpG,GAEjB,MACJ,GAAIA,IAAMob,EAAIvb,OACV,KACR,CACAkD,EAAEq0C,IAAMh8B,EAAImd,UAAU7kB,EAAO1T,EACjC,MAEI+C,EAAEq0C,IAAM,IAGZ,MAAM1yC,EAAO0W,EAAIhV,OAAOpG,EAAI,GAC5B,GAAI,KAAO0E,GAAQukC,OAAOvkC,IAASA,EAAM,CACrC,MAAMgP,EAAQ1T,EAAI,EAClB,OAASA,GAAG,CACR,MAAMuB,EAAI6Z,EAAIhV,OAAOpG,GACrB,GAAI,MAAQuB,GAAK0nC,OAAO1nC,IAAMA,EAAG,GAC3BvB,EACF,KACJ,CACA,GAAIA,IAAMob,EAAIvb,OACV,KACR,CACAkD,EAAE8G,GAAKo/B,OAAO7tB,EAAImd,UAAU7kB,EAAO1T,EAAI,GAC3C,CAEA,GAAIob,EAAIhV,SAASpG,GAAI,CACjB,MAAM29C,EAAUx+C,KAAKy+C,SAASxiC,EAAIyiC,OAAO79C,IACzC,IAAIg2C,EAAQ8H,eAAe/6C,EAAEV,KAAMs7C,GAI/B,MAAM,IAAI55C,MAAM,mBAHhBhB,EAAE+I,KAAO6xC,CAKjB,CACA,OAAO56C,CACX,CACA,QAAA66C,CAASxiC,GACL,IACI,OAAO1P,KAAKyiB,MAAM/S,EAAKjc,KAAKk+C,QAChC,CACA,MAAO18C,GACH,OAAO,CACX,CACJ,CACA,qBAAOm9C,CAAez7C,EAAMs7C,GACxB,OAAQt7C,GACJ,KAAK+2C,EAAWiB,QACZ,OAAO+C,EAASO,GACpB,KAAKvE,EAAW6B,WACZ,YAAmB7wC,IAAZuzC,EACX,KAAKvE,EAAW+B,cACZ,MAA0B,iBAAZwC,GAAwBP,EAASO,GACnD,KAAKvE,EAAWC,MAChB,KAAKD,EAAWwB,aACZ,OAAQx6C,MAAMwjB,QAAQ+5B,KACK,iBAAfA,EAAQ,IACW,iBAAfA,EAAQ,KAC6B,IAAzC/F,EAAgBlc,QAAQiiB,EAAQ,KAChD,KAAKvE,EAAW0B,IAChB,KAAK1B,EAAW2B,WACZ,OAAO36C,MAAMwjB,QAAQ+5B,GAEjC,CAIA,OAAAlG,GACQt4C,KAAKm+C,gBACLn+C,KAAKm+C,cAAcS,yBACnB5+C,KAAKm+C,cAAgB,KAE7B,EAUJ,MAAMG,EACF,WAAAj4C,CAAY6/B,GACRlmC,KAAKkmC,OAASA,EACdlmC,KAAKi9C,QAAU,GACfj9C,KAAK6+C,UAAY3Y,CACrB,CASA,cAAAqY,CAAeO,GAEX,GADA9+C,KAAKi9C,QAAQ/8C,KAAK4+C,GACd9+C,KAAKi9C,QAAQv8C,SAAWV,KAAK6+C,UAAUxB,YAAa,CAEpD,MAAMnX,GAAS,IAAAwX,mBAAkB19C,KAAK6+C,UAAW7+C,KAAKi9C,SAEtD,OADAj9C,KAAK4+C,yBACE1Y,CACX,CACA,OAAO,IACX,CAIA,sBAAA0Y,GACI5+C,KAAK6+C,UAAY,KACjB7+C,KAAKi9C,QAAU,EACnB,E,oHCrTJ,MAAMtL,EAA+C,mBAAhBxqB,YAC/B+qB,EAAU1yC,GACyB,mBAAvB2nB,YAAY+qB,OACpB/qB,YAAY+qB,OAAO1yC,GACnBA,EAAIgoB,kBAAkBL,YAE1B7e,EAAW3G,OAAOjC,UAAU4I,SAC5B2pC,EAAiC,mBAATD,MACT,oBAATA,MACoB,6BAAxB1pC,EAASlF,KAAK4uC,MAChB+M,EAAiC,mBAATC,MACT,oBAATA,MACoB,6BAAxB12C,EAASlF,KAAK47C,MAMf,SAASzK,EAAS/0C,GACrB,OAASmyC,IAA0BnyC,aAAe2nB,aAAe+qB,EAAO1yC,KACnEyyC,GAAkBzyC,aAAewyC,MACjC+M,GAAkBv/C,aAAew/C,IAC1C,CACO,SAASnB,EAAUr+C,EAAKy/C,GAC3B,IAAKz/C,GAAsB,iBAARA,EACf,OAAO,EAEX,GAAIyB,MAAMwjB,QAAQjlB,GAAM,CACpB,IAAK,IAAIqB,EAAI,EAAGyC,EAAI9D,EAAIkB,OAAQG,EAAIyC,EAAGzC,IACnC,GAAIg9C,EAAUr+C,EAAIqB,IACd,OAAO,EAGf,OAAO,CACX,CACA,GAAI0zC,EAAS/0C,GACT,OAAO,EAEX,GAAIA,EAAIy/C,QACkB,mBAAfz/C,EAAIy/C,QACU,IAArB3+C,UAAUI,OACV,OAAOm9C,EAAUr+C,EAAIy/C,UAAU,GAEnC,IAAK,MAAMx/C,KAAOD,EACd,GAAImC,OAAOjC,UAAUmC,eAAeuB,KAAK5D,EAAKC,IAAQo+C,EAAUr+C,EAAIC,IAChE,OAAO,EAGf,OAAO,CACX,C,GChDIy/C,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBn0C,IAAjBo0C,EACH,OAAOA,EAAaC,QAGrB,IAAIC,EAASL,EAAyBE,GAAY,CAGjDE,QAAS,CAAC,GAOX,OAHAE,EAAoBJ,GAAUG,EAAQA,EAAOD,QAASH,GAG/CI,EAAOD,OACf,CCrBAH,EAAoBt7C,EAAI,CAACy7C,EAASG,KACjC,IAAI,IAAIhgD,KAAOggD,EACXN,EAAoBr9C,EAAE29C,EAAYhgD,KAAS0/C,EAAoBr9C,EAAEw9C,EAAS7/C,IAC5EkC,OAAOI,eAAeu9C,EAAS7/C,EAAK,CAAEgD,YAAY,EAAM4hB,IAAKo7B,EAAWhgD,IAE1E,ECND0/C,EAAoBr9C,EAAI,CAACtC,EAAK23B,IAAUx1B,OAAOjC,UAAUmC,eAAeuB,KAAK5D,EAAK23B,GCClFgoB,EAAoBz9C,EAAK49C,IACH,oBAAXr9C,QAA0BA,OAAOM,aAC1CZ,OAAOI,eAAeu9C,EAASr9C,OAAOM,YAAa,CAAEP,MAAO,WAE7DL,OAAOI,eAAeu9C,EAAS,aAAc,CAAEt9C,OAAO,GAAO,E","sources":["webpack://chat-app/./node_modules/@socket.io/component-emitter/lib/esm/index.js","webpack://chat-app/./client/scripts/components/chat.js","webpack://chat-app/./client/scripts/components/emojiPicker.js","webpack://chat-app/./client/scripts/components/events.js","webpack://chat-app/./client/scripts/components/groupChat.js","webpack://chat-app/./client/scripts/socket/socket.js","webpack://chat-app/./node_modules/emoji-picker-element/database.js","webpack://chat-app/./node_modules/emoji-picker-element/picker.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/contrib/has-cors.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/contrib/parseqs.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/contrib/parseuri.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/globals.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/index.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/socket.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transport.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/index.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/polling-fetch.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/polling-xhr.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/polling.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/websocket.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/transports/webtransport.js","webpack://chat-app/./node_modules/engine.io-client/build/esm/util.js","webpack://chat-app/./node_modules/engine.io-parser/build/esm/commons.js","webpack://chat-app/./node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","webpack://chat-app/./node_modules/engine.io-parser/build/esm/decodePacket.browser.js","webpack://chat-app/./node_modules/engine.io-parser/build/esm/encodePacket.browser.js","webpack://chat-app/./node_modules/engine.io-parser/build/esm/index.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/contrib/backo2.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/index.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/manager.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/on.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/socket.js","webpack://chat-app/./node_modules/socket.io-client/build/esm/url.js","webpack://chat-app/./node_modules/socket.io-parser/build/esm/binary.js","webpack://chat-app/./node_modules/socket.io-parser/build/esm/index.js","webpack://chat-app/./node_modules/socket.io-parser/build/esm/is-binary.js","webpack://chat-app/webpack/bootstrap","webpack://chat-app/webpack/runtime/define property getters","webpack://chat-app/webpack/runtime/hasOwnProperty shorthand","webpack://chat-app/webpack/runtime/make namespace object"],"sourcesContent":["/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","import { handleHtmlOnlineUsers, onlineUsers } from '../socket/socket.js'\nimport { deleteGroupMessage, handleSendRequestGroup, addChatPopupInitialState } from './groupChat.js'\n\n// convert utc to local time\nexport const utcToLocal = (utcDate) => {\n\tconst date = new Date(utcDate)\n\n\tconst hours = ('0' + date.getHours()).slice(-2)\n\tconst minutes = ('0' + date.getMinutes()).slice(-2)\n\tconst day = date.getDate().toString()\n\tconst monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n\tconst month = monthNames[date.getMonth()]\n\tconst year = date.getFullYear()\n\n\treturn `${hours}:${minutes} ${day} ${month}, ${year}`\n}\n\nexport const showNotification = (text) => {\n\tdocument.querySelector('#notification-alert').classList.remove('hidden')\n\tdocument.querySelector('#notification-alert span').textContent = text\n\n\tsetTimeout(() => {\n\t\tdocument.querySelector('#notification-alert span').textContent = ''\n\t\tdocument.querySelector('#notification-alert').classList.add('hidden')\n\t}, 5000)\n}\n\n// when chat is clicked\nexport const chatClicked = async (htmlElement, ...args) => {\n\t// remove active class from previous chat\n\tdocument.querySelector('.chat-child.active')\n\t\t? document.querySelector('.chat-child.active').classList.remove('active')\n\t\t: null\n\tdocument.querySelector('.group-child.active')\n\t\t? document.querySelector('.group-child.active').classList.remove('active')\n\t\t: null\n\thtmlElement.classList.add('active')\n\n\t// reset unread status\n\tlet unreadElement = htmlElement.children[2]\n\tunreadElement.children[0].textContent = 0\n\tunreadElement.classList.contains('hidden') ? null : unreadElement.classList.add('hidden')\n\n\tconst clickedUser_Username = htmlElement.querySelector('.chat-username').innerText\n\tlet clickedUser = {}\n\n\tif (args[0] && args[0].username === clickedUser_Username) {\n\t\tclickedUser = args[0]\n\t} else {\n\t\tconst clickedUser_Id = htmlElement.dataset.id\n\t\tconst clickedUser_Name = htmlElement.querySelector('.chat-name').innerText\n\t\tconst clickedUser_Avatar = htmlElement.querySelector('.chat-img img').src\n\n\t\tclickedUser = {\n\t\t\tencryptedId: clickedUser_Id,\n\t\t\tname: clickedUser_Name,\n\t\t\tavatar: clickedUser_Avatar,\n\t\t\tusername: clickedUser_Username,\n\t\t}\n\t}\n\n\tlet isOnline = false\n\tlet statusElement = htmlElement.querySelector('.avatar')\n\t// console.log('statusElement', statusElement)\n\n\tstatusElement.classList.contains('online') ? (isOnline = true) : (isOnline = false)\n\thandleChatHeadAndEnd(clickedUser, isOnline)\n\thandleChats(clickedUser)\n}\n\n// handle chat head and end\nexport const handleChatHeadAndEnd = (clickedUser, isOnline = false) => {\n\tlet chat_mid = document.getElementById('all-chats')\n\tlet chat_end = document.getElementById('chats-end')\n\tlet chat_head = document.getElementById('chats-head')\n\tlet chat_head_name = document.getElementById('chat-head-name')\n\tlet chat_head_img = document.getElementById('chat-head-img')\n\tlet to_user_info_popup = document.getElementById('to-user-info-popup')\n\n\tchat_head.classList.contains('hidden') ? chat_head.classList.remove('hidden') : null\n\tchat_mid.classList.contains('hidden') ? chat_mid.classList.remove('hidden') : null\n\tchat_end.classList.contains('hidden') ? chat_end.classList.remove('hidden') : null\n\n\tchat_head_name.textContent = clickedUser.name\n\tchat_head_img.src = clickedUser.avatar\n\t\t? clickedUser.avatar\n\t\t: `https://avatar.iran.liara.run/username?username=${clickedUser.name.replace(/ /g, '+')}`\n\tto_user_info_popup.querySelector('#to-user-info-popup-name').textContent = clickedUser.name\n\tto_user_info_popup.querySelector('#to-user-info-popup-username').textContent = clickedUser.username\n\tto_user_info_popup.querySelector('#to-user-info-popup-img').src = clickedUser.avatar\n\t\t? clickedUser.avatar\n\t\t: `https://avatar.iran.liara.run/username?username=${clickedUser.name.replace(/ /g, '+')}`\n\n\tlet toUserInfoPopupOptions = document.querySelector('.to-user-info-popup-options')\n\ttoUserInfoPopupOptions.classList.contains('hidden') ? toUserInfoPopupOptions.classList.remove('hidden') : null\n\n\tlet groupInfoPopupOptions = document.querySelector('.group-info-popup-options')\n\tgroupInfoPopupOptions.classList.contains('hidden') ? null : groupInfoPopupOptions.classList.add('hidden')\n\n\tif (isOnline) {\n\t\tchat_head.querySelector('.avatar').classList.add('online')\n\t} else {\n\t\tchat_head.querySelector('.avatar').classList.remove('online')\n\t}\n\n\t// hide copy grp link btn\n\tlet copyBtn = document.querySelector('#copy-group-link-btn')\n\tcopyBtn.classList.contains('hidden') ? null : copyBtn.classList.add('hidden')\n}\n\nexport const handleChats = (clickedUser) => {\n\tlet chatSection = document.querySelector('.chat-section')\n\tif (chatSection.classList.contains('hidden')) chatSection.classList.remove('hidden')\n\n\tlet toUserProfileSecImg = document.querySelector('.to-user-profile-sec-img img')\n\ttoUserProfileSecImg.src = clickedUser.avatar\n\t\t? clickedUser.avatar\n\t\t: `https://avatar.iran.liara.run/username?username=${clickedUser.name.replace(/ /g, '+')}`\n\n\tlet toUserProfileSecName = document.querySelector('.to-user-profile-sec-name h1')\n\tlet toUserProfileSecUsername = document.querySelector('.to-user-profile-sec-name h3')\n\ttoUserProfileSecName.textContent = clickedUser.name\n\ttoUserProfileSecUsername.textContent = clickedUser.username\n\ttoUserProfileSecUsername.parentElement.dataset.tip = clickedUser.username\n\n\tlet receiverId = clickedUser.encryptedId\n\n\thandleConversation(receiverId)\n}\n\nexport const handleConversation = (receiverId) => {\n\tlet chat_end = document.getElementById('chats-end')\n\n\tfetch('/conv-api/get-conversation', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({ receiverId }),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log('data', data)\n\t\t\tlet isBlocked = data.isBlocked\n\t\t\tlet blockedBy = data.blockedBy\n\t\t\tlet currentUserId = data.senderId\n\t\t\tif (isBlocked) {\n\t\t\t\tchat_end.classList.add('hidden')\n\t\t\t\tlet blockDiv = document.querySelector('#chats-end-block')\n\t\t\t\tblockDiv.classList.remove('hidden')\n\t\t\t}\n\t\t\tif (blockedBy === currentUserId) {\n\t\t\t\tlet blockBtnChild = document.querySelector('#block-to-user').children[0]\n\t\t\t\tblockBtnChild.textContent = 'Unblock'\n\t\t\t} else if (blockedBy !== null) {\n\t\t\t\tlet blockBtn = document.querySelector('#block-to-user')\n\t\t\t\tblockBtn.classList.add('hidden')\n\n\t\t\t\tlet deleteChatBtn = document.querySelector('#delete-chat-to-user')\n\t\t\t\tdeleteChatBtn.classList.add('hidden')\n\n\t\t\t\tlet blockInfoDiv = document.querySelector('.block-info')\n\t\t\t\tif (blockInfoDiv.classList.contains('hidden')) {\n\t\t\t\t\tblockInfoDiv.classList.remove('hidden')\n\t\t\t\t}\n\n\t\t\t\tlet toUserInfoPopupOptions = document.querySelector('.to-user-info-popup-options')\n\t\t\t\ttoUserInfoPopupOptions.classList.contains('hidden')\n\t\t\t\t\t? toUserInfoPopupOptions.classList.remove('hidden')\n\t\t\t\t\t: null\n\t\t\t\ttoUserInfoPopupOptions.appendChild(blockInfoDiv)\n\t\t\t}\n\t\t\thandleHtmlConversation(data)\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in getting conversation: ', err)\n\t\t})\n}\n\nexport const handleHtmlConversation = (data) => {\n\tconst currentUserId = data.senderId\n\t// console.log('Data: ', data)\n\n\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\tif (data.messages.length === 0) {\n\t\tmsgContainerDiv.textContent = ''\n\t\treturn\n\t} else {\n\t\t// console.log(\"Creating new conversation\", data.messages);\n\t\tmsgContainerDiv.textContent = ''\n\t\tlet date = ''\n\t\tdata.messages = data.messages.filter((msg) => msg !== null)\n\t\tdata.messages.forEach((msg) => {\n\t\t\t// console.log(\"Message: \", msg);\n\t\t\t// create date\n\t\t\tlet msgDate = utcToLocal(msg.createdAt).slice(6)\n\t\t\tif (msgDate !== date) {\n\t\t\t\tdate = msgDate\n\t\t\t\tconst dayDiv = document.createElement('div')\n\t\t\t\tdayDiv.classList.add('day')\n\t\t\t\tconst dateDiv = document.createElement('div')\n\t\t\t\tdateDiv.classList.add('date')\n\t\t\t\tconst dateh1 = document.createElement('h1')\n\t\t\t\tdateh1.textContent = date\n\n\t\t\t\tdateDiv.appendChild(dateh1)\n\t\t\t\tdayDiv.appendChild(dateDiv)\n\t\t\t\tmsgContainerDiv.appendChild(dayDiv)\n\t\t\t}\n\n\t\t\tif (msg.senderId === currentUserId) {\n\t\t\t\tlet fromUserMsg = fromUserMsgComponent(msg.message, msg._id, utcToLocal(msg.createdAt).slice(0, 5))\n\t\t\t\tmsgContainerDiv.appendChild(fromUserMsg)\n\t\t\t} else {\n\t\t\t\tlet toUserMsg = toUserMsgComponent(msg.message, msg._id, utcToLocal(msg.createdAt).slice(0, 5))\n\t\t\t\tmsgContainerDiv.appendChild(toUserMsg)\n\t\t\t}\n\t\t})\n\t\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n\t}\n}\n\nexport const fromUserMsgComponent = (msg, msgId, time) => {\n\tlet component = document.createElement('div')\n\tcomponent.classList.add('from-user-msg')\n\tcomponent.dataset.id = msgId\n\tcomponent.innerHTML = `\n        <div class=\"delete-msg-btn hidden pr-2\">\n            <button class=\"btn btn-circle btn-outline border-neutral bg-neutral hover:bg-accent hover:border-accent h-6 w-6 min-h-4 group\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" class=\"h-4 w-4 stroke-accent group-hover:stroke-neutral\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M6 18L18 6M6 6l12 12\" stroke-width=\"2\" stroke-linejoin=\"round\" stroke-linecap=\"round\"></path>\n                </svg>\n            </button>\n        </div>\n        <div id=\"from-user-msg-container\" class=\"msg-container\">\n            <p class=\"py-1 text-base font-semibold text-black whitespace-pre-wrap\">${msg}</p>\n            <span class=\"text-sm font-normal text-black\">${time}</span>\n        </div>\n    `\n\treturn component\n}\n\nexport const toUserMsgComponent = (msg, msgId, time) => {\n\tlet component = document.createElement('div')\n\tcomponent.classList.add('to-user-msg')\n\tcomponent.dataset.id = msgId\n\tcomponent.innerHTML = `\n        <div id=\"to-user-msg-container\" class=\"msg-container\">\n            <p class=\"py-1 text-base font-semibold text-black whitespace-pre-wrap\">${msg}</p>\n            <span class=\"text-sm font-normal text-black\">${time}</span>\n        </div>\n        <div class=\"delete-msg-btn hidden pl-2\">\n            <button class=\"btn btn-circle btn-outline border-accent bg-accent hover:bg-neutral hover:border-neutral h-6 w-6 min-h-4 group\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" class=\"h-4 w-4 stroke-neutral group-hover:stroke-accent\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M6 18L18 6M6 6l12 12\" stroke-width=\"2\" stroke-linejoin=\"round\" stroke-linecap=\"round\"></path>\n                </svg>\n            </button>\n        </div>\n    `\n\treturn component\n}\n\nexport const createLeftsidePeople = (data) => {\n\tlet parentDiv = leftSidePersonComponent(data)\n\n\tlet allPrivateChats = document.querySelector('.private-chats')\n\tallPrivateChats.appendChild(parentDiv)\n\n\tchatClicked(parentDiv, data)\n\thandleHtmlOnlineUsers(onlineUsers)\n}\n\nexport const leftSidePersonComponent = (data) => {\n\tlet parentDiv = document.createElement('div')\n\tparentDiv.classList.add('chat-child', 'group')\n\tparentDiv.dataset.id = data.encryptedId ? data.encryptedId : data._id\n\tlet onlineClass = data.isOnline ? 'online' : ''\n\tparentDiv.innerHTML = `\n        <div class=\"avatar ${onlineClass}\">\n            <div class=\"chat-img w-14 scale-110 rounded-full\">\n                <img draggable=\"false\" class=\"scale-110\" src=\"${data.avatar}\" alt=\"${data.username}\" />\n            </div>\n        </div>\n        <div class=\"chat-name-parent\">\n            <h4 class=\"chat-name\">${data.name}</h4>\n            <h4 class=\"chat-username\">${data.username}</h4>\n        </div>\n        <div class=\"unread-badge hidden right-8\">\n            <div class=\"badge bg-secondary text-white\">0</div>\n        </div>\n    `\n\treturn parentDiv\n}\n\nexport const addPeopleToChat = async (element) => {\n\tlet alreadyThere = false\n\tlet clickedPerson = ''\n\t// console.log(element.children[1].children)\n\tconst eleUsername = element.children[1].children[1].innerText\n\n\t// Easter egg\n\tlet currentUserName = document.querySelector('#change-details-username').value\n\tlet selfChatJokes = [\n\t\t\"Talking to yourself? It's not a bug, it's a feature request!\",\n\t\t'Self-chatting: the ultimate form of code review.',\n\t\t'Error 404: Self-chat not found. But hey, who needs other people?',\n\t\t\"Trying to chat with yourself? Sorry, we're still working on that mirror feature.\",\n\t\t'Self-chatting: because sometimes even your code needs a pep talk.',\n\t\t'Looks like you want to talk to yourself. We call that solo debugging!',\n\t\t'No self-chatting yet, but we admire your self-confidence!',\n\t\t'Attempting self-chat? Our servers recommend a rubber duck instead.',\n\t\t'Self-chatting not available. Try talking to your rubber duck instead!',\n\t\t\"Hold on, we're still working on that 'inner monologue' feature.\",\n\t\t'Self-chatting is under construction. Meanwhile, feel free to talk to your plants!',\n\t\t\"Mirror, mirror on the wall, self-chat isn't here at all!\",\n\t\t'Self-chatting feature in progress. For now, practice your stand-up routine!',\n\t\t'Talking to yourself? You must be debugging in style!',\n\t\t\"Self-chat isn't ready, but you can always practice your next big speech.\",\n\t\t\"Looks like you're trying to chat with yourself. Maybe take a coffee break instead!\",\n\t\t'Self-chat feature coming soon. In the meantime, how about a quick meditation session?',\n\t\t\"Self-chatting isn't supported yet. Try our premium feature: talking to a pillow!\",\n\t]\n\tif (eleUsername === currentUserName) {\n\t\tlet alert = document.querySelector('.alert')\n\t\tlet alertText = alert.querySelector('span')\n\t\talertText.innerHTML = `Well, you found an easter egg! Here's a joke: <b>${selfChatJokes[Math.floor(Math.random() * selfChatJokes.length)]}</b>`\n\t\talert.classList.remove('hidden')\n\t\tsetTimeout(() => {\n\t\t\talert.classList.add('hidden')\n\t\t\talertText.textContent = ''\n\t\t}, 15000)\n\t\treturn\n\t}\n\n\tconst eleName = element.children[1].children[0].innerText\n\tconst eleAvatar = element.children[0].src\n\tconst eleId = element.dataset.id\n\n\tlet eleData = {\n\t\tencryptedId: eleId,\n\t\tname: eleName,\n\t\tusername: eleUsername,\n\t\tavatar: eleAvatar,\n\t}\n\n\tlet privateChats = document.querySelector('.private-chats')\n\tprivateChats.open ? null : (privateChats.open = true)\n\n\tlet leftPeople = document.querySelectorAll('.chat-child')\n\tleftPeople.forEach((person) => {\n\t\tlet personUsername = person.querySelector('.chat-username').innerText\n\n\t\tif (personUsername === eleData.username) {\n\t\t\talreadyThere = true\n\t\t\tclickedPerson = person\n\n\t\t\tif (person.classList.contains('hidden')) {\n\t\t\t\tperson.classList.remove('hidden')\n\t\t\t}\n\t\t}\n\t})\n\n\t// console.log('alreadyThere', alreadyThere)\n\tif (!alreadyThere) {\n\t\tfetch('/add-people-api/add-people-to-chat', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\treceiverId: eleData.encryptedId,\n\t\t\t}),\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((data) => {\n\t\t\t\tif (data.message === 'Added people to chat') {\n\t\t\t\t\tcreateLeftsidePeople(data.newPerson)\n\t\t\t\t\t// console.log(data.newPeople)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.log('Error getting people', error)\n\t\t\t})\n\t} else {\n\t\t// console.log('clickedPerson', clickedPerson)\n\t\tchatClicked(clickedPerson, eleData)\n\t\t// console.log(\"Online users here\", atob(onlineUsers));\n\t}\n\n\tdocument.querySelector('#transparent-modal').click()\n}\n\nexport const handleHtmlSend = (msgRes) => {\n\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\tlet date = utcToLocal(msgRes.createdAt)\n\tlet msgDate = date.slice(6)\n\tlet msgTime = date.slice(0, 5)\n\n\tlet dates = Array.from(document.querySelectorAll('.date'))\n\n\tif (dates.length === 0 || dates[dates.length - 1].innerText !== msgDate) {\n\t\tconst dayDiv = document.createElement('div')\n\t\tdayDiv.classList.add('day')\n\t\tconst dateDiv = document.createElement('div')\n\t\tdateDiv.classList.add('date')\n\t\tconst dateh1 = document.createElement('h1')\n\t\tdateh1.textContent = msgDate\n\n\t\tdateDiv.appendChild(dateh1)\n\t\tdayDiv.appendChild(dateDiv)\n\t\tmsgContainerDiv.appendChild(dayDiv)\n\t}\n\n\tlet fromUserMsg = fromUserMsgComponent(msgRes.message, msgRes._id, msgTime)\n\tmsgContainerDiv.appendChild(fromUserMsg)\n\n\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n}\n\nexport const handleSendRequest = async (receiverId, msg) => {\n\tfetch('/chat/send-message', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\treceiverId,\n\t\t\tmessage: msg,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log('data in /chat/send-message', data)\n\t\t\tif (data.message === 'User is blocked') {\n\t\t\t\tlet alert = document.querySelector('.alert')\n\t\t\t\talert.children[1].innerHTML = 'User is blocked'\n\t\t\t\talert.classList.remove('hidden')\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\talert.classList.add('hidden')\n\t\t\t\t}, 5000)\n\t\t\t} else {\n\t\t\t\thandleHtmlSend(data)\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in sending message: ', err)\n\t\t})\n}\n\nexport const deleteMessage = async (msg) => {\n\tlet msgId = msg.dataset.id\n\t// console.log('msgId', msgId)\n\n\tlet receiverId = document.querySelector('.chat-child.active').dataset.id\n\n\tfetch('/chat/delete-message', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\treceiverId,\n\t\t\tmsgId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log(data.message)\n\t\t\tif (data.message === 'Message deleted') {\n\t\t\t\tmsg.remove()\n\t\t\t\tlet days = document.querySelectorAll('.day')\n\t\t\t\tdays.forEach((day) => {\n\t\t\t\t\tif (day.nextElementSibling === null || day.nextElementSibling.classList.contains('day')) {\n\t\t\t\t\t\tday.remove()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tlet alert = document.querySelector('.alert')\n\t\t\t\talert.children[1].textContent = 'Message deleted for both'\n\t\t\t\talert.classList.remove('hidden')\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\talert.classList.add('hidden')\n\t\t\t\t}, 5000)\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in deleting message: ', err)\n\t\t})\n}\n\nexport const deleteConversation = async () => {\n\tlet chat_mid = document.getElementById('all-chats')\n\tlet chat_end = document.getElementById('chats-end')\n\tlet chat_head = document.getElementById('chats-head')\n\tlet blockDiv = document.querySelector('#chats-end-block')\n\n\tlet receiver = document.querySelector('.chat-child.active')\n\tlet receiverId = receiver.dataset.id\n\n\tfetch('/chat/delete-conversation', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\treceiverId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log(data.message)\n\t\t\tif (data.message === 'Conversation deleted') {\n\t\t\t\t// receiver.classList.remove('active')\n\t\t\t\t// receiver.classList.add('hidden')\n\t\t\t\treceiver.remove()\n\t\t\t\tchat_head.classList.add('hidden')\n\t\t\t\tchat_mid.classList.add('hidden')\n\t\t\t\tchat_end.classList.add('hidden')\n\t\t\t\tblockDiv.classList.add('hidden')\n\n\t\t\t\tlet alert = document.querySelector('.alert')\n\t\t\t\talert.children[1].textContent = 'Conversation deleted'\n\t\t\t\talert.classList.remove('hidden')\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\talert.classList.add('hidden')\n\t\t\t\t}, 5000)\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in deleting conversation: ', err)\n\t\t})\n}\n\nexport const handleBlockUser = (receiverId, htmlElement) => {\n\tlet chat_end = document.getElementById('chats-end')\n\tlet blockDiv = document.querySelector('#chats-end-block')\n\n\tfetch('/chat/block-user', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\treceiverId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log(data.message)\n\t\t\tif (data.message === 'User blocked') {\n\t\t\t\thtmlElement.children[0].textContent = 'Unblock'\n\t\t\t\tchat_end.classList.add('hidden')\n\t\t\t\tblockDiv.classList.remove('hidden')\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in blocking user: ', err)\n\t\t})\n}\n\nexport const handleUnblockUser = (receiverId, htmlElement) => {\n\tlet chat_end = document.getElementById('chats-end')\n\tlet blockDiv = document.querySelector('#chats-end-block')\n\n\tfetch('/chat/unblock-user', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\treceiverId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\t// console.log(data.message)\n\t\t\tif (data.message === 'User unblocked') {\n\t\t\t\thtmlElement.children[0].textContent = 'Block'\n\t\t\t\tblockDiv.classList.add('hidden')\n\t\t\t\tchat_end.classList.remove('hidden')\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in unblocking user: ', err)\n\t\t})\n}\n\nexport const blockUnblockUser = async (htmlElement) => {\n\tlet receiver = document.querySelector('.chat-child.active')\n\tlet receiverId = receiver.dataset.id\n\n\tlet blockStatus = htmlElement.children[0].innerText\n\n\tif (blockStatus === 'Block') {\n\t\thandleBlockUser(receiverId, htmlElement)\n\t} else {\n\t\thandleUnblockUser(receiverId, htmlElement)\n\t}\n}\n\n// Refresh access token every 10 minutes\nexport const setIntervalId = setInterval(\n\t() => {\n\t\tfetch('/auth/jwt/refresh-token', {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((data) => {\n\t\t\t\tconsole.log(data)\n\t\t\t\tif (data.error) clearInterval(setIntervalId)\n\t\t\t})\n\t\t\t.catch((error) => console.log(error.message))\n\t},\n\t1000 * 60 * 5 // 5 minutes\n)\n","import 'emoji-picker-element'\n\ndocument.getElementById('emoji-popup-btn').addEventListener('click', () => {\n\tlet emoji_popup_btn = document.getElementById('emoji-popup-btn')\n\tlet emoji_popup = document.getElementById('emoji-popup')\n\n\tif (emoji_popup.classList.contains('hidden')) {\n\t\temoji_popup.classList.remove('hidden')\n\t\temoji_popup_btn.classList.add('active')\n\t} else {\n\t\temoji_popup.classList.add('hidden')\n\t\temoji_popup_btn.classList.remove('active')\n\t}\n})\n\ndocument.addEventListener('click', (event) => {\n\tlet emoji_popup_btn = document.getElementById('emoji-popup-btn')\n\tlet emoji_popup = document.getElementById('emoji-popup')\n\n\tif (!emoji_popup_btn.contains(event.target) && !emoji_popup.contains(event.target)) {\n\t\tif (!emoji_popup.classList.contains('hidden')) {\n\t\t\temoji_popup.classList.add('hidden')\n\t\t\temoji_popup_btn.classList.remove('active')\n\t\t}\n\t}\n})\n\ndocument.querySelector('emoji-picker').addEventListener('emoji-click', (event) => {\n\tdocument.getElementById('msg-input').value += event.detail.unicode\n})\n\n// overlay.addEventListener('click', () => {\n//     emoji_popup.classList.add(\"hidden\");\n//     overlay.classList.add(\"hidden\");\n// })\n","import * as ChatFunctions from './chat.js'\r\nimport * as GroupChatFunctions from './groupChat.js'\r\n\r\nconst addChatPopupInitialState = document.querySelector('#add-chat-popup').innerHTML\r\n\r\n//~ chat.js\r\n\r\ndocument.querySelector('#transparent-modal').addEventListener('click', () => {\r\n\tlet add_people_btn = document.getElementById('add-chat-btn')\r\n\tlet overlay = document.querySelector('#transparent-modal')\r\n\tlet to_user_info_popup = document.getElementById('to-user-info-popup')\r\n\tlet to_user_info_btn = document.getElementById('to-user-info-btn')\r\n\tlet emoji_popup = document.getElementById('emoji-popup')\r\n\tlet showGroupMembersBtn = document.querySelector('#all-group-members-btn')\r\n\r\n\t// close the add user popup\r\n\tlet addChatPopup = document.getElementById('add-chat-popup')\r\n\tif (!addChatPopup.classList.contains('hidden')) {\r\n\t\taddChatPopup.innerHTML = addChatPopupInitialState\r\n\t\tinitializeAddChatPopupEventListeners()\r\n\t\taddChatPopup.classList.add('hidden')\r\n\t}\r\n\r\n\tadd_people_btn.classList.remove('active')\r\n\tto_user_info_btn.classList.remove('active')\r\n\tto_user_info_popup.classList.add('hidden')\r\n\temoji_popup.classList.add('hidden')\r\n\tif (add_people_btn.classList.contains('z-30')) {\r\n\t\tadd_people_btn.classList.remove('z-30')\r\n\t}\r\n\r\n\tshowGroupMembersBtn.parentElement.open ? (showGroupMembersBtn.parentElement.open = false) : null\r\n\r\n\toverlay.classList.add('hidden')\r\n})\r\n\r\ndocument.getElementById('add-chat-btn').addEventListener('click', (event) => {\r\n\t// event.stopPropagation()\r\n\tlet add_people_btn = document.getElementById('add-chat-btn')\r\n\tlet add_people_popup = document.getElementById('add-chat-popup')\r\n\tlet add_people_list = document.querySelector('.all-new-chat-people')\r\n\tlet popup_search = document.getElementById('new-chat-search')\r\n\tlet overlay = document.querySelector('#transparent-modal')\r\n\r\n\t// document.body.style.overflow = \"hidden\";\r\n\tadd_people_btn.classList.toggle('active')\r\n\tadd_people_btn.classList.toggle('z-30')\r\n\r\n\tif (add_people_popup.classList.contains('hidden')) {\r\n\t\tadd_people_popup.classList.remove('hidden')\r\n\t\toverlay.classList.remove('hidden')\r\n\t\tpopup_search.focus()\r\n\t\tadd_people_list.scrollTop = 0\r\n\t} else {\r\n\t\tadd_people_popup.classList.add('hidden')\r\n\t\toverlay.classList.add('hidden')\r\n\t}\r\n})\r\n\r\ndocument.getElementById('to-user-info-btn').addEventListener('click', () => {\r\n\tlet overlay = document.querySelector('#transparent-modal')\r\n\tlet to_user_info_popup = document.getElementById('to-user-info-popup')\r\n\tlet to_user_info_btn = document.getElementById('to-user-info-btn')\r\n\r\n\tif (to_user_info_popup.classList.contains('hidden')) {\r\n\t\tto_user_info_popup.classList.remove('hidden')\r\n\t\toverlay.classList.remove('hidden')\r\n\t\tto_user_info_btn.classList.add('active')\r\n\t} else {\r\n\t\tto_user_info_popup.classList.add('hidden')\r\n\t\toverlay.classList.add('hidden')\r\n\t\tto_user_info_btn.classList.remove('active')\r\n\t}\r\n})\r\n\r\ndocument.getElementById('send-btn').addEventListener('click', (e) => {\r\n\te.preventDefault()\r\n\tlet msgInput = document.getElementById('msg-input')\r\n\r\n\tlet msg = DOMPurify.sanitize(msgInput.value)\r\n\tmsgInput.value = ''\r\n\tmsgInput.focus()\r\n\r\n\tif (msg.length > 0) {\r\n\t\tif (document.querySelector('.chat-child.active')) {\r\n\t\t\tlet receiverId = document.querySelector('.chat-child.active').dataset.id\r\n\t\t\tChatFunctions.handleSendRequest(receiverId, msg)\r\n\t\t} else if (document.querySelector('.group-child.active')) {\r\n\t\t\tlet groupId = document.querySelector('.group-child.active').dataset.id\r\n\t\t\tGroupChatFunctions.handleSendRequestGroup(groupId, msg)\r\n\t\t}\r\n\t}\r\n})\r\n\r\ndocument.getElementById('msg-input').addEventListener('keydown', (event) => {\r\n\tlet msgInput = document.getElementById('msg-input')\r\n\r\n\tif (event.key === 'Enter' && !event.shiftKey) {\r\n\t\tevent.preventDefault()\r\n\r\n\t\tlet msg = DOMPurify.sanitize(msgInput.value)\r\n\t\tmsgInput.value = ''\r\n\t\tmsgInput.focus()\r\n\r\n\t\tif (msg.length > 0) {\r\n\t\t\tif (document.querySelector('.chat-child.active')) {\r\n\t\t\t\tlet receiverId = document.querySelector('.chat-child.active').dataset.id\r\n\t\t\t\tChatFunctions.handleSendRequest(receiverId, msg)\r\n\t\t\t} else if (document.querySelector('.group-child.active')) {\r\n\t\t\t\tlet groupId = document.querySelector('.group-child.active').dataset.id\r\n\t\t\t\tGroupChatFunctions.handleSendRequestGroup(groupId, msg)\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (event.shiftKey && event.key === 'Enter') {\r\n\t\tevent.preventDefault()\r\n\t\tconst start = msgInput.selectionStart\r\n\t\tconst text = msgInput.value\r\n\r\n\t\tmsgInput.value = text.slice(0, start) + '\\n' + text.slice(start)\r\n\t\tmsgInput.selectionEnd = start + 1\r\n\t}\r\n})\r\n\r\ndocument.querySelector('.message-container').addEventListener('click', (event) => {\r\n\t// console.log('event.target', event.target)\r\n\tif (event.target.closest('.delete-msg-btn')) {\r\n\t\tconst deleteMsgBtn = event.target.closest('.delete-msg-btn')\r\n\t\tconst msg = deleteMsgBtn.parentElement\r\n\t\tif (document.querySelector('.chat-child.active')) {\r\n\t\t\tChatFunctions.deleteMessage(msg)\r\n\t\t} else if (document.querySelector('.group-child.active')) {\r\n\t\t\tGroupChatFunctions.deleteGroupMessage(msg)\r\n\t\t}\r\n\t}\r\n})\r\n\r\n// Delete Conversation\r\ndocument.querySelector('#delete-chat-to-user').addEventListener('click', () => {\r\n\tChatFunctions.deleteConversation()\r\n})\r\n\r\n// Block User\r\ndocument.querySelector('#block-to-user').addEventListener('click', () => {\r\n\tChatFunctions.blockUnblockUser(document.querySelector('#block-to-user'))\r\n})\r\n\r\ndocument.querySelector('#from-user-modal-img').addEventListener('click', () => {\r\n\tmy_modal_2.showModal()\r\n})\r\n\r\n// Change profile avatar button\r\ndocument.querySelector('#change-profilePic-btn').addEventListener('click', () => {\r\n\tconst modalProfilePic = document.querySelector('#change-details-profilePic')\r\n\r\n\tfetch('/api/get-avatar')\r\n\t\t.then((res) => res.json())\r\n\t\t.then((data) => {\r\n\t\t\t// console.log(data.avatar)\r\n\t\t\t// console.log(modalProfilePic.src);\r\n\t\t\tmodalProfilePic.src = data.avatar\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.log('Error in getting avatar: ', err)\r\n\t\t})\r\n})\r\n\r\n// Change details button\r\ndocument.querySelector('#chat-change-details-done-btn').addEventListener('click', () => {\r\n\tlet name = DOMPurify.sanitize(document.querySelector('#change-details-name').value)\r\n\tlet username = DOMPurify.sanitize(document.querySelector('#change-details-username').value)\r\n\tconst gender = DOMPurify.sanitize(document.querySelector('#change-details-gender option:checked').value)\r\n\tlet avatar = document.querySelector('#change-details-profilePic').src\r\n\tconst csrfToken = DOMPurify.sanitize(document.querySelector('input[name=\"CSRFToken\"]').value)\r\n\r\n\tfetch('/api/change-details', {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\t'x-csrf-token': csrfToken,\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tname,\r\n\t\t\tusername,\r\n\t\t\tgender,\r\n\t\t\tavatar,\r\n\t\t}),\r\n\t})\r\n\t\t.then((res) => res.json())\r\n\t\t.then((data) => {\r\n\t\t\tif (data.success) {\r\n\t\t\t\tdocument.querySelector('#change-details-name').value = data.user.name\r\n\t\t\t\tdocument.querySelector('#change-details-username').value = data.user.username\r\n\t\t\t\tdocument.querySelector('#from-user-modal-img').src = data.user.avatar\r\n\t\t\t}\r\n\r\n\t\t\tif (data.message === 'Username already taken') {\r\n\t\t\t\tusername.textContent = data.user.username\r\n\t\t\t}\r\n\r\n\t\t\tChatFunctions.showNotification(data.message)\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.log('Error in changing details: ', err)\r\n\t\t\tChatFunctions.showNotification('Error in changing details! Please refresh the page and try again.')\r\n\t\t})\r\n})\r\n\r\n// add the group member to chat\r\ndocument.querySelector('.all-group-members').addEventListener('click', (event) => {\r\n\t// console.log('event.target', event.target)\r\n\t// console.log('event.target.closest', event.target.closest('.group-member'))\r\n\tif (event.target.closest('.group-member')) {\r\n\t\tChatFunctions.addPeopleToChat(event.target.closest('.group-member'))\r\n\t}\r\n})\r\n\r\n//~ groupChat.js\r\n\r\ndocument.querySelector('.chat-parent').addEventListener('click', (event) => {\r\n\tif (event.target.closest('.chat-child')) {\r\n\t\tChatFunctions.chatClicked(event.target.closest('.chat-child'))\r\n\t} else if (event.target.closest('.group-child')) {\r\n\t\tGroupChatFunctions.groupChatClicked(event.target.closest('.group-child'))\r\n\t}\r\n})\r\n\r\n// leave and delete group\r\ndocument.querySelector('#leave-and-delete-group').addEventListener('click', () => {\r\n\tlet groupId = document.querySelector('.group-child.active').dataset.id\r\n\r\n\tfetch('/group-chat-api/leave-and-delete-group', {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tgroupId,\r\n\t\t}),\r\n\t})\r\n\t\t.then((res) => res.json())\r\n\t\t.then((data) => {\r\n\t\t\tif (data.success) {\r\n\t\t\t\tlet groupChild = document.querySelector(`.group-child[data-id=\"${groupId}\"]`)\r\n\t\t\t\tgroupChild.remove()\r\n\r\n\t\t\t\tdocument.querySelector('#transparent-modal').click()\r\n\r\n\t\t\t\tlet chat_head = document.getElementById('chats-head')\r\n\t\t\t\tlet chat_mid = document.getElementById('all-chats')\r\n\t\t\t\tlet chat_end = document.getElementById('chats-end')\r\n\r\n\t\t\t\tchat_head.classList.add('hidden')\r\n\t\t\t\tchat_mid.classList.add('hidden')\r\n\t\t\t\tchat_end.classList.add('hidden')\r\n\r\n\t\t\t\tlet alert = document.querySelector('.alert')\r\n\t\t\t\talert.children[1].textContent = 'Group left and deleted'\r\n\t\t\t\talert.classList.remove('hidden')\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\talert.classList.add('hidden')\r\n\t\t\t\t}, 5000)\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.log('Error in leaving and deleting group: ', err)\r\n\t\t})\r\n})\r\n\r\n// show all group members\r\ndocument.querySelector('#all-group-members-btn').addEventListener('click', () => {\r\n\tlet dropdown = document.querySelector('#all-group-members-btn').parentElement\r\n\tif (dropdown.open) {\r\n\t\treturn\r\n\t}\r\n\r\n\tlet groupId = document.querySelector('.group-child.active').dataset.id\r\n\r\n\tfetch('/group-chat-api/get-group-members', {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tgroupId,\r\n\t\t}),\r\n\t})\r\n\t\t.then((res) => res.json())\r\n\t\t.then((data) => {\r\n\t\t\tif (data.success) {\r\n\t\t\t\tlet groupMembers = data.groupMembers\r\n\t\t\t\tlet groupMembersParent = document.querySelector('.all-group-members')\r\n\t\t\t\tgroupMembersParent.textContent = ''\r\n\t\t\t\tlet noOfMembers = groupMembers.length\r\n\t\t\t\tlet noOfMembersDiv = groupMembersParent.previousElementSibling.querySelector('span')\r\n\t\t\t\tnoOfMembersDiv.textContent = noOfMembers\r\n\t\t\t\tgroupMembers.forEach((member) => {\r\n\t\t\t\t\tlet groupMember = GroupChatFunctions.groupMemberComponent(member)\r\n\t\t\t\t\tgroupMembersParent.appendChild(groupMember)\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tlet alert = document.querySelector('.alert')\r\n\t\t\t\tlet alertText = alert.querySelector('span')\r\n\t\t\t\talertText.textContent = 'Error in getting group members. Try refreshing the page.'\r\n\t\t\t\talert.classList.remove('hidden')\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\talert.classList.add('hidden')\r\n\t\t\t\t\talertText.textContent = ''\r\n\t\t\t\t}, 5000)\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.log('Error in getting group members: ', err)\r\n\t\t})\r\n})\r\n\r\n// handle copy group link\r\ndocument.querySelector('#copy-group-link-btn').addEventListener('click', () => {\r\n\tlet copyLinkBtn = document.querySelector('#copy-group-link-btn')\r\n\tcopyLinkBtn.dataset.tip = 'Copied'\r\n\tlet currentGroupId = document.querySelector('.group-child.active').dataset.id\r\n\tnavigator.clipboard.writeText(\r\n\t\t`${process.env.DOMAIN}/group-chat-api/join-group-via-link?id=${encodeURIComponent(currentGroupId)}`\r\n\t)\r\n\r\n\tsetTimeout(() => {\r\n\t\tcopyLinkBtn.dataset.tip = 'Copy Group Link'\r\n\t}, 2000)\r\n})\r\n\r\n//~ Add chat popup event listeners\r\nconst initializeAddChatPopupEventListeners = () => {\r\n\t// change tabs in add user popup\r\n\tdocument.querySelector('#new-chat-tab').addEventListener('click', () => {\r\n\t\tlet newChatTab = document.querySelector('#new-chat-tab')\r\n\t\tlet newGroupTab = document.querySelector('#new-group-tab')\r\n\t\tlet newChatTabContent = document.querySelector('.new-chat-tab-content')\r\n\t\tlet newGroupTabContent = document.querySelector('.new-group-tab-content-parent')\r\n\r\n\t\tnewChatTab.classList.contains('tab-active') ? null : newChatTab.classList.add('tab-active')\r\n\t\tnewGroupTab.classList.contains('tab-active') ? newGroupTab.classList.remove('tab-active') : null\r\n\r\n\t\tnewChatTabContent.classList.contains('hidden') ? newChatTabContent.classList.remove('hidden') : null\r\n\t\tnewGroupTabContent.classList.contains('hidden') ? null : newGroupTabContent.classList.add('hidden')\r\n\t})\r\n\r\n\tdocument.querySelector('#new-group-tab').addEventListener('click', () => {\r\n\t\tlet newChatTab = document.querySelector('#new-chat-tab')\r\n\t\tlet newGroupTab = document.querySelector('#new-group-tab')\r\n\t\tlet newChatTabContent = document.querySelector('.new-chat-tab-content')\r\n\t\tlet newGroupTabContent = document.querySelector('.new-group-tab-content-parent')\r\n\r\n\t\tnewChatTab.classList.contains('tab-active') ? newChatTab.classList.remove('tab-active') : null\r\n\t\tnewGroupTab.classList.contains('tab-active') ? null : newGroupTab.classList.add('tab-active')\r\n\r\n\t\tnewChatTabContent.classList.contains('hidden') ? null : newChatTabContent.classList.add('hidden')\r\n\t\tnewGroupTabContent.classList.contains('hidden') ? newGroupTabContent.classList.remove('hidden') : null\r\n\t})\r\n\r\n\t// Search people for chat\r\n\tdocument.getElementById('new-chat-search').addEventListener('keyup', async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\ttry {\r\n\t\t\tconst queryText = event.target.value.toLowerCase()\r\n\t\t\tconst popupPeople = document.querySelectorAll('.new-chat-people')\r\n\t\t\tif (queryText === '') {\r\n\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\tperson.classList.contains('hidden') ? person.classList.remove('hidden') : null\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tconst data = await GroupChatFunctions.searchPeople(queryText)\r\n\t\t\t\tif (data.people.length === 0) {\r\n\t\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\t\tperson.classList.contains('hidden') ? null : person.classList.add('hidden')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst foundPeopleUsernames = data.people.map((person) => person.username)\r\n\t\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\t\tconst personUsername = person.querySelector('.new-chat-people-username').innerText.trim()\r\n\t\t\t\t\t\tif (foundPeopleUsernames.includes(personUsername)) {\r\n\t\t\t\t\t\t\tperson.classList.remove('hidden')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tperson.classList.add('hidden')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Error in searching people: ', error)\r\n\t\t}\r\n\t})\r\n\r\n\t// add the selected people to chat\r\n\tdocument.querySelector('.all-new-chat-people').addEventListener('click', (event) => {\r\n\t\tif (event.target.closest('.new-chat-people')) {\r\n\t\t\tChatFunctions.addPeopleToChat(event.target.closest('.new-chat-people'))\r\n\t\t}\r\n\t})\r\n\r\n\t// scroll selected people horizontally\r\n\tdocument.querySelector('.new-group-selected-people').addEventListener(\r\n\t\t'wheel',\r\n\t\t(event) => {\r\n\t\t\tlet selectedPeople = document.querySelector('.new-group-selected-people')\r\n\t\t\tselectedPeople.scrollLeft += event.deltaY\r\n\t\t},\r\n\t\t{ passive: true }\r\n\t)\r\n\r\n\t// Done button for creating group\r\n\tdocument.querySelector('#new-group-done-btn').addEventListener('click', () => {\r\n\t\tdocument.querySelector('.create-group-tab-content').classList.remove('hidden')\r\n\t\tdocument.querySelector('.new-group-tab-content').classList.add('hidden')\r\n\t})\r\n\r\n\t// Search people for group\r\n\tdocument.getElementById('new-group-search').addEventListener('keyup', async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\ttry {\r\n\t\t\tconst queryText = event.target.value.toLowerCase()\r\n\t\t\tconst popupPeople = document.querySelectorAll('.new-group-people')\r\n\t\t\tif (queryText === '') {\r\n\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\tperson.classList.contains('hidden') ? person.classList.remove('hidden') : null\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tconst data = await GroupChatFunctions.searchPeople(queryText)\r\n\t\t\t\tif (data.people.length === 0) {\r\n\t\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\t\tperson.classList.contains('hidden') ? null : person.classList.add('hidden')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst foundPeopleUsernames = data.people.map((person) => person.username)\r\n\t\t\t\t\tpopupPeople.forEach((person) => {\r\n\t\t\t\t\t\tconst personUsername = person.querySelector('.new-group-people-username').innerText.trim()\r\n\t\t\t\t\t\tif (foundPeopleUsernames.includes(personUsername)) {\r\n\t\t\t\t\t\t\tperson.classList.remove('hidden')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tperson.classList.add('hidden')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log('Error in searching people: ', error)\r\n\t\t}\r\n\t})\r\n\r\n\t// show selected people for group chat\r\n\tdocument.querySelector('.all-new-group-people').addEventListener('click', (event) => {\r\n\t\tif (event.target.classList.contains('all-new-group-people')) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tlet checkBox = null\r\n\t\tlet selectedPeopleParent = document.querySelector('.new-group-selected-people-parent')\r\n\t\tlet selectedPeople = document.querySelector('.new-group-selected-people')\r\n\t\tlet selectedPerson = event.target.closest('.new-group-people')\r\n\t\t// console.log(event.target)\r\n\r\n\t\tif (event.target.closest('.new-group-people')) {\r\n\t\t\t// Toggle the checkbox\r\n\t\t\tcheckBox = event.target.closest('.new-group-people').querySelector('.new-group-people-checkbox input')\r\n\t\t\tif (checkBox) {\r\n\t\t\t\tif (checkBox !== event.target) {\r\n\t\t\t\t\tcheckBox.checked = !checkBox.checked\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (checkBox && checkBox.checked) {\r\n\t\t\tselectedPeopleParent.classList.contains('hidden') ? selectedPeopleParent.classList.remove('hidden') : null\r\n\t\t\tdocument.querySelector('.all-new-group-people').classList.replace('h-64', 'h-46')\r\n\t\t\t// Create selected person\r\n\t\t\tlet selectedPersonDiv = document.createElement('div')\r\n\t\t\tselectedPersonDiv.classList.add('avatar')\r\n\t\t\tselectedPersonDiv.dataset.id = selectedPerson.dataset.id\r\n\t\t\tlet selectedPersonInnerDiv = document.createElement('div')\r\n\t\t\tselectedPersonInnerDiv.classList.add('w-14', 'h-14', 'rounded-full')\r\n\t\t\tlet selectedPersonImg = document.createElement('img')\r\n\t\t\tselectedPersonImg.src = selectedPerson.querySelector('img').src\r\n\t\t\tselectedPersonImg.alt = selectedPerson.querySelector('img').alt\r\n\r\n\t\t\tselectedPersonInnerDiv.appendChild(selectedPersonImg)\r\n\t\t\tselectedPersonDiv.appendChild(selectedPersonInnerDiv)\r\n\t\t\tselectedPeople.appendChild(selectedPersonDiv)\r\n\t\t} else {\r\n\t\t\tlet selectedAllPeople = selectedPeople.children\r\n\t\t\tfor (let person of selectedAllPeople) {\r\n\t\t\t\t// console.log('person', person.querySelector('img').alt)\r\n\t\t\t\t// console.log('selectedPerson', selectedPerson.querySelector('img').alt)\r\n\t\t\t\tif (person.querySelector('img').alt === selectedPerson.querySelector('img').alt) {\r\n\t\t\t\t\tperson.remove()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (selectedPeople.children.length === 0) {\r\n\t\t\t\tselectedPeopleParent.classList.contains('hidden') ? null : selectedPeopleParent.classList.add('hidden')\r\n\t\t\t\tdocument.querySelector('.all-new-group-people').classList.replace('h-46', 'h-64')\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\t// Change group avatar button\r\n\tdocument.querySelector('#change-group-avatar-btn').addEventListener('click', () => {\r\n\t\tlet groupAvatar = document.querySelector('#group-avatar')\r\n\r\n\t\tfetch('/api/get-group-avatar')\r\n\t\t\t.then((res) => res.json())\r\n\t\t\t.then((data) => {\r\n\t\t\t\t// console.log(data)\r\n\t\t\t\tgroupAvatar.src = data.groupAvatar\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log('Error in getting group avatar: ', err)\r\n\t\t\t})\r\n\t})\r\n\r\n\t// Back button for creating group\r\n\tdocument.querySelector('#group-back-btn').addEventListener('click', () => {\r\n\t\tdocument.querySelector('.create-group-tab-content').classList.add('hidden')\r\n\t\tdocument.querySelector('.new-group-tab-content').classList.remove('hidden')\r\n\t})\r\n\r\n\t// Create group button\r\n\tdocument.querySelector('#group-create-btn').addEventListener('click', async () => {\r\n\t\t// collect the data\r\n\t\tlet groupMembersIds = Array.from(document.querySelector('.new-group-selected-people').children).map(\r\n\t\t\t(member) => member.dataset.id\r\n\t\t)\r\n\t\tlet groupName = DOMPurify.sanitize(document.querySelector('#group-name').value)\r\n\t\tlet groupDescription = DOMPurify.sanitize(document.querySelector('#group-description').value)\r\n\t\tlet groupAvatar = document.querySelector('#group-avatar').src\r\n\r\n\t\tif (groupName === '' || groupDescription === '') {\r\n\t\t\tChatFunctions.showNotification('Group name and description are required')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tawait fetch('/group-chat-api/create-group', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tgroupMembersIds,\r\n\t\t\t\tgroupName,\r\n\t\t\t\tgroupDescription,\r\n\t\t\t\tgroupAvatar,\r\n\t\t\t}),\r\n\t\t})\r\n\t\t\t.then((res) => res.json())\r\n\t\t\t.then((data) => {\r\n\t\t\t\t// console.log(data)\r\n\t\t\t\tif (data.success) {\r\n\t\t\t\t\tChatFunctions.showNotification('Group created successfully')\r\n\r\n\t\t\t\t\t// clean the form\r\n\t\t\t\t\tdocument.querySelector('#add-chat-popup').innerHTML = addChatPopupInitialState\r\n\r\n\t\t\t\t\t// close the popup\r\n\t\t\t\t\tdocument.querySelector('#transparent-modal').click()\r\n\r\n\t\t\t\t\tGroupChatFunctions.createLeftsideGroup(data.groupInfo)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tChatFunctions.showNotification('Error in creating group. Please try again!')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log('Error in creating group: ', err)\r\n\t\t\t\tChatFunctions.showNotification('Error in creating group. Please refresh the page and try again!')\r\n\t\t\t})\r\n\t})\r\n}\r\n\r\ninitializeAddChatPopupEventListeners()\r\n","import { utcToLocal } from './chat.js'\n\n// search people function\nexport const searchPeople = async (queryText) => {\n\tif (queryText === '') {\n\t\treturn null\n\t} else {\n\t\tlet result = await fetch('/search/search-people', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: JSON.stringify({ queryText }),\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((data) => {\n\t\t\t\treturn data\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log('Error in searching people: ', err)\n\t\t\t})\n\t\treturn result\n\t}\n}\n\n// create left side group\nexport const createLeftsideGroup = (data, clicked = true) => {\n\tlet groupChats = document.querySelector('.group-chats')\n\tgroupChats.open ? null : (groupChats.open = true)\n\n\t// console.log('data', data)\n\tlet parentDiv = document.createElement('div')\n\tparentDiv.classList.add('group-child', 'group')\n\tparentDiv.dataset.id = data.groupId\n\n\tlet avatarDiv = document.createElement('div')\n\tavatarDiv.classList.add('avatar')\n\n\tlet imgDiv = document.createElement('div')\n\timgDiv.classList.add('group-img')\n\n\tlet img = document.createElement('img')\n\timg.draggable = false\n\timg.src = data.groupAvatar\n\t\t? data.groupAvatar\n\t\t: `https://avatar.iran.liara.run/username?username=${data.groupName.replace(/ /g, '+')}`\n\timg.alt = data.groupName\n\n\timgDiv.appendChild(img)\n\tavatarDiv.appendChild(imgDiv)\n\tparentDiv.appendChild(avatarDiv)\n\n\tlet nameDiv = document.createElement('div')\n\tnameDiv.classList.add('group-name-parent')\n\n\tlet name = document.createElement('h4')\n\tname.classList.add('group-name')\n\tname.textContent = data.groupName\n\n\tlet username = document.createElement('h4')\n\tusername.classList.add('group-description')\n\tusername.textContent = data.groupDescription\n\n\tnameDiv.appendChild(name)\n\tnameDiv.appendChild(username)\n\tparentDiv.appendChild(nameDiv)\n\n\tlet badgeDiv = `\n\t<div class=\"unread-badge right-8 hidden\">\n        <div class=\"badge bg-secondary text-white\">0</div>\n    </div>`\n\n\tparentDiv.innerHTML += DOMPurify.sanitize(badgeDiv)\n\n\tlet allGroupChats = document.querySelector('.group-chats')\n\tallGroupChats.appendChild(parentDiv)\n\n\tif (clicked) {\n\t\tgroupChatClicked(parentDiv, data)\n\t}\n\n\treturn parentDiv\n}\n\n// Group chat clicked\nexport const groupChatClicked = (htmlElement, ...args) => {\n\t// console.log('htmlElement', htmlElement)\n\n\t// remove active class from previous chat\n\tdocument.querySelector('.chat-child.active')\n\t\t? document.querySelector('.chat-child.active').classList.remove('active')\n\t\t: null\n\tdocument.querySelector('.group-child.active')\n\t\t? document.querySelector('.group-child.active').classList.remove('active')\n\t\t: null\n\thtmlElement.classList.add('active')\n\n\t// reset unread status\n\tlet unreadElement = htmlElement.children[2]\n\tunreadElement.children[0].textContent = 0\n\tunreadElement.classList.contains('hidden') ? null : unreadElement.classList.add('hidden')\n\n\tlet clickedGroupId = htmlElement.dataset.id\n\tlet clickedGroup = {}\n\n\tif (args[0] && args[0].groupId === clickedGroupId) {\n\t\tclickedGroup = args[0]\n\t} else {\n\t\tclickedGroup = {\n\t\t\tgroupId: clickedGroupId,\n\t\t\tgroupName: htmlElement.querySelector('.group-name').innerText,\n\t\t\tgroupDescription: htmlElement.querySelector('.group-description').innerText,\n\t\t\tgroupAvatar: htmlElement.querySelector('.group-img img').src,\n\t\t}\n\t}\n\n\thandleGroupChatHeadAndEnd(clickedGroup)\n\thandleGroupChat(clickedGroup)\n}\n\nexport const handleGroupChatHeadAndEnd = (clickedGroup) => {\n\tlet chat_head = document.getElementById('chats-head')\n\tlet chat_mid = document.getElementById('all-chats')\n\tlet chat_end = document.getElementById('chats-end')\n\tlet chat_head_name = document.getElementById('chat-head-name')\n\tlet chat_head_img = document.getElementById('chat-head-img')\n\tlet to_user_info_popup = document.getElementById('to-user-info-popup')\n\n\tchat_head.classList.contains('hidden') ? chat_head.classList.remove('hidden') : null\n\tchat_mid.classList.contains('hidden') ? chat_mid.classList.remove('hidden') : null\n\tchat_end.classList.contains('hidden') ? chat_end.classList.remove('hidden') : null\n\n\tchat_head_name.textContent = clickedGroup.groupName\n\tchat_head_img.src = clickedGroup.groupAvatar\n\tto_user_info_popup.querySelector('#to-user-info-popup-name').textContent = clickedGroup.groupName\n\tto_user_info_popup.querySelector('#to-user-info-popup-username').textContent = clickedGroup.groupDescription\n\tto_user_info_popup.querySelector('#to-user-info-popup-img').src = clickedGroup.groupAvatar\n\t\t? clickedGroup.groupAvatar\n\t\t: `https://avatar.iran.liara.run/username?username=${clickedUser.groupName.replace(/ /g, '+')}`\n\n\tchat_head.querySelector('.avatar').classList.contains('online')\n\t\t? chat_head.querySelector('.avatar').classList.remove('online')\n\t\t: null\n\n\tlet toUserInfoPopupOptions = document.querySelector('.to-user-info-popup-options')\n\ttoUserInfoPopupOptions.classList.contains('hidden') ? null : toUserInfoPopupOptions.classList.add('hidden')\n\n\tlet groupInfoPopupOptions = document.querySelector('.group-info-popup-options')\n\tgroupInfoPopupOptions.classList.contains('hidden') ? groupInfoPopupOptions.classList.remove('hidden') : null\n\n\t// show copy grp link btn\n\tlet copyBtn = document.querySelector('#copy-group-link-btn')\n\tcopyBtn.classList.contains('hidden') ? copyBtn.classList.remove('hidden') : null\n}\n\n// send fetch request to get group conversation\nexport const handleGroupChat = (clickedGroup) => {\n\tlet chatSection = document.querySelector('.chat-section')\n\tchatSection.classList.contains('hidden') ? chatSection.classList.remove('hidden') : null\n\n\tlet toUserProfileSecImg = document.querySelector('.to-user-profile-sec-img img')\n\ttoUserProfileSecImg.src = clickedGroup.groupAvatar\n\t\t? clickedGroup.groupAvatar\n\t\t: `https://avatar.iran.liara.run/username?username=${clickedGroup.groupName.replace(/ /g, '+')}`\n\n\tlet _groupName = document.querySelector('.to-user-profile-sec-name h1')\n\tlet _groupDescription = document.querySelector('.to-user-profile-sec-name h3')\n\t_groupName.textContent = clickedGroup.groupName\n\t_groupDescription.textContent = clickedGroup.groupDescription\n\t_groupDescription.parentElement.dataset.tip = clickedGroup.groupDescription\n\n\t// fetch conversation msgs\n\tfetch('/group-chat-api/get-group-conversation', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tgroupId: clickedGroup.groupId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((groupData) => {\n\t\t\thandleHtmlGroupConversation(groupData)\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in getting conversation: ', err)\n\t\t})\n}\n\n// show the group conversation\nexport const handleHtmlGroupConversation = (groupData) => {\n\tlet { requesterId, groupMessages } = groupData\n\n\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\tif (groupMessages.length === 0) {\n\t\tmsgContainerDiv.textContent = ''\n\t\treturn\n\t} else {\n\t\tmsgContainerDiv.textContent = ''\n\t\tlet date = ''\n\t\tgroupMessages = groupMessages.filter((msg) => msg !== null)\n\t\tgroupMessages.forEach((msg) => {\n\t\t\t// create date\n\t\t\tlet msgDate = utcToLocal(msg.createdAt).slice(6)\n\t\t\tlet msgTime = utcToLocal(msg.createdAt).slice(0, 5)\n\t\t\tif (msgDate !== date) {\n\t\t\t\tdate = msgDate\n\t\t\t\tlet dayDiv = document.createElement('div')\n\t\t\t\tdayDiv.classList.add('day')\n\t\t\t\tlet dateDiv = document.createElement('div')\n\t\t\t\tdateDiv.classList.add('date')\n\t\t\t\tlet dateh1 = document.createElement('h1')\n\t\t\t\tdateh1.textContent = msgDate\n\n\t\t\t\tdateDiv.appendChild(dateh1)\n\t\t\t\tdayDiv.appendChild(dateDiv)\n\t\t\t\tmsgContainerDiv.appendChild(dayDiv)\n\t\t\t}\n\n\t\t\t// message here\n\t\t\tif (msg.senderId === requesterId) {\n\t\t\t\tlet fromUserGroupMsg = fromUserGroupMsgComponent(msg.message, msg._id, msgTime, msg.senderName)\n\t\t\t\tmsgContainerDiv.appendChild(fromUserGroupMsg)\n\t\t\t} else {\n\t\t\t\tlet toUserGroupMsg = toUserGroupMsgComponent(msg.message, msg._id, msgTime, msg.senderName)\n\n\t\t\t\tmsgContainerDiv.appendChild(toUserGroupMsg)\n\t\t\t}\n\t\t})\n\t\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n\t}\n}\n\nexport const fromUserGroupMsgComponent = (msg, msgId, time, name) => {\n\tlet component = document.createElement('div')\n\tcomponent.classList.add('from-user-msg')\n\tcomponent.dataset.id = msgId\n\tcomponent.innerHTML = `\n        <div class=\"delete-msg-btn hidden pr-2\">\n            <button class=\"btn btn-circle btn-outline border-neutral bg-neutral hover:bg-accent hover:border-accent h-6 w-6 min-h-4 group\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" class=\"h-4 w-4 stroke-accent group-hover:stroke-neutral\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M6 18L18 6M6 6l12 12\" stroke-width=\"2\" stroke-linejoin=\"round\" stroke-linecap=\"round\"></path>\n                </svg>\n            </button>\n        </div>\n        <div id=\"from-user-msg-container\" class=\"msg-container\">\n            <div class=\"flex items-center space-x-2 rtl:space-x-reverse\">\n                <h3 class=\"msg-sender-name text-base font-medium text-black\">${name}</h3>\n                <h4 class=\"msg-sending-time text-sm font-normal text-black\">${time}</h4>\n            </div>\n            <p class=\"msg-content py-1 text-base font-semibold text-black whitespace-pre-wrap\">${msg}</p>\n        </div>\n    `\n\n\treturn component\n}\n\nexport const toUserGroupMsgComponent = (msg, msgId, time, name) => {\n\tlet component = document.createElement('div')\n\tcomponent.classList.add('to-user-msg')\n\tcomponent.dataset.id = msgId\n\tcomponent.innerHTML = `\n        <div id=\"to-user-msg-container\" class=\"msg-container\">\n            <div class=\"flex items-center space-x-2 rtl:space-x-reverse\">\n                <h3 class=\"msg-sender-name text-base font-medium text-black\">${name}</h3>\n                <h4 class=\"msg-sending-time text-sm font-normal text-black\">${time}</h4>\n            </div>\n            <p class=\"msg-content py-2.5 text-base font-semibold text-black whitespace-pre-wrap\">${msg}</p>\n        </div>\n    `\n\treturn component\n}\n\n// send group message\nexport const handleSendRequestGroup = (groupId, msg) => {\n\tfetch('/group-chat-api/send-group-message', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tgroupId,\n\t\t\tmsg,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\tconst { _id, message, createdAt } = data.msgInfo\n\n\t\t\tlet senderName = document.querySelector('#change-details-name').value\n\n\t\t\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\t\t\tlet date = utcToLocal(createdAt)\n\t\t\tlet msgDate = date.slice(6)\n\t\t\tlet msgTime = date.slice(0, 5)\n\n\t\t\tlet dates = Array.from(document.querySelectorAll('.date'))\n\n\t\t\tif (dates.length === 0 || dates[dates.length - 1].innerText !== msgDate) {\n\t\t\t\tconst dayDiv = document.createElement('div')\n\t\t\t\tdayDiv.classList.add('day')\n\t\t\t\tconst dateDiv = document.createElement('div')\n\t\t\t\tdateDiv.classList.add('date')\n\t\t\t\tconst dateh1 = document.createElement('h1')\n\t\t\t\tdateh1.textContent = msgDate\n\n\t\t\t\tdateDiv.appendChild(dateh1)\n\t\t\t\tdayDiv.appendChild(dateDiv)\n\t\t\t\tmsgContainerDiv.appendChild(dayDiv)\n\t\t\t}\n\n\t\t\tlet fromUserGroupMsg = fromUserGroupMsgComponent(message, _id, msgTime, senderName)\n\n\t\t\tmsgContainerDiv.appendChild(fromUserGroupMsg)\n\n\t\t\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n\t\t})\n}\n\n// delete group message\nexport const deleteGroupMessage = (msg) => {\n\tlet msgId = msg.dataset.id\n\tlet groupId = document.querySelector('.group-child.active').dataset.id\n\n\tfetch('/group-chat-api/delete-group-message', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tgroupId,\n\t\t\tmsgId,\n\t\t}),\n\t})\n\t\t.then((res) => res.json())\n\t\t.then((data) => {\n\t\t\tif (data.success) {\n\t\t\t\tmsg.remove()\n\t\t\t\tlet days = document.querySelectorAll('.day')\n\t\t\t\tdays.forEach((day) => {\n\t\t\t\t\tif (day.nextElementSibling === null || day.nextElementSibling.classList.contains('day')) {\n\t\t\t\t\t\tday.remove()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tlet alert = document.querySelector('.alert')\n\t\t\t\talert.children[1].textContent = 'Message deleted for both'\n\t\t\t\talert.classList.remove('hidden')\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\talert.classList.add('hidden')\n\t\t\t\t}, 5000)\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log('Error in deleting group message: ', err)\n\t\t})\n}\n\n// group member component\nexport const groupMemberComponent = (member) => {\n\tlet component = document.createElement('div')\n\tcomponent.classList.add('group-member', 'group')\n\tcomponent.dataset.id = member.encryptedId\n\tcomponent.innerHTML = `\n        <img draggable=\"false\" class=\"group-member-avatar h-10 w-10 rounded-full\" src=\"${member.avatar}\" alt=\"${member.username}\" />\n        <div class=\"group-memeber-name-parent w-4/5 pl-2\">\n            <h3 \n                class=\"group-member-name overflow-hidden text-ellipsis whitespace-nowrap pl-2 text-sm font-semibold text-white group-hover:text-black\"\n            >\n                ${member.name}\n            </h3>\n            <h4\n                class=\"group-member-username overflow-hidden text-ellipsis whitespace-nowrap pl-2 text-xs font-medium text-white group-hover:text-black\"\n            >\n                ${member.username}\n            </h4>\n        </div>\n    `\n\n\treturn component\n}\n","import io from 'socket.io-client'\nimport { toUserMsgComponent, leftSidePersonComponent, utcToLocal, showNotification } from '../components/chat.js'\nimport { toUserGroupMsgComponent, createLeftsideGroup } from '../components/groupChat.js'\n\n// show the message in the chat section\nconst handleHtmlGet = (message) => {\n\tlet date = utcToLocal(message.createdAt)\n\tlet msgDate = date.slice(6)\n\tlet msgTime = date.slice(0, 5)\n\n\tlet dates = Array.from(document.querySelectorAll('.date'))\n\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\tif (dates.length === 0 || dates[dates.length - 1].textContent !== msgDate) {\n\t\tconst dayDiv = document.createElement('div')\n\t\tdayDiv.classList.add('day')\n\t\tconst dateDiv = document.createElement('div')\n\t\tdateDiv.classList.add('date')\n\t\tconst dateh1 = document.createElement('h1')\n\t\tdateh1.textContent = msgDate\n\n\t\tdateDiv.appendChild(dateh1)\n\t\tdayDiv.appendChild(dateDiv)\n\t\tmsgContainerDiv.appendChild(dayDiv)\n\t}\n\n\tlet toUserMsg = toUserMsgComponent(message.message, message._id, msgTime)\n\n\tmsgContainerDiv.appendChild(toUserMsg)\n\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n}\n\n// update the online users status in the left side chat list\nconst handleHtmlOnlineUsers = (users) => {\n\tconst leftPeople = document.querySelectorAll('.chat-child')\n\tleftPeople.forEach(async (person) => {\n\t\tlet personUsername = person.querySelector('.chat-username').innerText\n\t\tlet status = person.querySelector('.avatar')\n\n\t\tif (users && users.includes(personUsername)) {\n\t\t\tstatus.classList.contains('online') ? null : status.classList.add('online')\n\t\t\tif (person.classList.contains('active')) {\n\t\t\t\tlet chat_head = document.querySelector('.chats-head')\n\t\t\t\tlet chat_head_status = chat_head.querySelector('.avatar')\n\t\t\t\tchat_head_status.classList.contains('online') ? null : chat_head_status.classList.add('online')\n\t\t\t}\n\t\t} else {\n\t\t\tstatus.classList.contains('online') ? status.classList.remove('online') : null\n\t\t}\n\t})\n}\n\n// create the left side chat list for the new user\nconst createLeftsidePeopleR = (data) => {\n\tlet parentDiv = leftSidePersonComponent(data)\n\n\tlet allPrivateChats = document.querySelector('.private-chats')\n\tallPrivateChats.appendChild(parentDiv)\n\treturn parentDiv\n}\n\nconst socket = io(process.env.DOMAIN, {\n\twithCredentials: true,\n})\n\nlet onlineUsers = []\n\n// listen for online users\nsocket.on('getOnlineUsers', (users) => {\n\tonlineUsers = users\n\thandleHtmlOnlineUsers(users)\n})\n\n// listen for new message\nsocket.on('newMessage', async (message, senderUsername, callback) => {\n\tlet sender = ''\n\n\t// Find Sender in the active chat\n\tlet leftPeople = document.querySelectorAll('.chat-child')\n\tleftPeople.forEach((person) => {\n\t\tlet personUsername = person.querySelector('.chat-username').innerText\n\t\tif (personUsername === senderUsername) {\n\t\t\tsender = person\n\t\t}\n\t})\n\n\t// Find Sender in the people popup\n\tif (sender === '') {\n\t\tlet popupPeople = document.querySelectorAll('.new-chat-people')\n\t\tpopupPeople.forEach((person) => {\n\t\t\tlet personUsername = person.querySelector('.new-chat-people-username').innerText.trim()\n\n\t\t\tif (personUsername === senderUsername) {\n\t\t\t\tlet personName = person.querySelector('.new-chat-people-name').innerText\n\t\t\t\tlet personAvatar = person.querySelector('.new-chat-people-avatar').src\n\t\t\t\tlet personId = person.dataset.id\n\t\t\t\tsender = {\n\t\t\t\t\tname: personName,\n\t\t\t\t\tusername: personUsername,\n\t\t\t\t\tavatar: personAvatar,\n\t\t\t\t\tencryptedId: personId,\n\t\t\t\t\tisOnline: true,\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tif (sender === '') {\n\t\t\t// console.log('Sender not found', senderUsername)\n\t\t\tcallback({\n\t\t\t\tstatus: 'failure',\n\t\t\t\terror: 'Sender not found',\n\t\t\t})\n\t\t\treturn\n\t\t} else {\n\t\t\tsender = createLeftsidePeopleR(sender)\n\t\t}\n\t}\n\n\tif (sender.classList.contains('active')) {\n\t\thandleHtmlGet(message)\n\t\tcallback({\n\t\t\tstatus: 'success',\n\t\t})\n\t} else {\n\t\tlet unreadMsg = sender.children[2]\n\n\t\tlet unreadMsgCount = parseInt(unreadMsg.innerText) + 1\n\t\tunreadMsg.children[0].textContent = unreadMsgCount\n\t\tunreadMsg.classList.remove('hidden')\n\n\t\tif (unreadMsgCount === 1) {\n\t\t\tshowNotification(`You have a new message from \"${senderUsername}\"`)\n\t\t} else {\n\t\t\tshowNotification(`You have ${unreadMsgCount} new messages from \"${senderUsername}\"`)\n\t\t}\n\n\t\tcallback({\n\t\t\tstatus: 'unread',\n\t\t})\n\t}\n})\n\n// listen for deleted message\nsocket.on('deleteMessage', (dltMsgId, senderUsername) => {\n\t// console.log(\"Deleted message\", dltMsgId);\n\tlet activePerson = document.querySelector('.chat-child.active')\n\n\tif (activePerson) {\n\t\tlet personUnsername = activePerson.querySelector('.chat-username').innerText\n\n\t\tif (personUnsername === senderUsername) {\n\t\t\tlet allToUserMsg = document.querySelectorAll('.to-user-msg')\n\t\t\tallToUserMsg.forEach((msg) => {\n\t\t\t\tlet msgId = msg.dataset.id\n\t\t\t\t// console.log('msgId', msgId, 'dltMsgId', dltMsgId)\n\t\t\t\tif (msgId === dltMsgId) {\n\t\t\t\t\tmsg.remove()\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlet allFromuserMsg = document.querySelectorAll('.from-user-msg')\n\t\t\tallFromuserMsg.forEach((msg) => {\n\t\t\t\tlet msgId = msg.dataset.id\n\t\t\t\t// console.log('msgId', msgId, 'dltMsgId', dltMsgId)\n\t\t\t\tif (msgId === dltMsgId) {\n\t\t\t\t\tmsg.remove()\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlet days = document.querySelectorAll('.day')\n\t\t\tdays.forEach((day) => {\n\t\t\t\tif (day.nextElementSibling === null || day.nextElementSibling.classList.contains('day')) {\n\t\t\t\t\tday.remove()\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t} else {\n\t\tlet leftPeople = document.querySelectorAll('.chat-child')\n\t\tleftPeople.forEach((person) => {\n\t\t\tlet personUsername = person.querySelector('.chat-username').innerText\n\t\t\tif (personUsername === senderUsername) {\n\t\t\t\tlet unreadMsg = person.children[2]\n\t\t\t\tif (unreadMsg.classList.contains('hidden')) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tlet unreadMsgCount = parseInt(unreadMsg.innerText) - 1\n\t\t\t\tunreadMsg.children[0].textContent = unreadMsgCount\n\t\t\t\tif (unreadMsgCount === 0) {\n\t\t\t\t\tunreadMsg.classList.add('hidden')\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n})\n\n// listen for deleted conversation\nsocket.on('deleteConversation', (senderUsername) => {\n\tlet leftPeople = document.querySelectorAll('.chat-child')\n\tleftPeople.forEach((person) => {\n\t\tlet personUsername = person.querySelector('.chat-username').innerText\n\t\tif (personUsername === senderUsername) {\n\t\t\tperson.remove()\n\t\t}\n\t})\n\tlet chat_head = document.getElementById('chats-head')\n\tlet chat_mid = document.getElementById('all-chats')\n\tlet chat_end = document.getElementById('chats-end')\n\tlet blockDiv = document.querySelector('#chats-end-block')\n\tlet blockOption = document.querySelector('.block-info')\n\tlet blockBtn = document.querySelector('#block-to-user')\n\tlet deleteChatBtn = document.querySelector('#delete-chat-to-user')\n\n\tchat_head.classList.add('hidden')\n\tchat_mid.classList.add('hidden')\n\tchat_mid.querySelector('.message-container').innerHTML = ''\n\tchat_end.classList.add('hidden')\n\tblockDiv.classList.add('hidden')\n\tif (blockOption) {\n\t\tblockOption.remove()\n\t}\n\tblockBtn.classList.remove('hidden')\n\tdeleteChatBtn.classList.remove('hidden')\n})\n\n// listen for blocked user\nsocket.on('blockUser', (senderId) => {\n\t// console.log('Blocked user', senderId)\n\n\tif (document.querySelector('.chat-child.active')) {\n\t\tlet chat_end = document.getElementById('chats-end')\n\t\tchat_end.classList.add('hidden')\n\n\t\tlet blockDiv = document.querySelector('#chats-end-block')\n\t\tblockDiv.classList.remove('hidden')\n\n\t\tlet blockBtn = document.querySelector('#block-to-user')\n\t\tblockBtn.classList.add('hidden')\n\n\t\tlet deleteChatBtn = document.querySelector('#delete-chat-to-user')\n\t\tdeleteChatBtn.classList.add('hidden')\n\n\t\tlet blockInfoDiv = document.querySelector('.block-info')\n\t\tif (blockInfoDiv.classList.contains('hidden')) {\n\t\t\tblockInfoDiv.classList.remove('hidden')\n\t\t}\n\n\t\tlet toUserInfoPopupOptions = document.querySelector('.to-user-info-popup-options')\n\t\ttoUserInfoPopupOptions.classList.contains('hidden') ? toUserInfoPopupOptions.classList.remove('hidden') : null\n\t\ttoUserInfoPopupOptions.appendChild(blockInfoDiv)\n\t}\n})\n\n// listen for unblocked user\nsocket.on('unblockUser', (senderId) => {\n\t// console.log('Unblocked user', senderId)\n\tif (document.querySelector('.chat-child.active')) {\n\t\tlet blockDiv = document.querySelector('#chats-end-block')\n\t\tblockDiv.classList.add('hidden')\n\n\t\tlet blockBtn = document.querySelector('#block-to-user')\n\t\tblockBtn.classList.remove('hidden')\n\n\t\tlet deleteChatBtn = document.querySelector('#delete-chat-to-user')\n\t\tdeleteChatBtn.classList.remove('hidden')\n\n\t\tlet blockInfoDiv = document.querySelector('.block-info')\n\t\tif (!blockInfoDiv.classList.contains('hidden')) {\n\t\t\t// console.log('removing')\n\t\t\tblockInfoDiv.classList.add('hidden')\n\t\t}\n\n\t\tlet chat_end = document.getElementById('chats-end')\n\t\tchat_end.classList.remove('hidden')\n\t}\n})\n\n// listen for changed user details\nsocket.on('receiver-changed-details', (oldUserDetails, newUserDetails, callback) => {\n\ttry {\n\t\t// add user popup\n\t\tlet popupPeople = document.querySelectorAll('.new-chat-people')\n\t\tpopupPeople.forEach((person) => {\n\t\t\tlet personUsername = person.querySelector('.new-chat-people-username').innerText.trim()\n\t\t\tif (personUsername === oldUserDetails.username) {\n\t\t\t\tperson.querySelector('.new-chat-people-name').textContent = newUserDetails.name\n\t\t\t\tperson.querySelector('.new-chat-people-username').textContent = newUserDetails.username\n\t\t\t\tperson.querySelector('.new-chat-people-avatar').src = newUserDetails.avatar\n\t\t\t}\n\t\t})\n\n\t\t// left side chats list\n\t\tlet allLeftSideUser = document.querySelectorAll('.chat-child')\n\t\tallLeftSideUser.forEach((user) => {\n\t\t\tlet username = user.querySelector('.chat-username').innerText.trim()\n\t\t\tif (username === oldUserDetails.username) {\n\t\t\t\tuser.querySelector('.chat-name').textContent = newUserDetails.name\n\t\t\t\tuser.querySelector('.chat-username').textContent = newUserDetails.username\n\t\t\t\tuser.querySelector('.chat-img img').src = newUserDetails.avatar\n\n\t\t\t\t// chat section on right\n\t\t\t\tif (user.classList.contains('active')) {\n\t\t\t\t\t// chat head\n\t\t\t\t\tlet chat_head = document.querySelector('.chats-head')\n\t\t\t\t\tchat_head.querySelector('.chat-img img').src = newUserDetails.avatar\n\t\t\t\t\tchat_head.querySelector('#chat-head-name').textContent = newUserDetails.name\n\n\t\t\t\t\t// chat head popup\n\t\t\t\t\tdocument.querySelector('.to-user-info-popup-details img').src = newUserDetails.avatar\n\t\t\t\t\tdocument.querySelector('.to-user-info-popup-details h3').textContent = newUserDetails.name\n\t\t\t\t\tdocument.querySelector('.to-user-info-popup-details h4').textContent = newUserDetails.username\n\n\t\t\t\t\t// chat mid\n\t\t\t\t\tlet toUserProfileSec = document.querySelector('.to-user-profile-sec')\n\t\t\t\t\ttoUserProfileSec.querySelector('.to-user-profile-sec-img img').src = newUserDetails.avatar\n\t\t\t\t\ttoUserProfileSec.querySelector('.to-user-profile-sec-name h1').textContent = newUserDetails.name\n\t\t\t\t\ttoUserProfileSec.querySelector('.to-user-profile-sec-name h3').textContent = newUserDetails.username\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tcallback({\n\t\t\tstatus: 'success',\n\t\t\tmessage: 'details updated',\n\t\t})\n\t} catch (error) {\n\t\t// console.log('Error:', error)\n\t\tcallback({\n\t\t\tstatus: 'failure',\n\t\t\terror: error,\n\t\t})\n\t}\n})\n\n// listen for joining the group\nsocket.on('join-group', (data) => {\n\tsocket.emit('join-room', { roomId: data.roomId })\n\n\tlet currentUserName = document.querySelector('#change-details-name').value\n\n\tif (currentUserName !== data.creatorName) createLeftsideGroup(data.groupInfo, false)\n})\n\n// listen for new group message\nsocket.on('group-message', (data, callback) => {\n\t// console.log(data)\n\tconst { groupId, message, msgId, createdAt, senderName } = data\n\n\tlet findGroup = ''\n\n\tlet allGroups = document.querySelectorAll('.group-child')\n\tallGroups.forEach((group) => {\n\t\tlet id = group.dataset.id\n\t\t// console.log(id, groupId)\n\t\tif (id === groupId) {\n\t\t\tfindGroup = group\n\t\t}\n\t})\n\n\tif (findGroup === '') {\n\t\t// console.log('Group not found')\n\t\tcallback({\n\t\t\tstatus: 'failure',\n\t\t\terror: 'Group not found',\n\t\t})\n\t\treturn\n\t}\n\n\tif (findGroup.classList.contains('active')) {\n\t\tlet date = utcToLocal(createdAt)\n\t\tlet msgDate = date.slice(6)\n\t\tlet msgTime = date.slice(0, 5)\n\n\t\tlet dates = Array.from(document.querySelectorAll('.date'))\n\t\tlet msgContainerDiv = document.querySelector('.message-container')\n\n\t\tif (dates.length === 0 || dates[dates.length - 1].textContent !== msgDate) {\n\t\t\tconst dayDiv = document.createElement('div')\n\t\t\tdayDiv.classList.add('day')\n\t\t\tconst dateDiv = document.createElement('div')\n\t\t\tdateDiv.classList.add('date')\n\t\t\tconst dateh1 = document.createElement('h1')\n\t\t\tdateh1.textContent = msgDate\n\n\t\t\tdateDiv.appendChild(dateh1)\n\t\t\tdayDiv.appendChild(dateDiv)\n\t\t\tmsgContainerDiv.appendChild(dayDiv)\n\t\t}\n\n\t\tlet toUserMsg = toUserGroupMsgComponent(message, msgId, msgTime, senderName)\n\n\t\tmsgContainerDiv.appendChild(toUserMsg)\n\t\tmsgContainerDiv.scrollTop = msgContainerDiv.scrollHeight\n\t\tcallback({\n\t\t\tstatus: 'success',\n\t\t})\n\t} else {\n\t\tlet unreadMsgStatus = findGroup.querySelector('.unread-badge')\n\t\tlet unreadMsgCount = parseInt(unreadMsgStatus.children[0].textContent) + 1\n\t\tunreadMsgStatus.children[0].textContent = unreadMsgCount\n\t\tunreadMsgStatus.classList.remove('hidden')\n\n\t\tlet groupName = findGroup.querySelector('.group-name').innerText\n\n\t\tif (unreadMsgCount === 1) {\n\t\t\tshowNotification(`You have a new message in \"${groupName}\" group`)\n\t\t} else {\n\t\t\tshowNotification(`You have ${unreadMsgCount} new messages in \"${groupName}\" group`)\n\t\t}\n\n\t\tcallback({\n\t\t\tstatus: 'unread',\n\t\t})\n\t}\n})\n\n// listen for deleted group message\nsocket.on('delete-group-message', (data) => {\n\tconst { groupId, msgId, deletedBy } = data\n\tlet allGroups = document.querySelectorAll('.group-child')\n\tlet findGroup = ''\n\n\tallGroups.forEach((group) => {\n\t\tlet id = group.dataset.id\n\t\tif (id === groupId) {\n\t\t\tfindGroup = group\n\t\t}\n\t})\n\n\tif (findGroup && findGroup.classList.contains('active')) {\n\t\tlet activeGroupId = findGroup.dataset.id\n\n\t\tif (activeGroupId === groupId) {\n\t\t\tlet allToUserMessage = document.querySelectorAll('.to-user-msg')\n\n\t\t\tallToUserMessage.forEach((msg) => {\n\t\t\t\tlet messageId = msg.dataset.id\n\t\t\t\tif (msgId === messageId) {\n\t\t\t\t\tmsg.remove()\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlet days = document.querySelectorAll('.day')\n\t\t\tdays.forEach((day) => {\n\t\t\t\tif (day.nextElementSibling === null || day.nextElementSibling.classList.contains('day')) {\n\t\t\t\t\tday.remove()\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t} else if (findGroup) {\n\t\tlet unreadMsgStatus = findGroup.querySelector('.unread-badge')\n\t\tif (unreadMsgStatus.classList.contains('hidden')) {\n\t\t\treturn\n\t\t}\n\t\tlet unreadMsgCount = parseInt(unreadMsgStatus.children[0].innerText) - 1\n\t\tunreadMsgStatus.children[0].textContent = unreadMsgCount\n\t\tif (unreadMsgCount === 0) {\n\t\t\tunreadMsgStatus.classList.add('hidden')\n\t\t}\n\t}\n\n\tlet groupName = findGroup.querySelector('.group-name').innerText\n\tshowNotification(`\"${deletedBy}\" deleted a message in \"${groupName}\" group`)\n})\n\n//~ listen for leaving and deleting group\n\nsocket.on('connect', () => {\n\tconsole.log('Connected to server')\n})\n\nsocket.on('disconnect', () => {\n\tconsole.log('Disconnected from server')\n})\n\nexport { onlineUsers, handleHtmlOnlineUsers }\n","function assertNonEmptyString (str) {\n  if (typeof str !== 'string' || !str) {\n    throw new Error('expected a non-empty string, got: ' + str)\n  }\n}\n\nfunction assertNumber (number) {\n  if (typeof number !== 'number') {\n    throw new Error('expected a number, got: ' + number)\n  }\n}\n\nconst DB_VERSION_CURRENT = 1;\nconst DB_VERSION_INITIAL = 1;\nconst STORE_EMOJI = 'emoji';\nconst STORE_KEYVALUE = 'keyvalue';\nconst STORE_FAVORITES = 'favorites';\nconst FIELD_TOKENS = 'tokens';\nconst INDEX_TOKENS = 'tokens';\nconst FIELD_UNICODE = 'unicode';\nconst INDEX_COUNT = 'count';\nconst FIELD_GROUP = 'group';\nconst FIELD_ORDER = 'order';\nconst INDEX_GROUP_AND_ORDER = 'group-order';\nconst KEY_ETAG = 'eTag';\nconst KEY_URL = 'url';\nconst KEY_PREFERRED_SKINTONE = 'skinTone';\nconst MODE_READONLY = 'readonly';\nconst MODE_READWRITE = 'readwrite';\nconst INDEX_SKIN_UNICODE = 'skinUnicodes';\nconst FIELD_SKIN_UNICODE = 'skinUnicodes';\n\nconst DEFAULT_DATA_SOURCE = 'https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json';\nconst DEFAULT_LOCALE = 'en';\n\n// like lodash's uniqBy but much smaller\nfunction uniqBy (arr, func) {\n  const set = new Set();\n  const res = [];\n  for (const item of arr) {\n    const key = func(item);\n    if (!set.has(key)) {\n      set.add(key);\n      res.push(item);\n    }\n  }\n  return res\n}\n\nfunction uniqEmoji (emojis) {\n  return uniqBy(emojis, _ => _.unicode)\n}\n\nfunction initialMigration (db) {\n  function createObjectStore (name, keyPath, indexes) {\n    const store = keyPath\n      ? db.createObjectStore(name, { keyPath })\n      : db.createObjectStore(name);\n    if (indexes) {\n      for (const [indexName, [keyPath, multiEntry]] of Object.entries(indexes)) {\n        store.createIndex(indexName, keyPath, { multiEntry });\n      }\n    }\n    return store\n  }\n\n  createObjectStore(STORE_KEYVALUE);\n  createObjectStore(STORE_EMOJI, /* keyPath */ FIELD_UNICODE, {\n    [INDEX_TOKENS]: [FIELD_TOKENS, /* multiEntry */ true],\n    [INDEX_GROUP_AND_ORDER]: [[FIELD_GROUP, FIELD_ORDER]],\n    [INDEX_SKIN_UNICODE]: [FIELD_SKIN_UNICODE, /* multiEntry */ true]\n  });\n  createObjectStore(STORE_FAVORITES, undefined, {\n    [INDEX_COUNT]: ['']\n  });\n}\n\nconst openIndexedDBRequests = {};\nconst databaseCache = {};\nconst onCloseListeners = {};\n\nfunction handleOpenOrDeleteReq (resolve, reject, req) {\n  // These things are almost impossible to test with fakeIndexedDB sadly\n  /* istanbul ignore next */\n  req.onerror = () => reject(req.error);\n  /* istanbul ignore next */\n  req.onblocked = () => reject(new Error('IDB blocked'));\n  req.onsuccess = () => resolve(req.result);\n}\n\nasync function createDatabase (dbName) {\n  const db = await new Promise((resolve, reject) => {\n    const req = indexedDB.open(dbName, DB_VERSION_CURRENT);\n    openIndexedDBRequests[dbName] = req;\n    req.onupgradeneeded = e => {\n      // Technically there is only one version, so we don't need this `if` check\n      // But if an old version of the JS is in another browser tab\n      // and it gets upgraded in the future and we have a new DB version, well...\n      // better safe than sorry.\n      /* istanbul ignore else */\n      if (e.oldVersion < DB_VERSION_INITIAL) {\n        initialMigration(req.result);\n      }\n    };\n    handleOpenOrDeleteReq(resolve, reject, req);\n  });\n  // Handle abnormal closes, e.g. \"delete database\" in chrome dev tools.\n  // No need for removeEventListener, because once the DB can no longer\n  // fire \"close\" events, it will auto-GC.\n  // Unfortunately cannot test in fakeIndexedDB: https://github.com/dumbmatter/fakeIndexedDB/issues/50\n  /* istanbul ignore next */\n  db.onclose = () => closeDatabase(dbName);\n  return db\n}\n\nfunction openDatabase (dbName) {\n  if (!databaseCache[dbName]) {\n    databaseCache[dbName] = createDatabase(dbName);\n  }\n  return databaseCache[dbName]\n}\n\nfunction dbPromise (db, storeName, readOnlyOrReadWrite, cb) {\n  return new Promise((resolve, reject) => {\n    // Use relaxed durability because neither the emoji data nor the favorites/preferred skin tone\n    // are really irreplaceable data. IndexedDB is just a cache in this case.\n    const txn = db.transaction(storeName, readOnlyOrReadWrite, { durability: 'relaxed' });\n    const store = typeof storeName === 'string'\n      ? txn.objectStore(storeName)\n      : storeName.map(name => txn.objectStore(name));\n    let res;\n    cb(store, txn, (result) => {\n      res = result;\n    });\n\n    txn.oncomplete = () => resolve(res);\n    /* istanbul ignore next */\n    txn.onerror = () => reject(txn.error);\n  })\n}\n\nfunction closeDatabase (dbName) {\n  // close any open requests\n  const req = openIndexedDBRequests[dbName];\n  const db = req && req.result;\n  if (db) {\n    db.close();\n    const listeners = onCloseListeners[dbName];\n    /* istanbul ignore else */\n    if (listeners) {\n      for (const listener of listeners) {\n        listener();\n      }\n    }\n  }\n  delete openIndexedDBRequests[dbName];\n  delete databaseCache[dbName];\n  delete onCloseListeners[dbName];\n}\n\nfunction deleteDatabase (dbName) {\n  return new Promise((resolve, reject) => {\n    // close any open requests\n    closeDatabase(dbName);\n    const req = indexedDB.deleteDatabase(dbName);\n    handleOpenOrDeleteReq(resolve, reject, req);\n  })\n}\n\n// The \"close\" event occurs during an abnormal shutdown, e.g. a user clearing their browser data.\n// However, it doesn't occur with the normal \"close\" event, so we handle that separately.\n// https://www.w3.org/TR/IndexedDB/#close-a-database-connection\nfunction addOnCloseListener (dbName, listener) {\n  let listeners = onCloseListeners[dbName];\n  if (!listeners) {\n    listeners = onCloseListeners[dbName] = [];\n  }\n  listeners.push(listener);\n}\n\n// list of emoticons that don't match a simple \\W+ regex\n// extracted using:\n// require('emoji-picker-element-data/en/emojibase/data.json').map(_ => _.emoticon).filter(Boolean).filter(_ => !/^\\W+$/.test(_))\nconst irregularEmoticons = new Set([\n  ':D', 'XD', \":'D\", 'O:)',\n  ':X', ':P', ';P', 'XP',\n  ':L', ':Z', ':j', '8D',\n  'XO', '8)', ':B', ':O',\n  ':S', \":'o\", 'Dx', 'X(',\n  'D:', ':C', '>0)', ':3',\n  '</3', '<3', '\\\\M/', ':E',\n  '8#'\n]);\n\nfunction extractTokens (str) {\n  return str\n    .split(/[\\s_]+/)\n    .map(word => {\n      if (!word.match(/\\w/) || irregularEmoticons.has(word)) {\n        // for pure emoticons like :) or :-), just leave them as-is\n        return word.toLowerCase()\n      }\n\n      return word\n        .replace(/[)(:,]/g, '')\n        .replace(/’/g, \"'\")\n        .toLowerCase()\n    }).filter(Boolean)\n}\n\nconst MIN_SEARCH_TEXT_LENGTH = 2;\n\n// This is an extra step in addition to extractTokens(). The difference here is that we expect\n// the input to have already been run through extractTokens(). This is useful for cases like\n// emoticons, where we don't want to do any tokenization (because it makes no sense to split up\n// \">:)\" by the colon) but we do want to lowercase it to have consistent search results, so that\n// the user can type ':P' or ':p' and still get the same result.\nfunction normalizeTokens (str) {\n  return str\n    .filter(Boolean)\n    .map(_ => _.toLowerCase())\n    .filter(_ => _.length >= MIN_SEARCH_TEXT_LENGTH)\n}\n\n// Transform emoji data for storage in IDB\nfunction transformEmojiData (emojiData) {\n  const res = emojiData.map(({ annotation, emoticon, group, order, shortcodes, skins, tags, emoji, version }) => {\n    const tokens = [...new Set(\n      normalizeTokens([\n        ...(shortcodes || []).map(extractTokens).flat(),\n        ...(tags || []).map(extractTokens).flat(),\n        ...extractTokens(annotation),\n        emoticon\n      ])\n    )].sort();\n    const res = {\n      annotation,\n      group,\n      order,\n      tags,\n      tokens,\n      unicode: emoji,\n      version\n    };\n    if (emoticon) {\n      res.emoticon = emoticon;\n    }\n    if (shortcodes) {\n      res.shortcodes = shortcodes;\n    }\n    if (skins) {\n      res.skinTones = [];\n      res.skinUnicodes = [];\n      res.skinVersions = [];\n      for (const { tone, emoji, version } of skins) {\n        res.skinTones.push(tone);\n        res.skinUnicodes.push(emoji);\n        res.skinVersions.push(version);\n      }\n    }\n    return res\n  });\n  return res\n}\n\n// helper functions that help compress the code better\n\nfunction callStore (store, method, key, cb) {\n  store[method](key).onsuccess = e => (cb && cb(e.target.result));\n}\n\nfunction getIDB (store, key, cb) {\n  callStore(store, 'get', key, cb);\n}\n\nfunction getAllIDB (store, key, cb) {\n  callStore(store, 'getAll', key, cb);\n}\n\nfunction commit (txn) {\n  /* istanbul ignore else */\n  if (txn.commit) {\n    txn.commit();\n  }\n}\n\n// like lodash's minBy\nfunction minBy (array, func) {\n  let minItem = array[0];\n  for (let i = 1; i < array.length; i++) {\n    const item = array[i];\n    if (func(minItem) > func(item)) {\n      minItem = item;\n    }\n  }\n  return minItem\n}\n\n// return an array of results representing all items that are found in each one of the arrays\n//\n\nfunction findCommonMembers (arrays, uniqByFunc) {\n  const shortestArray = minBy(arrays, _ => _.length);\n  const results = [];\n  for (const item of shortestArray) {\n    // if this item is included in every array in the intermediate results, add it to the final results\n    if (!arrays.some(array => array.findIndex(_ => uniqByFunc(_) === uniqByFunc(item)) === -1)) {\n      results.push(item);\n    }\n  }\n  return results\n}\n\nasync function isEmpty (db) {\n  return !(await get(db, STORE_KEYVALUE, KEY_URL))\n}\n\nasync function hasData (db, url, eTag) {\n  const [oldETag, oldUrl] = await Promise.all([KEY_ETAG, KEY_URL]\n    .map(key => get(db, STORE_KEYVALUE, key)));\n  return (oldETag === eTag && oldUrl === url)\n}\n\nasync function doFullDatabaseScanForSingleResult (db, predicate) {\n  // This batching algorithm is just a perf improvement over a basic\n  // cursor. The BATCH_SIZE is an estimate of what would give the best\n  // perf for doing a full DB scan (worst case).\n  //\n  // Mini-benchmark for determining the best batch size:\n  //\n  // PERF=1 pnpm build:rollup && pnpm test:adhoc\n  //\n  // (async () => {\n  //   performance.mark('start')\n  //   await $('emoji-picker').database.getEmojiByShortcode('doesnotexist')\n  //   performance.measure('total', 'start')\n  //   console.log(performance.getEntriesByName('total').slice(-1)[0].duration)\n  // })()\n  const BATCH_SIZE = 50; // Typically around 150ms for 6x slowdown in Chrome for above benchmark\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    let lastKey;\n\n    const processNextBatch = () => {\n      emojiStore.getAll(lastKey && IDBKeyRange.lowerBound(lastKey, true), BATCH_SIZE).onsuccess = e => {\n        const results = e.target.result;\n        for (const result of results) {\n          lastKey = result.unicode;\n          if (predicate(result)) {\n            return cb(result)\n          }\n        }\n        if (results.length < BATCH_SIZE) {\n          return cb()\n        }\n        processNextBatch();\n      };\n    };\n    processNextBatch();\n  })\n}\n\nasync function loadData (db, emojiData, url, eTag) {\n  try {\n    const transformedData = transformEmojiData(emojiData);\n    await dbPromise(db, [STORE_EMOJI, STORE_KEYVALUE], MODE_READWRITE, ([emojiStore, metaStore], txn) => {\n      let oldETag;\n      let oldUrl;\n      let todo = 0;\n\n      function checkFetched () {\n        if (++todo === 2) { // 2 requests made\n          onFetched();\n        }\n      }\n\n      function onFetched () {\n        if (oldETag === eTag && oldUrl === url) {\n          // check again within the transaction to guard against concurrency, e.g. multiple browser tabs\n          return\n        }\n        // delete old data\n        emojiStore.clear();\n        // insert new data\n        for (const data of transformedData) {\n          emojiStore.put(data);\n        }\n        metaStore.put(eTag, KEY_ETAG);\n        metaStore.put(url, KEY_URL);\n        commit(txn);\n      }\n\n      getIDB(metaStore, KEY_ETAG, result => {\n        oldETag = result;\n        checkFetched();\n      });\n\n      getIDB(metaStore, KEY_URL, result => {\n        oldUrl = result;\n        checkFetched();\n      });\n    });\n  } finally {\n  }\n}\n\nasync function getEmojiByGroup (db, group) {\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    const range = IDBKeyRange.bound([group, 0], [group + 1, 0], false, true);\n    getAllIDB(emojiStore.index(INDEX_GROUP_AND_ORDER), range, cb);\n  })\n}\n\nasync function getEmojiBySearchQuery (db, query) {\n  const tokens = normalizeTokens(extractTokens(query));\n\n  if (!tokens.length) {\n    return []\n  }\n\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => {\n    // get all results that contain all tokens (i.e. an AND query)\n    const intermediateResults = [];\n\n    const checkDone = () => {\n      if (intermediateResults.length === tokens.length) {\n        onDone();\n      }\n    };\n\n    const onDone = () => {\n      const results = findCommonMembers(intermediateResults, _ => _.unicode);\n      cb(results.sort((a, b) => a.order < b.order ? -1 : 1));\n    };\n\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      const range = i === tokens.length - 1\n        ? IDBKeyRange.bound(token, token + '\\uffff', false, true) // treat last token as a prefix search\n        : IDBKeyRange.only(token); // treat all other tokens as an exact match\n      getAllIDB(emojiStore.index(INDEX_TOKENS), range, result => {\n        intermediateResults.push(result);\n        checkDone();\n      });\n    }\n  })\n}\n\n// This could have been implemented as an IDB index on shortcodes, but it seemed wasteful to do that\n// when we can already query by tokens and this will give us what we're looking for 99.9% of the time\nasync function getEmojiByShortcode (db, shortcode) {\n  const emojis = await getEmojiBySearchQuery(db, shortcode);\n\n  // In very rare cases (e.g. the shortcode \"v\" as in \"v for victory\"), we cannot search because\n  // there are no usable tokens (too short in this case). In that case, we have to do an inefficient\n  // full-database scan, which I believe is an acceptable tradeoff for not having to have an extra\n  // index on shortcodes.\n\n  if (!emojis.length) {\n    const predicate = _ => ((_.shortcodes || []).includes(shortcode.toLowerCase()));\n    return (await doFullDatabaseScanForSingleResult(db, predicate)) || null\n  }\n\n  return emojis.filter(_ => {\n    const lowerShortcodes = (_.shortcodes || []).map(_ => _.toLowerCase());\n    return lowerShortcodes.includes(shortcode.toLowerCase())\n  })[0] || null\n}\n\nasync function getEmojiByUnicode (db, unicode) {\n  return dbPromise(db, STORE_EMOJI, MODE_READONLY, (emojiStore, txn, cb) => (\n    getIDB(emojiStore, unicode, result => {\n      if (result) {\n        return cb(result)\n      }\n      getIDB(emojiStore.index(INDEX_SKIN_UNICODE), unicode, result => cb(result || null));\n    })\n  ))\n}\n\nfunction get (db, storeName, key) {\n  return dbPromise(db, storeName, MODE_READONLY, (store, txn, cb) => (\n    getIDB(store, key, cb)\n  ))\n}\n\nfunction set (db, storeName, key, value) {\n  return dbPromise(db, storeName, MODE_READWRITE, (store, txn) => {\n    store.put(value, key);\n    commit(txn);\n  })\n}\n\nfunction incrementFavoriteEmojiCount (db, unicode) {\n  return dbPromise(db, STORE_FAVORITES, MODE_READWRITE, (store, txn) => (\n    getIDB(store, unicode, result => {\n      store.put((result || 0) + 1, unicode);\n      commit(txn);\n    })\n  ))\n}\n\nfunction getTopFavoriteEmoji (db, customEmojiIndex, limit) {\n  if (limit === 0) {\n    return []\n  }\n  return dbPromise(db, [STORE_FAVORITES, STORE_EMOJI], MODE_READONLY, ([favoritesStore, emojiStore], txn, cb) => {\n    const results = [];\n    favoritesStore.index(INDEX_COUNT).openCursor(undefined, 'prev').onsuccess = e => {\n      const cursor = e.target.result;\n      if (!cursor) { // no more results\n        return cb(results)\n      }\n\n      function addResult (result) {\n        results.push(result);\n        if (results.length === limit) {\n          return cb(results) // done, reached the limit\n        }\n        cursor.continue();\n      }\n\n      const unicodeOrName = cursor.primaryKey;\n      const custom = customEmojiIndex.byName(unicodeOrName);\n      if (custom) {\n        return addResult(custom)\n      }\n      // This could be done in parallel (i.e. make the cursor and the get()s parallelized),\n      // but my testing suggests it's not actually faster.\n      getIDB(emojiStore, unicodeOrName, emoji => {\n        if (emoji) {\n          return addResult(emoji)\n        }\n        // emoji not found somehow, ignore (may happen if custom emoji change)\n        cursor.continue();\n      });\n    };\n  })\n}\n\n// trie data structure for prefix searches\n// loosely based on https://github.com/nolanlawson/substring-trie\n\nconst CODA_MARKER = ''; // marks the end of the string\n\nfunction trie (arr, itemToTokens) {\n  const map = new Map();\n  for (const item of arr) {\n    const tokens = itemToTokens(item);\n    for (const token of tokens) {\n      let currentMap = map;\n      for (let i = 0; i < token.length; i++) {\n        const char = token.charAt(i);\n        let nextMap = currentMap.get(char);\n        if (!nextMap) {\n          nextMap = new Map();\n          currentMap.set(char, nextMap);\n        }\n        currentMap = nextMap;\n      }\n      let valuesAtCoda = currentMap.get(CODA_MARKER);\n      if (!valuesAtCoda) {\n        valuesAtCoda = [];\n        currentMap.set(CODA_MARKER, valuesAtCoda);\n      }\n      valuesAtCoda.push(item);\n    }\n  }\n\n  const search = (query, exact) => {\n    let currentMap = map;\n    for (let i = 0; i < query.length; i++) {\n      const char = query.charAt(i);\n      const nextMap = currentMap.get(char);\n      if (nextMap) {\n        currentMap = nextMap;\n      } else {\n        return []\n      }\n    }\n\n    if (exact) {\n      const results = currentMap.get(CODA_MARKER);\n      return results || []\n    }\n\n    const results = [];\n    // traverse\n    const queue = [currentMap];\n    while (queue.length) {\n      const currentMap = queue.shift();\n      const entriesSortedByKey = [...currentMap.entries()].sort((a, b) => a[0] < b[0] ? -1 : 1);\n      for (const [key, value] of entriesSortedByKey) {\n        if (key === CODA_MARKER) { // CODA_MARKER always comes first; it's the empty string\n          results.push(...value);\n        } else {\n          queue.push(value);\n        }\n      }\n    }\n    return results\n  };\n\n  return search\n}\n\nconst requiredKeys$1 = [\n  'name',\n  'url'\n];\n\nfunction assertCustomEmojis (customEmojis) {\n  const isArray = customEmojis && Array.isArray(customEmojis);\n  const firstItemIsFaulty = isArray &&\n    customEmojis.length &&\n    (!customEmojis[0] || requiredKeys$1.some(key => !(key in customEmojis[0])));\n  if (!isArray || firstItemIsFaulty) {\n    throw new Error('Custom emojis are in the wrong format')\n  }\n}\n\nfunction customEmojiIndex (customEmojis) {\n  assertCustomEmojis(customEmojis);\n\n  const sortByName = (a, b) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n\n  //\n  // all()\n  //\n  const all = customEmojis.sort(sortByName);\n\n  //\n  // search()\n  //\n  const emojiToTokens = emoji => {\n    const set = new Set();\n    if (emoji.shortcodes) {\n      for (const shortcode of emoji.shortcodes) {\n        for (const token of extractTokens(shortcode)) {\n          set.add(token);\n        }\n      }\n    }\n    return set\n  };\n  const searchTrie = trie(customEmojis, emojiToTokens);\n  const searchByExactMatch = _ => searchTrie(_, true);\n  const searchByPrefix = _ => searchTrie(_, false);\n\n  // Search by query for custom emoji. Similar to how we do this in IDB, the last token\n  // is treated as a prefix search, but every other one is treated as an exact match.\n  // Then we AND the results together\n  const search = query => {\n    const tokens = extractTokens(query);\n    const intermediateResults = tokens.map((token, i) => (\n      (i < tokens.length - 1 ? searchByExactMatch : searchByPrefix)(token)\n    ));\n    return findCommonMembers(intermediateResults, _ => _.name).sort(sortByName)\n  };\n\n  //\n  // byShortcode, byName\n  //\n  const shortcodeToEmoji = new Map();\n  const nameToEmoji = new Map();\n  for (const customEmoji of customEmojis) {\n    nameToEmoji.set(customEmoji.name.toLowerCase(), customEmoji);\n    for (const shortcode of (customEmoji.shortcodes || [])) {\n      shortcodeToEmoji.set(shortcode.toLowerCase(), customEmoji);\n    }\n  }\n\n  const byShortcode = shortcode => shortcodeToEmoji.get(shortcode.toLowerCase());\n  const byName = name => nameToEmoji.get(name.toLowerCase());\n\n  return {\n    all,\n    search,\n    byShortcode,\n    byName\n  }\n}\n\nconst isFirefoxContentScript = typeof wrappedJSObject !== 'undefined';\n\n// remove some internal implementation details, i.e. the \"tokens\" array on the emoji object\n// essentially, convert the emoji from the version stored in IDB to the version used in-memory\nfunction cleanEmoji (emoji) {\n  if (!emoji) {\n    return emoji\n  }\n  // if inside a Firefox content script, need to clone the emoji object to prevent Firefox from complaining about\n  // cross-origin object. See: https://github.com/nolanlawson/emoji-picker-element/issues/356\n  /* istanbul ignore if */\n  if (isFirefoxContentScript) {\n    emoji = structuredClone(emoji);\n  }\n  delete emoji.tokens;\n  if (emoji.skinTones) {\n    const len = emoji.skinTones.length;\n    emoji.skins = Array(len);\n    for (let i = 0; i < len; i++) {\n      emoji.skins[i] = {\n        tone: emoji.skinTones[i],\n        unicode: emoji.skinUnicodes[i],\n        version: emoji.skinVersions[i]\n      };\n    }\n    delete emoji.skinTones;\n    delete emoji.skinUnicodes;\n    delete emoji.skinVersions;\n  }\n  return emoji\n}\n\nfunction warnETag (eTag) {\n  if (!eTag) {\n    console.warn('emoji-picker-element is more efficient if the dataSource server exposes an ETag header.');\n  }\n}\n\nconst requiredKeys = [\n  'annotation',\n  'emoji',\n  'group',\n  'order',\n  'version'\n];\n\nfunction assertEmojiData (emojiData) {\n  if (!emojiData ||\n    !Array.isArray(emojiData) ||\n    !emojiData[0] ||\n    (typeof emojiData[0] !== 'object') ||\n    requiredKeys.some(key => (!(key in emojiData[0])))) {\n    throw new Error('Emoji data is in the wrong format')\n  }\n}\n\nfunction assertStatus (response, dataSource) {\n  if (Math.floor(response.status / 100) !== 2) {\n    throw new Error('Failed to fetch: ' + dataSource + ':  ' + response.status)\n  }\n}\n\nasync function getETag (dataSource) {\n  const response = await fetch(dataSource, { method: 'HEAD' });\n  assertStatus(response, dataSource);\n  const eTag = response.headers.get('etag');\n  warnETag(eTag);\n  return eTag\n}\n\nasync function getETagAndData (dataSource) {\n  const response = await fetch(dataSource);\n  assertStatus(response, dataSource);\n  const eTag = response.headers.get('etag');\n  warnETag(eTag);\n  const emojiData = await response.json();\n  assertEmojiData(emojiData);\n  return [eTag, emojiData]\n}\n\n// TODO: including these in blob-util.ts causes typedoc to generate docs for them,\n// even with --excludePrivate ¯\\_(ツ)_/¯\n/** @private */\n/**\n * Convert an `ArrayBuffer` to a binary string.\n *\n * Example:\n *\n * ```js\n * var myString = blobUtil.arrayBufferToBinaryString(arrayBuff)\n * ```\n *\n * @param buffer - array buffer\n * @returns binary string\n */\nfunction arrayBufferToBinaryString(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n    var length = bytes.byteLength;\n    var i = -1;\n    while (++i < length) {\n        binary += String.fromCharCode(bytes[i]);\n    }\n    return binary;\n}\n/**\n * Convert a binary string to an `ArrayBuffer`.\n *\n * ```js\n * var myBuffer = blobUtil.binaryStringToArrayBuffer(binaryString)\n * ```\n *\n * @param binary - binary string\n * @returns array buffer\n */\nfunction binaryStringToArrayBuffer(binary) {\n    var length = binary.length;\n    var buf = new ArrayBuffer(length);\n    var arr = new Uint8Array(buf);\n    var i = -1;\n    while (++i < length) {\n        arr[i] = binary.charCodeAt(i);\n    }\n    return buf;\n}\n\n// generate a checksum based on the stringified JSON\nasync function jsonChecksum (object) {\n  const inString = JSON.stringify(object);\n  let inBuffer = binaryStringToArrayBuffer(inString);\n\n  // this does not need to be cryptographically secure, SHA-1 is fine\n  const outBuffer = await crypto.subtle.digest('SHA-1', inBuffer);\n  const outBinString = arrayBufferToBinaryString(outBuffer);\n  const res = btoa(outBinString);\n  return res\n}\n\nasync function checkForUpdates (db, dataSource) {\n  // just do a simple HEAD request first to see if the eTags match\n  let emojiData;\n  let eTag = await getETag(dataSource);\n  if (!eTag) { // work around lack of ETag/Access-Control-Expose-Headers\n    const eTagAndData = await getETagAndData(dataSource);\n    eTag = eTagAndData[0];\n    emojiData = eTagAndData[1];\n    if (!eTag) {\n      eTag = await jsonChecksum(emojiData);\n    }\n  }\n  if (await hasData(db, dataSource, eTag)) ; else {\n    if (!emojiData) {\n      const eTagAndData = await getETagAndData(dataSource);\n      emojiData = eTagAndData[1];\n    }\n    await loadData(db, emojiData, dataSource, eTag);\n  }\n}\n\nasync function loadDataForFirstTime (db, dataSource) {\n  let [eTag, emojiData] = await getETagAndData(dataSource);\n  if (!eTag) {\n    // Handle lack of support for ETag or Access-Control-Expose-Headers\n    // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Expose-Headers#Browser_compatibility\n    eTag = await jsonChecksum(emojiData);\n  }\n\n  await loadData(db, emojiData, dataSource, eTag);\n}\n\nclass Database {\n  constructor ({ dataSource = DEFAULT_DATA_SOURCE, locale = DEFAULT_LOCALE, customEmoji = [] } = {}) {\n    this.dataSource = dataSource;\n    this.locale = locale;\n    this._dbName = `emoji-picker-element-${this.locale}`;\n    this._db = undefined;\n    this._lazyUpdate = undefined;\n    this._custom = customEmojiIndex(customEmoji);\n\n    this._clear = this._clear.bind(this);\n    this._ready = this._init();\n  }\n\n  async _init () {\n    const db = this._db = await openDatabase(this._dbName);\n\n    addOnCloseListener(this._dbName, this._clear);\n    const dataSource = this.dataSource;\n    const empty = await isEmpty(db);\n\n    if (empty) {\n      await loadDataForFirstTime(db, dataSource);\n    } else { // offline-first - do an update asynchronously\n      this._lazyUpdate = checkForUpdates(db, dataSource);\n    }\n  }\n\n  async ready () {\n    const checkReady = async () => {\n      if (!this._ready) {\n        this._ready = this._init();\n      }\n      return this._ready\n    };\n    await checkReady();\n    // There's a possibility of a race condition where the element gets added, removed, and then added again\n    // with a particular timing, which would set the _db to undefined.\n    // We *could* do a while loop here, but that seems excessive and could lead to an infinite loop.\n    if (!this._db) {\n      await checkReady();\n    }\n  }\n\n  async getEmojiByGroup (group) {\n    assertNumber(group);\n    await this.ready();\n    return uniqEmoji(await getEmojiByGroup(this._db, group)).map(cleanEmoji)\n  }\n\n  async getEmojiBySearchQuery (query) {\n    assertNonEmptyString(query);\n    await this.ready();\n    const customs = this._custom.search(query);\n    const natives = uniqEmoji(await getEmojiBySearchQuery(this._db, query)).map(cleanEmoji);\n    return [\n      ...customs,\n      ...natives\n    ]\n  }\n\n  async getEmojiByShortcode (shortcode) {\n    assertNonEmptyString(shortcode);\n    await this.ready();\n    const custom = this._custom.byShortcode(shortcode);\n    if (custom) {\n      return custom\n    }\n    return cleanEmoji(await getEmojiByShortcode(this._db, shortcode))\n  }\n\n  async getEmojiByUnicodeOrName (unicodeOrName) {\n    assertNonEmptyString(unicodeOrName);\n    await this.ready();\n    const custom = this._custom.byName(unicodeOrName);\n    if (custom) {\n      return custom\n    }\n    return cleanEmoji(await getEmojiByUnicode(this._db, unicodeOrName))\n  }\n\n  async getPreferredSkinTone () {\n    await this.ready();\n    return (await get(this._db, STORE_KEYVALUE, KEY_PREFERRED_SKINTONE)) || 0\n  }\n\n  async setPreferredSkinTone (skinTone) {\n    assertNumber(skinTone);\n    await this.ready();\n    return set(this._db, STORE_KEYVALUE, KEY_PREFERRED_SKINTONE, skinTone)\n  }\n\n  async incrementFavoriteEmojiCount (unicodeOrName) {\n    assertNonEmptyString(unicodeOrName);\n    await this.ready();\n    return incrementFavoriteEmojiCount(this._db, unicodeOrName)\n  }\n\n  async getTopFavoriteEmoji (limit) {\n    assertNumber(limit);\n    await this.ready();\n    return (await getTopFavoriteEmoji(this._db, this._custom, limit)).map(cleanEmoji)\n  }\n\n  set customEmoji (customEmojis) {\n    this._custom = customEmojiIndex(customEmojis);\n  }\n\n  get customEmoji () {\n    return this._custom.all\n  }\n\n  async _shutdown () {\n    await this.ready(); // reopen if we've already been closed/deleted\n    try {\n      await this._lazyUpdate; // allow any lazy updates to process before closing/deleting\n    } catch (err) { /* ignore network errors (offline-first) */ }\n  }\n\n  // clear references to IDB, e.g. during a close event\n  _clear () {\n    // We don't need to call removeEventListener or remove the manual \"close\" listeners.\n    // The memory leak tests prove this is unnecessary. It's because:\n    // 1) IDBDatabases that can no longer fire \"close\" automatically have listeners GCed\n    // 2) we clear the manual close listeners in databaseLifecycle.js.\n    this._db = this._ready = this._lazyUpdate = undefined;\n  }\n\n  async close () {\n    await this._shutdown();\n    await closeDatabase(this._dbName);\n  }\n\n  async delete () {\n    await this._shutdown();\n    await deleteDatabase(this._dbName);\n  }\n}\n\nexport { Database as default };\n","import Database from './database.js';\n\n// via https://unpkg.com/browse/emojibase-data@6.0.0/meta/groups.json\nconst allGroups = [\n  [-1, '✨', 'custom'],\n  [0, '😀', 'smileys-emotion'],\n  [1, '👋', 'people-body'],\n  [3, '🐱', 'animals-nature'],\n  [4, '🍎', 'food-drink'],\n  [5, '🏠️', 'travel-places'],\n  [6, '⚽', 'activities'],\n  [7, '📝', 'objects'],\n  [8, '⛔️', 'symbols'],\n  [9, '🏁', 'flags']\n].map(([id, emoji, name]) => ({ id, emoji, name }));\n\nconst groups = allGroups.slice(1);\n\nconst MIN_SEARCH_TEXT_LENGTH = 2;\nconst NUM_SKIN_TONES = 6;\n\n/* istanbul ignore next */\nconst rIC = typeof requestIdleCallback === 'function' ? requestIdleCallback : setTimeout;\n\n// check for ZWJ (zero width joiner) character\nfunction hasZwj (emoji) {\n  return emoji.unicode.includes('\\u200d')\n}\n\n// Find one good representative emoji from each version to test by checking its color.\n// Ideally it should have color in the center. For some inspiration, see:\n// https://about.gitlab.com/blog/2018/05/30/journey-in-native-unicode-emoji/\n//\n// Note that for certain versions (12.1, 13.1), there is no point in testing them explicitly, because\n// all the emoji from this version are compound-emoji from previous versions. So they would pass a color\n// test, even in browsers that display them as double emoji. (E.g. \"face in clouds\" might render as\n// \"face without mouth\" plus \"fog\".) These emoji can only be filtered using the width test,\n// which happens in checkZwjSupport.js.\nconst versionsAndTestEmoji = {\n  '🫨': 15.1, // shaking head, technically from v15 but see note above\n  '🫠': 14,\n  '🥲': 13.1, // smiling face with tear, technically from v13 but see note above\n  '🥻': 12.1, // sari, technically from v12 but see note above\n  '🥰': 11,\n  '🤩': 5,\n  '👱‍♀️': 4,\n  '🤣': 3,\n  '👁️‍🗨️': 2,\n  '😀': 1,\n  '😐️': 0.7,\n  '😃': 0.6\n};\n\nconst TIMEOUT_BEFORE_LOADING_MESSAGE = 1000; // 1 second\nconst DEFAULT_SKIN_TONE_EMOJI = '🖐️';\nconst DEFAULT_NUM_COLUMNS = 8;\n\n// Based on https://fivethirtyeight.com/features/the-100-most-used-emojis/ and\n// https://blog.emojipedia.org/facebook-reveals-most-and-least-used-emojis/ with\n// a bit of my own curation. (E.g. avoid the \"OK\" gesture because of connotations:\n// https://emojipedia.org/ok-hand/)\nconst MOST_COMMONLY_USED_EMOJI = [\n  '😊',\n  '😒',\n  '❤️',\n  '👍️',\n  '😍',\n  '😂',\n  '😭',\n  '☺️',\n  '😔',\n  '😩',\n  '😏',\n  '💕',\n  '🙌',\n  '😘'\n];\n\n// It's important to list Twemoji Mozilla before everything else, because Mozilla bundles their\n// own font on some platforms (notably Windows and Linux as of this writing). Typically, Mozilla\n// updates faster than the underlying OS, and we don't want to render older emoji in one font and\n// newer emoji in another font:\n// https://github.com/nolanlawson/emoji-picker-element/pull/268#issuecomment-1073347283\nconst FONT_FAMILY = '\"Twemoji Mozilla\",\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",' +\n  '\"Noto Color Emoji\",\"EmojiOne Color\",\"Android Emoji\",sans-serif';\n\n/* istanbul ignore next */\nconst DEFAULT_CATEGORY_SORTING = (a, b) => a < b ? -1 : a > b ? 1 : 0;\n\n// Test if an emoji is supported by rendering it to canvas and checking that the color is not black\n// See https://about.gitlab.com/blog/2018/05/30/journey-in-native-unicode-emoji/\n// and https://www.npmjs.com/package/if-emoji for inspiration\n// This implementation is largely borrowed from if-emoji, adding the font-family\n\n\nconst getTextFeature = (text, color) => {\n  const canvas = document.createElement('canvas');\n  canvas.width = canvas.height = 1;\n\n  const ctx = canvas.getContext('2d', {\n    // Improves the performance of `getImageData()`\n    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getContextAttributes#willreadfrequently\n    willReadFrequently: true\n  });\n  ctx.textBaseline = 'top';\n  ctx.font = `100px ${FONT_FAMILY}`;\n  ctx.fillStyle = color;\n  ctx.scale(0.01, 0.01);\n  ctx.fillText(text, 0, 0);\n\n  return ctx.getImageData(0, 0, 1, 1).data\n};\n\nconst compareFeatures = (feature1, feature2) => {\n  const feature1Str = [...feature1].join(',');\n  const feature2Str = [...feature2].join(',');\n  // This is RGBA, so for 0,0,0, we are checking that the first RGB is not all zeroes.\n  // Most of the time when unsupported this is 0,0,0,0, but on Chrome on Mac it is\n  // 0,0,0,61 - there is a transparency here.\n  return feature1Str === feature2Str && !feature1Str.startsWith('0,0,0,')\n};\n\nfunction testColorEmojiSupported (text) {\n  // Render white and black and then compare them to each other and ensure they're the same\n  // color, and neither one is black. This shows that the emoji was rendered in color.\n  const feature1 = getTextFeature(text, '#000');\n  const feature2 = getTextFeature(text, '#fff');\n  return feature1 && feature2 && compareFeatures(feature1, feature2)\n}\n\n// rather than check every emoji ever, which would be expensive, just check some representatives from the\n// different emoji releases to determine what the font supports\n\nfunction determineEmojiSupportLevel () {\n  const entries = Object.entries(versionsAndTestEmoji);\n  try {\n    // start with latest emoji and work backwards\n    for (const [emoji, version] of entries) {\n      if (testColorEmojiSupported(emoji)) {\n        return version\n      }\n    }\n  } catch (e) { // canvas error\n  } finally {\n  }\n  // In case of an error, be generous and just assume all emoji are supported (e.g. for canvas errors\n  // due to anti-fingerprinting add-ons). Better to show some gray boxes than nothing at all.\n  return entries[0][1] // first one in the list is the most recent version\n}\n\n// Check which emojis we know for sure aren't supported, based on Unicode version level\nlet promise;\nconst detectEmojiSupportLevel = () => {\n  if (!promise) {\n    // Delay so it can run while the IDB database is being created by the browser (on another thread).\n    // This helps especially with first load – we want to start pre-populating the database on the main thread,\n    // and then wait for IDB to commit everything, and while waiting we run this check.\n    promise = new Promise(resolve => (\n      rIC(() => (\n        resolve(determineEmojiSupportLevel()) // delay so ideally this can run while IDB is first populating\n      ))\n    ));\n  }\n  return promise\n};\n// determine which emojis containing ZWJ (zero width joiner) characters\n// are supported (rendered as one glyph) rather than unsupported (rendered as two or more glyphs)\nconst supportedZwjEmojis = new Map();\n\nconst VARIATION_SELECTOR = '\\ufe0f';\nconst SKINTONE_MODIFIER = '\\ud83c';\nconst ZWJ = '\\u200d';\nconst LIGHT_SKIN_TONE = 0x1F3FB;\nconst LIGHT_SKIN_TONE_MODIFIER = 0xdffb;\n\n// TODO: this is a naive implementation, we can improve it later\n// It's only used for the skintone picker, so as long as people don't customize with\n// really exotic emoji then it should work fine\nfunction applySkinTone (str, skinTone) {\n  if (skinTone === 0) {\n    return str\n  }\n  const zwjIndex = str.indexOf(ZWJ);\n  if (zwjIndex !== -1) {\n    return str.substring(0, zwjIndex) +\n      String.fromCodePoint(LIGHT_SKIN_TONE + skinTone - 1) +\n      str.substring(zwjIndex)\n  }\n  if (str.endsWith(VARIATION_SELECTOR)) {\n    str = str.substring(0, str.length - 1);\n  }\n  return str + SKINTONE_MODIFIER + String.fromCodePoint(LIGHT_SKIN_TONE_MODIFIER + skinTone - 1)\n}\n\nfunction halt (event) {\n  event.preventDefault();\n  event.stopPropagation();\n}\n\n// Implementation left/right or up/down navigation, circling back when you\n// reach the start/end of the list\nfunction incrementOrDecrement (decrement, val, arr) {\n  val += (decrement ? -1 : 1);\n  if (val < 0) {\n    val = arr.length - 1;\n  } else if (val >= arr.length) {\n    val = 0;\n  }\n  return val\n}\n\n// like lodash's uniqBy but much smaller\nfunction uniqBy (arr, func) {\n  const set = new Set();\n  const res = [];\n  for (const item of arr) {\n    const key = func(item);\n    if (!set.has(key)) {\n      set.add(key);\n      res.push(item);\n    }\n  }\n  return res\n}\n\n// We don't need all the data on every emoji, and there are specific things we need\n// for the UI, so build a \"view model\" from the emoji object we got from the database\n\nfunction summarizeEmojisForUI (emojis, emojiSupportLevel) {\n  const toSimpleSkinsMap = skins => {\n    const res = {};\n    for (const skin of skins) {\n      // ignore arrays like [1, 2] with multiple skin tones\n      // also ignore variants that are in an unsupported emoji version\n      // (these do exist - variants from a different version than their base emoji)\n      if (typeof skin.tone === 'number' && skin.version <= emojiSupportLevel) {\n        res[skin.tone] = skin.unicode;\n      }\n    }\n    return res\n  };\n\n  return emojis.map(({ unicode, skins, shortcodes, url, name, category, annotation }) => ({\n    unicode,\n    name,\n    shortcodes,\n    url,\n    category,\n    annotation,\n    id: unicode || name,\n    skins: skins && toSimpleSkinsMap(skins)\n  }))\n}\n\n// import rAF from one place so that the bundle size is a bit smaller\nconst rAF = requestAnimationFrame;\n\n// \"Svelte action\"-like utility to detect layout changes via ResizeObserver.\n// If ResizeObserver is unsupported, we just use rAF once and don't bother to update.\n\n\nlet resizeObserverSupported = typeof ResizeObserver === 'function';\n\nfunction resizeObserverAction (node, abortSignal, onUpdate) {\n  let resizeObserver;\n  if (resizeObserverSupported) {\n    resizeObserver = new ResizeObserver(onUpdate);\n    resizeObserver.observe(node);\n  } else { // just run once, don't bother trying to track it\n    rAF(onUpdate);\n  }\n\n  // cleanup function (called on destroy)\n  abortSignal.addEventListener('abort', () => {\n    if (resizeObserver) {\n      resizeObserver.disconnect();\n    }\n  });\n}\n\n// get the width of the text inside of a DOM node, via https://stackoverflow.com/a/59525891/680742\nfunction calculateTextWidth (node) {\n  // skip running this in jest/vitest because we don't need to check for emoji support in that environment\n  /* istanbul ignore else */\n  {\n    const range = document.createRange();\n    range.selectNode(node.firstChild);\n    return range.getBoundingClientRect().width\n  }\n}\n\nlet baselineEmojiWidth;\n\n/**\n * Check if the given emojis containing ZWJ characters are supported by the current browser (don't render\n * as double characters) and return true if all are supported.\n * @param zwjEmojisToCheck\n * @param baselineEmoji\n * @param emojiToDomNode\n */\nfunction checkZwjSupport (zwjEmojisToCheck, baselineEmoji, emojiToDomNode) {\n  let allSupported = true;\n  for (const emoji of zwjEmojisToCheck) {\n    const domNode = emojiToDomNode(emoji);\n    const emojiWidth = calculateTextWidth(domNode);\n    if (typeof baselineEmojiWidth === 'undefined') { // calculate the baseline emoji width only once\n      baselineEmojiWidth = calculateTextWidth(baselineEmoji);\n    }\n    // On Windows, some supported emoji are ~50% bigger than the baseline emoji, but what we really want to guard\n    // against are the ones that are 2x the size, because those are truly broken (person with red hair = person with\n    // floating red wig, black cat = cat with black square, polar bear = bear with snowflake, etc.)\n    // So here we set the threshold at 1.8 times the size of the baseline emoji.\n    const supported = emojiWidth / 1.8 < baselineEmojiWidth;\n    supportedZwjEmojis.set(emoji.unicode, supported);\n\n    if (!supported) {\n      allSupported = false;\n    }\n  }\n  return allSupported\n}\n\n// like lodash's uniq\n\nfunction uniq (arr) {\n  return uniqBy(arr, _ => _)\n}\n\n// Note we put this in its own function outside Picker.js to avoid Svelte doing an invalidation on the \"setter\" here.\n// At best the invalidation is useless, at worst it can cause infinite loops:\n// https://github.com/nolanlawson/emoji-picker-element/pull/180\n// https://github.com/sveltejs/svelte/issues/6521\n// Also note tabpanelElement can be null if the element is disconnected immediately after connected\nfunction resetScrollTopIfPossible (element) {\n  /* istanbul ignore else */\n  if (element) { // Makes me nervous not to have this `if` guard\n    element.scrollTop = 0;\n  }\n}\n\nfunction getFromMap (cache, key, func) {\n  let cached = cache.get(key);\n  if (!cached) {\n    cached = func();\n    cache.set(key, cached);\n  }\n  return cached\n}\n\nfunction toString (value) {\n  return '' + value\n}\n\nfunction parseTemplate (htmlString) {\n  const template = document.createElement('template');\n  template.innerHTML = htmlString;\n  return template\n}\n\nconst parseCache = new WeakMap();\nconst domInstancesCache = new WeakMap();\n// This needs to be a symbol because it needs to be different from any possible output of a key function\nconst unkeyedSymbol = Symbol('un-keyed');\n\n// Not supported in Safari <=13\nconst hasReplaceChildren = 'replaceChildren' in Element.prototype;\nfunction replaceChildren (parentNode, newChildren) {\n  /* istanbul ignore else */\n  if (hasReplaceChildren) {\n    parentNode.replaceChildren(...newChildren);\n  } else { // minimal polyfill for Element.prototype.replaceChildren\n    parentNode.innerHTML = '';\n    parentNode.append(...newChildren);\n  }\n}\n\nfunction doChildrenNeedRerender (parentNode, newChildren) {\n  let oldChild = parentNode.firstChild;\n  let oldChildrenCount = 0;\n  // iterate using firstChild/nextSibling because browsers use a linked list under the hood\n  while (oldChild) {\n    const newChild = newChildren[oldChildrenCount];\n    // check if the old child and new child are the same\n    if (newChild !== oldChild) {\n      return true\n    }\n    oldChild = oldChild.nextSibling;\n    oldChildrenCount++;\n  }\n  // if new children length is different from old, we must re-render\n  return oldChildrenCount !== newChildren.length\n}\n\nfunction patchChildren (newChildren, instanceBinding) {\n  const { targetNode } = instanceBinding;\n  let { targetParentNode } = instanceBinding;\n\n  let needsRerender = false;\n\n  if (targetParentNode) { // already rendered once\n    needsRerender = doChildrenNeedRerender(targetParentNode, newChildren);\n  } else { // first render of list\n    needsRerender = true;\n    instanceBinding.targetNode = undefined; // placeholder node not needed anymore, free memory\n    instanceBinding.targetParentNode = targetParentNode = targetNode.parentNode;\n  }\n  // avoid re-rendering list if the dom nodes are exactly the same before and after\n  if (needsRerender) {\n    replaceChildren(targetParentNode, newChildren);\n  }\n}\n\nfunction patch (expressions, instanceBindings) {\n  for (const instanceBinding of instanceBindings) {\n    const {\n      targetNode,\n      currentExpression,\n      binding: {\n        expressionIndex,\n        attributeName,\n        attributeValuePre,\n        attributeValuePost\n      }\n    } = instanceBinding;\n\n    const expression = expressions[expressionIndex];\n\n    if (currentExpression === expression) {\n      // no need to update, same as before\n      continue\n    }\n\n    instanceBinding.currentExpression = expression;\n\n    if (attributeName) { // attribute replacement\n      targetNode.setAttribute(attributeName, attributeValuePre + toString(expression) + attributeValuePost);\n    } else { // text node / child element / children replacement\n      let newNode;\n      if (Array.isArray(expression)) { // array of DOM elements produced by tag template literals\n        patchChildren(expression, instanceBinding);\n      } else if (expression instanceof Element) { // html tag template returning a DOM element\n        newNode = expression;\n        targetNode.replaceWith(newNode);\n      } else { // primitive - string, number, etc\n        // nodeValue is faster than textContent supposedly https://www.youtube.com/watch?v=LY6y3HbDVmg\n        // note we may be replacing the value in a placeholder text node\n        targetNode.nodeValue = toString(expression);\n      }\n      if (newNode) {\n        instanceBinding.targetNode = newNode;\n      }\n    }\n  }\n}\n\nfunction parse (tokens) {\n  let htmlString = '';\n\n  let withinTag = false;\n  let withinAttribute = false;\n  let elementIndexCounter = -1; // depth-first traversal order\n\n  const elementsToBindings = new Map();\n  const elementIndexes = [];\n\n  for (let i = 0, len = tokens.length; i < len; i++) {\n    const token = tokens[i];\n    htmlString += token;\n\n    if (i === len - 1) {\n      break // no need to process characters - no more expressions to be found\n    }\n\n    for (let j = 0; j < token.length; j++) {\n      const char = token.charAt(j);\n      switch (char) {\n        case '<': {\n          const nextChar = token.charAt(j + 1);\n          if (nextChar === '/') { // closing tag\n            // leaving an element\n            elementIndexes.pop();\n          } else { // not a closing tag\n            withinTag = true;\n            elementIndexes.push(++elementIndexCounter);\n          }\n          break\n        }\n        case '>': {\n          withinTag = false;\n          withinAttribute = false;\n          break\n        }\n        case '=': {\n          withinAttribute = true;\n          break\n        }\n      }\n    }\n\n    const elementIndex = elementIndexes[elementIndexes.length - 1];\n    const bindings = getFromMap(elementsToBindings, elementIndex, () => []);\n\n    let attributeName;\n    let attributeValuePre;\n    let attributeValuePost;\n    if (withinAttribute) {\n      // I never use single-quotes for attribute values in HTML, so just support double-quotes or no-quotes\n      const match = /(\\S+)=\"?([^\"=]*)$/.exec(token);\n      attributeName = match[1];\n      attributeValuePre = match[2];\n      attributeValuePost = /^[^\">]*/.exec(tokens[i + 1])[0];\n    }\n\n    const binding = {\n      attributeName,\n      attributeValuePre,\n      attributeValuePost,\n      expressionIndex: i\n    };\n\n    bindings.push(binding);\n\n    if (!withinTag && !withinAttribute) {\n      // Add a placeholder text node, so we can find it later. Note we only support one dynamic child text node\n      htmlString += ' ';\n    }\n  }\n\n  const template = parseTemplate(htmlString);\n\n  return {\n    template,\n    elementsToBindings\n  }\n}\n\nfunction applyBindings (bindings, element, instanceBindings) {\n  for (let i = 0; i < bindings.length; i++) {\n    const binding = bindings[i];\n\n    const targetNode = binding.attributeName\n      ? element // attribute binding, just use the element itself\n      : element.firstChild; // not an attribute binding, so has a placeholder text node\n\n    const instanceBinding = {\n      binding,\n      targetNode,\n      targetParentNode: undefined,\n      currentExpression: undefined\n    };\n\n    instanceBindings.push(instanceBinding);\n  }\n}\n\nfunction traverseAndSetupBindings (rootElement, elementsToBindings) {\n  const instanceBindings = [];\n\n  let topLevelBindings;\n  if (elementsToBindings.size === 1 && (topLevelBindings = elementsToBindings.get(0))) {\n    // Optimization for the common case where there's only one element and one binding\n    // Skip creating a TreeWalker entirely and just handle the root DOM element\n    applyBindings(topLevelBindings, rootElement, instanceBindings);\n  } else {\n    // traverse dom\n    const treeWalker = document.createTreeWalker(rootElement, NodeFilter.SHOW_ELEMENT);\n\n    let element = rootElement;\n    let elementIndex = -1;\n    do {\n      const bindings = elementsToBindings.get(++elementIndex);\n      if (bindings) {\n        applyBindings(bindings, element, instanceBindings);\n      }\n    } while ((element = treeWalker.nextNode()))\n  }\n\n  return instanceBindings\n}\n\nfunction parseHtml (tokens) {\n  // All templates and bound expressions are unique per tokens array\n  const { template, elementsToBindings } = getFromMap(parseCache, tokens, () => parse(tokens));\n\n  // When we parseHtml, we always return a fresh DOM instance ready to be updated\n  const dom = template.cloneNode(true).content.firstElementChild;\n  const instanceBindings = traverseAndSetupBindings(dom, elementsToBindings);\n\n  return function updateDomInstance (expressions) {\n    patch(expressions, instanceBindings);\n    return dom\n  }\n}\n\nfunction createFramework (state) {\n  const domInstances = getFromMap(domInstancesCache, state, () => new Map());\n  let domInstanceCacheKey = unkeyedSymbol;\n\n  function html (tokens, ...expressions) {\n    // Each unique lexical usage of map() is considered unique due to the html`` tagged template call it makes,\n    // which has lexically unique tokens. The unkeyed symbol is just used for html`` usage outside of a map().\n    const domInstancesForTokens = getFromMap(domInstances, tokens, () => new Map());\n    const updateDomInstance = getFromMap(domInstancesForTokens, domInstanceCacheKey, () => parseHtml(tokens));\n\n    return updateDomInstance(expressions) // update with expressions\n  }\n\n  function map (array, callback, keyFunction) {\n    return array.map((item, index) => {\n      const originalCacheKey = domInstanceCacheKey;\n      domInstanceCacheKey = keyFunction(item);\n      try {\n        return callback(item, index)\n      } finally {\n        domInstanceCacheKey = originalCacheKey;\n      }\n    })\n  }\n\n  return { map, html }\n}\n\nfunction render (container, state, helpers, events, actions, refs, abortSignal, actionContext, firstRender) {\n  const { labelWithSkin, titleForEmoji, unicodeWithSkin } = helpers;\n  const { html, map } = createFramework(state);\n\n  function emojiList (emojis, searchMode, prefix) {\n    return map(emojis, (emoji, i) => {\n      return html`<button role=\"${searchMode ? 'option' : 'menuitem'}\" aria-selected=\"${searchMode ? i === state.activeSearchItem : ''}\" aria-label=\"${labelWithSkin(emoji, state.currentSkinTone)}\" title=\"${titleForEmoji(emoji)}\" class=\"${\n                'emoji' +\n                (searchMode && i === state.activeSearchItem ? ' active' : '') +\n                (emoji.unicode ? '' : ' custom-emoji')\n              }\" id=\"${`${prefix}-${emoji.id}`}\" style=\"${emoji.unicode ? '' : `--custom-emoji-background: url(${JSON.stringify(emoji.url)})`}\">${\n        emoji.unicode\n          ? unicodeWithSkin(emoji, state.currentSkinTone)\n          : ''\n      }</button>`\n      // It's important for the cache key to be unique based on the prefix, because the framework caches based on the\n      // unique tokens + cache key, and the same emoji may be used in the tab as well as in the fav bar\n    }, emoji => `${prefix}-${emoji.id}`)\n  }\n\n  const section = () => {\n    return html`<section data-ref=\"rootElement\" class=\"picker\" aria-label=\"${state.i18n.regionLabel}\" style=\"${state.pickerStyle || ''}\"><div class=\"pad-top\"></div><div class=\"search-row\"><div class=\"search-wrapper\"><input id=\"search\" class=\"search\" type=\"search\" role=\"combobox\" enterkeyhint=\"search\" placeholder=\"${state.i18n.searchLabel}\" autocapitalize=\"none\" autocomplete=\"off\" spellcheck=\"true\" aria-expanded=\"${!!(state.searchMode && state.currentEmojis.length)}\" aria-controls=\"search-results\" aria-describedby=\"search-description\" aria-autocomplete=\"list\" aria-activedescendant=\"${state.activeSearchItemId ? `emo-${state.activeSearchItemId}` : ''}\" data-ref=\"searchElement\" data-on-input=\"onSearchInput\" data-on-keydown=\"onSearchKeydown\"><label class=\"sr-only\" for=\"search\">${state.i18n.searchLabel}</label> <span id=\"search-description\" class=\"sr-only\">${state.i18n.searchDescription}</span></div><div class=\"skintone-button-wrapper ${state.skinTonePickerExpandedAfterAnimation ? 'expanded' : ''}\"><button id=\"skintone-button\" class=\"emoji ${state.skinTonePickerExpanded ? 'hide-focus' : ''}\" aria-label=\"${state.skinToneButtonLabel}\" title=\"${state.skinToneButtonLabel}\" aria-describedby=\"skintone-description\" aria-haspopup=\"listbox\" aria-expanded=\"${state.skinTonePickerExpanded}\" aria-controls=\"skintone-list\" data-on-click=\"onClickSkinToneButton\">${state.skinToneButtonText || ''}</button></div><span id=\"skintone-description\" class=\"sr-only\">${state.i18n.skinToneDescription}</span><div data-ref=\"skinToneDropdown\" id=\"skintone-list\" class=\"skintone-list hide-focus ${state.skinTonePickerExpanded ? '' : 'hidden no-animate'}\" style=\"transform:translateY(${state.skinTonePickerExpanded ? 0 : 'calc(-1 * var(--num-skintones) * var(--total-emoji-size))'})\" role=\"listbox\" aria-label=\"${state.i18n.skinTonesLabel}\" aria-activedescendant=\"skintone-${state.activeSkinTone}\" aria-hidden=\"${!state.skinTonePickerExpanded}\" tabIndex=\"-1\" data-on-focusout=\"onSkinToneOptionsFocusOut\" data-on-click=\"onSkinToneOptionsClick\" data-on-keydown=\"onSkinToneOptionsKeydown\" data-on-keyup=\"onSkinToneOptionsKeyup\">${\n    map(state.skinTones, (skinTone, i) => {\n    return html`<div id=\"skintone-${i}\" class=\"emoji ${i === state.activeSkinTone ? 'active' : ''}\" aria-selected=\"${i === state.activeSkinTone}\" role=\"option\" title=\"${state.i18n.skinTones[i]}\" aria-label=\"${state.i18n.skinTones[i]}\">${skinTone}</div>`\n    }, skinTone => skinTone)\n        }</div></div><div class=\"nav\" role=\"tablist\" style=\"grid-template-columns:repeat(${state.groups.length},1fr)\" aria-label=\"${state.i18n.categoriesLabel}\" data-on-keydown=\"onNavKeydown\" data-on-click=\"onNavClick\">${\n            map(state.groups, (group) => {\n              return html`<button role=\"tab\" class=\"nav-button\" aria-controls=\"tab-${group.id}\" aria-label=\"${state.i18n.categories[group.name]}\" aria-selected=\"${!state.searchMode && state.currentGroup.id === group.id}\" title=\"${state.i18n.categories[group.name]}\" data-group-id=\"${group.id}\"><div class=\"nav-emoji emoji\">${group.emoji}</div></button>`\n            }, group => group.id)\n          }</div><div class=\"indicator-wrapper\"><div class=\"indicator\" style=\"transform:translateX(${(/* istanbul ignore next */ (state.isRtl ? -1 : 1)) * state.currentGroupIndex * 100}%)\"></div></div><div class=\"message ${state.message ? '' : 'gone'}\" role=\"alert\" aria-live=\"polite\">${state.message || ''}</div><div data-ref=\"tabpanelElement\" class=\"tabpanel ${(!state.databaseLoaded || state.message) ? 'gone' : ''}\" role=\"${state.searchMode ? 'region' : 'tabpanel'}\" aria-label=\"${state.searchMode ? state.i18n.searchResultsLabel : state.i18n.categories[state.currentGroup.name]}\" id=\"${state.searchMode ? '' : `tab-${state.currentGroup.id}`}\" tabIndex=\"0\" data-on-click=\"onEmojiClick\"><div data-action=\"calculateEmojiGridStyle\">${\n              map(state.currentEmojisWithCategories, (emojiWithCategory, i) => {\n                return html`<div><div id=\"menu-label-${i}\" class=\"category ${state.currentEmojisWithCategories.length === 1 && state.currentEmojisWithCategories[0].category === '' ? 'gone' : ''}\" aria-hidden=\"true\">${\n                  state.searchMode\n                    ? state.i18n.searchResultsLabel\n                    : (\n                      emojiWithCategory.category\n                        ? emojiWithCategory.category\n                        : (\n                          state.currentEmojisWithCategories.length > 1\n                            ? state.i18n.categories.custom\n                            : state.i18n.categories[state.currentGroup.name]\n                        )\n                    )\n                }</div><div class=\"emoji-menu ${i !== 0 && !state.searchMode && state.currentGroup.id === -1 ? 'visibility-auto' : ''}\" style=\"${`--num-rows: ${Math.ceil(emojiWithCategory.emojis.length / state.numColumns)}`}\" data-action=\"updateOnIntersection\" role=\"${state.searchMode ? 'listbox' : 'menu'}\" aria-labelledby=\"menu-label-${i}\" id=\"${state.searchMode ? 'search-results' : ''}\">${\n              emojiList(emojiWithCategory.emojis, state.searchMode, /* prefix */ 'emo')\n            }</div></div>`\n              }, emojiWithCategory => emojiWithCategory.category)\n            }</div></div><div class=\"favorites onscreen emoji-menu ${state.message ? 'gone' : ''}\" role=\"menu\" aria-label=\"${state.i18n.favoritesLabel}\" data-on-click=\"onEmojiClick\">${\n            emojiList(state.currentFavorites, /* searchMode */ false, /* prefix */ 'fav')\n          }</div><button data-ref=\"baselineEmoji\" aria-hidden=\"true\" tabindex=\"-1\" class=\"abs-pos hidden emoji baseline-emoji\">😀</button></section>`\n  };\n\n  const rootDom = section();\n\n  // helper for traversing the dom, finding elements by an attribute, and getting the attribute value\n  const forElementWithAttribute = (attributeName, callback) => {\n    for (const element of container.querySelectorAll(`[${attributeName}]`)) {\n      callback(element, element.getAttribute(attributeName));\n    }\n  };\n\n  if (firstRender) { // not a re-render\n    container.appendChild(rootDom);\n\n    // we only bind events/refs once - there is no need to find them again given this component structure\n\n    // bind events\n    for (const eventName of ['click', 'focusout', 'input', 'keydown', 'keyup']) {\n      forElementWithAttribute(`data-on-${eventName}`, (element, listenerName) => {\n        element.addEventListener(eventName, events[listenerName]);\n      });\n    }\n\n    // find refs\n    forElementWithAttribute('data-ref', (element, ref) => {\n      refs[ref] = element;\n    });\n\n    // destroy/abort logic\n    abortSignal.addEventListener('abort', () => {\n      container.removeChild(rootDom);\n    });\n  }\n\n  // set up actions - these are re-bound on every render\n  forElementWithAttribute('data-action', (element, action) => {\n    let boundActions = actionContext.get(action);\n    if (!boundActions) {\n      actionContext.set(action, (boundActions = new WeakSet()));\n    }\n\n    // avoid applying the same action to the same element multiple times\n    if (!boundActions.has(element)) {\n      boundActions.add(element);\n      actions[action](element);\n    }\n  });\n}\n\n/* istanbul ignore next */\nconst qM = typeof queueMicrotask === 'function' ? queueMicrotask : callback => Promise.resolve().then(callback);\n\nfunction createState (abortSignal) {\n  let destroyed = false;\n  let currentObserver;\n\n  const propsToObservers = new Map();\n  const dirtyObservers = new Set();\n\n  let queued;\n\n  const flush = () => {\n    if (destroyed) {\n      return\n    }\n    const observersToRun = [...dirtyObservers];\n    dirtyObservers.clear(); // clear before running to force any new updates to run in another tick of the loop\n    try {\n      for (const observer of observersToRun) {\n        observer();\n      }\n    } finally {\n      queued = false;\n      if (dirtyObservers.size) { // new updates, queue another one\n        queued = true;\n        qM(flush);\n      }\n    }\n  };\n\n  const state = new Proxy({}, {\n    get (target, prop) {\n      if (currentObserver) {\n        let observers = propsToObservers.get(prop);\n        if (!observers) {\n          observers = new Set();\n          propsToObservers.set(prop, observers);\n        }\n        observers.add(currentObserver);\n      }\n      return target[prop]\n    },\n    set (target, prop, newValue) {\n      if (target[prop] !== newValue) {\n        target[prop] = newValue;\n        const observers = propsToObservers.get(prop);\n        if (observers) {\n          for (const observer of observers) {\n            dirtyObservers.add(observer);\n          }\n          if (!queued) {\n            queued = true;\n            qM(flush);\n          }\n        }\n      }\n      return true\n    }\n  });\n\n  const createEffect = (callback) => {\n    const runnable = () => {\n      const oldObserver = currentObserver;\n      currentObserver = runnable;\n      try {\n        return callback()\n      } finally {\n        currentObserver = oldObserver;\n      }\n    };\n    return runnable()\n  };\n\n  // destroy logic\n  abortSignal.addEventListener('abort', () => {\n    destroyed = true;\n  });\n\n  return {\n    state,\n    createEffect\n  }\n}\n\n// Compare two arrays, with a function called on each item in the two arrays that returns true if the items are equal\nfunction arraysAreEqualByFunction (left, right, areEqualFunc) {\n  if (left.length !== right.length) {\n    return false\n  }\n  for (let i = 0; i < left.length; i++) {\n    if (!areEqualFunc(left[i], right[i])) {\n      return false\n    }\n  }\n  return true\n}\n\nconst intersectionObserverCache = new WeakMap();\n\nfunction intersectionObserverAction (node, abortSignal, listener) {\n  /* istanbul ignore else */\n  {\n    // The scroll root is always `.tabpanel`\n    const root = node.closest('.tabpanel');\n\n    let observer = intersectionObserverCache.get(root);\n    if (!observer) {\n      // TODO: replace this with the contentvisibilityautostatechange event when all supported browsers support it.\n      // For now we use IntersectionObserver because it has better cross-browser support, and it would be bad for\n      // old Safari versions if they eagerly downloaded all custom emoji all at once.\n      observer = new IntersectionObserver(listener, {\n        root,\n        // trigger if we are 1/2 scroll container height away so that the images load a bit quicker while scrolling\n        rootMargin: '50% 0px 50% 0px',\n        // trigger if any part of the emoji grid is intersecting\n        threshold: 0\n      });\n\n      // avoid creating a new IntersectionObserver for every category; just use one for the whole root\n      intersectionObserverCache.set(root, observer);\n\n      // assume that the abortSignal is always the same for this root node; just add one event listener\n      abortSignal.addEventListener('abort', () => {\n        observer.disconnect();\n      });\n    }\n\n    observer.observe(node);\n  }\n}\n\n/* eslint-disable prefer-const,no-labels,no-inner-declarations */\n\n// constants\nconst EMPTY_ARRAY = [];\n\nconst { assign } = Object;\n\nfunction createRoot (shadowRoot, props) {\n  const refs = {};\n  const abortController = new AbortController();\n  const abortSignal = abortController.signal;\n  const { state, createEffect } = createState(abortSignal);\n  const actionContext = new Map();\n\n  // initial state\n  assign(state, {\n    skinToneEmoji: undefined,\n    i18n: undefined,\n    database: undefined,\n    customEmoji: undefined,\n    customCategorySorting: undefined,\n    emojiVersion: undefined\n  });\n\n  // public props\n  assign(state, props);\n\n  // private props\n  assign(state, {\n    initialLoad: true,\n    currentEmojis: [],\n    currentEmojisWithCategories: [],\n    rawSearchText: '',\n    searchText: '',\n    searchMode: false,\n    activeSearchItem: -1,\n    message: undefined,\n    skinTonePickerExpanded: false,\n    skinTonePickerExpandedAfterAnimation: false,\n    currentSkinTone: 0,\n    activeSkinTone: 0,\n    skinToneButtonText: undefined,\n    pickerStyle: undefined,\n    skinToneButtonLabel: '',\n    skinTones: [],\n    currentFavorites: [],\n    defaultFavoriteEmojis: undefined,\n    numColumns: DEFAULT_NUM_COLUMNS,\n    isRtl: false,\n    currentGroupIndex: 0,\n    groups: groups,\n    databaseLoaded: false,\n    activeSearchItemId: undefined\n  });\n\n  //\n  // Update the current group based on the currentGroupIndex\n  //\n  createEffect(() => {\n    if (state.currentGroup !== state.groups[state.currentGroupIndex]) {\n      state.currentGroup = state.groups[state.currentGroupIndex];\n    }\n  });\n\n  //\n  // Utils/helpers\n  //\n\n  const focus = id => {\n    shadowRoot.getElementById(id).focus();\n  };\n\n  const emojiToDomNode = emoji => shadowRoot.getElementById(`emo-${emoji.id}`);\n\n  // fire a custom event that crosses the shadow boundary\n  const fireEvent = (name, detail) => {\n    refs.rootElement.dispatchEvent(new CustomEvent(name, {\n      detail,\n      bubbles: true,\n      composed: true\n    }));\n  };\n\n  //\n  // Comparison utils\n  //\n\n  const compareEmojiArrays = (a, b) => a.id === b.id;\n\n  const compareCurrentEmojisWithCategories = (a, b) => {\n    const { category: aCategory, emojis: aEmojis } = a;\n    const { category: bCategory, emojis: bEmojis } = b;\n\n    if (aCategory !== bCategory) {\n      return false\n    }\n\n    return arraysAreEqualByFunction(aEmojis, bEmojis, compareEmojiArrays)\n  };\n\n  //\n  // Update utils to avoid excessive re-renders\n  //\n\n  // avoid excessive re-renders by checking the value before setting\n  const updateCurrentEmojis = (newEmojis) => {\n    if (!arraysAreEqualByFunction(state.currentEmojis, newEmojis, compareEmojiArrays)) {\n      state.currentEmojis = newEmojis;\n    }\n  };\n\n  // avoid excessive re-renders\n  const updateSearchMode = (newSearchMode) => {\n    if (state.searchMode !== newSearchMode) {\n      state.searchMode = newSearchMode;\n    }\n  };\n\n  // avoid excessive re-renders\n  const updateCurrentEmojisWithCategories = (newEmojisWithCategories) => {\n    if (!arraysAreEqualByFunction(state.currentEmojisWithCategories, newEmojisWithCategories, compareCurrentEmojisWithCategories)) {\n      state.currentEmojisWithCategories = newEmojisWithCategories;\n    }\n  };\n\n  // Helpers used by PickerTemplate\n\n  const unicodeWithSkin = (emoji, currentSkinTone) => (\n    (currentSkinTone && emoji.skins && emoji.skins[currentSkinTone]) || emoji.unicode\n  );\n\n  const labelWithSkin = (emoji, currentSkinTone) => (\n    uniq([\n      (emoji.name || unicodeWithSkin(emoji, currentSkinTone)),\n      emoji.annotation,\n      ...(emoji.shortcodes || EMPTY_ARRAY)\n    ].filter(Boolean)).join(', ')\n  );\n\n  const titleForEmoji = (emoji) => (\n    emoji.annotation || (emoji.shortcodes || EMPTY_ARRAY).join(', ')\n  );\n\n  const helpers = {\n    labelWithSkin, titleForEmoji, unicodeWithSkin\n  };\n  const events = {\n    onClickSkinToneButton,\n    onEmojiClick,\n    onNavClick,\n    onNavKeydown,\n    onSearchKeydown,\n    onSkinToneOptionsClick,\n    onSkinToneOptionsFocusOut,\n    onSkinToneOptionsKeydown,\n    onSkinToneOptionsKeyup,\n    onSearchInput\n  };\n  const actions = {\n    calculateEmojiGridStyle,\n    updateOnIntersection\n  };\n\n  let firstRender = true;\n  createEffect(() => {\n    render(shadowRoot, state, helpers, events, actions, refs, abortSignal, actionContext, firstRender);\n    firstRender = false;\n  });\n\n  //\n  // Determine the emoji support level (in requestIdleCallback)\n  //\n\n  // mount logic\n  if (!state.emojiVersion) {\n    detectEmojiSupportLevel().then(level => {\n      // Can't actually test emoji support in Jest/Vitest/JSDom, emoji never render in color in Cairo\n      /* istanbul ignore next */\n      if (!level) {\n        state.message = state.i18n.emojiUnsupportedMessage;\n      }\n    });\n  }\n\n  //\n  // Set or update the database object\n  //\n\n  createEffect(() => {\n    // show a Loading message if it takes a long time, or show an error if there's a network/IDB error\n    async function handleDatabaseLoading () {\n      let showingLoadingMessage = false;\n      const timeoutHandle = setTimeout(() => {\n        showingLoadingMessage = true;\n        state.message = state.i18n.loadingMessage;\n      }, TIMEOUT_BEFORE_LOADING_MESSAGE);\n      try {\n        await state.database.ready();\n        state.databaseLoaded = true; // eslint-disable-line no-unused-vars\n      } catch (err) {\n        console.error(err);\n        state.message = state.i18n.networkErrorMessage;\n      } finally {\n        clearTimeout(timeoutHandle);\n        if (showingLoadingMessage) { // Seems safer than checking the i18n string, which may change\n          showingLoadingMessage = false;\n          state.message = ''; // eslint-disable-line no-unused-vars\n        }\n      }\n    }\n\n    if (state.database) {\n      /* no await */\n      handleDatabaseLoading();\n    }\n  });\n\n  //\n  // Global styles for the entire picker\n  //\n\n  createEffect(() => {\n    state.pickerStyle = `\n      --num-groups: ${state.groups.length}; \n      --indicator-opacity: ${state.searchMode ? 0 : 1}; \n      --num-skintones: ${NUM_SKIN_TONES};`;\n  });\n\n  //\n  // Set or update the customEmoji\n  //\n\n  createEffect(() => {\n    if (state.customEmoji && state.database) {\n      updateCustomEmoji(); // re-run whenever customEmoji change\n    }\n  });\n\n  createEffect(() => {\n    if (state.customEmoji && state.customEmoji.length) {\n      if (state.groups !== allGroups) { // don't update unnecessarily\n        state.groups = allGroups;\n      }\n    } else if (state.groups !== groups) {\n      if (state.currentGroupIndex) {\n        // If the current group is anything other than \"custom\" (which is first), decrement.\n        // This fixes the odd case where you set customEmoji, then pick a category, then unset customEmoji\n        state.currentGroupIndex--;\n      }\n      state.groups = groups;\n    }\n  });\n\n  //\n  // Set or update the preferred skin tone\n  //\n\n  createEffect(() => {\n    async function updatePreferredSkinTone () {\n      if (state.databaseLoaded) {\n        state.currentSkinTone = await state.database.getPreferredSkinTone();\n      }\n    }\n\n    /* no await */ updatePreferredSkinTone();\n  });\n\n  createEffect(() => {\n    state.skinTones = Array(NUM_SKIN_TONES).fill().map((_, i) => applySkinTone(state.skinToneEmoji, i));\n  });\n\n  createEffect(() => {\n    state.skinToneButtonText = state.skinTones[state.currentSkinTone];\n  });\n\n  createEffect(() => {\n    state.skinToneButtonLabel = state.i18n.skinToneLabel.replace('{skinTone}', state.i18n.skinTones[state.currentSkinTone]);\n  });\n\n  //\n  // Set or update the favorites emojis\n  //\n\n  createEffect(() => {\n    async function updateDefaultFavoriteEmojis () {\n      const { database } = state;\n      const favs = (await Promise.all(MOST_COMMONLY_USED_EMOJI.map(unicode => (\n        database.getEmojiByUnicodeOrName(unicode)\n      )))).filter(Boolean); // filter because in Jest/Vitest tests we don't have all the emoji in the DB\n      state.defaultFavoriteEmojis = favs;\n    }\n\n    if (state.databaseLoaded) {\n      /* no await */ updateDefaultFavoriteEmojis();\n    }\n  });\n\n  function updateCustomEmoji () {\n    // Certain effects have an implicit dependency on customEmoji since it affects the database\n    // Getting it here on the state ensures this effect re-runs when customEmoji change.\n    const { customEmoji, database } = state;\n    const databaseCustomEmoji = customEmoji || EMPTY_ARRAY;\n    if (database.customEmoji !== databaseCustomEmoji) {\n      // Avoid setting this if the customEmoji have _not_ changed, because the setter triggers a re-computation of the\n      // `customEmojiIndex`. Note we don't bother with deep object changes.\n      database.customEmoji = databaseCustomEmoji;\n    }\n  }\n\n  createEffect(() => {\n    async function updateFavorites () {\n      updateCustomEmoji(); // re-run whenever customEmoji change\n      const { database, defaultFavoriteEmojis, numColumns } = state;\n      const dbFavorites = await database.getTopFavoriteEmoji(numColumns);\n      const favorites = await summarizeEmojis(uniqBy([\n        ...dbFavorites,\n        ...defaultFavoriteEmojis\n      ], _ => (_.unicode || _.name)).slice(0, numColumns));\n      state.currentFavorites = favorites;\n    }\n\n    if (state.databaseLoaded && state.defaultFavoriteEmojis) {\n      /* no await */ updateFavorites();\n    }\n  });\n\n  //\n  // Re-run whenever the emoji grid changes size, and re-calc style/layout-related state variables:\n  // 1) Re-calculate the --num-columns var because it may have changed\n  // 2) Re-calculate whether we're in RTL mode or not.\n  //\n  // The benefit of doing this in one place is to align with rAF/ResizeObserver\n  // and do all the calculations in one go. RTL vs LTR is not strictly layout-related,\n  // but since we're already reading the style here, and since it's already aligned with\n  // the rAF loop, this is the most appropriate place to do it perf-wise.\n  //\n\n  function calculateEmojiGridStyle (node) {\n    resizeObserverAction(node, abortSignal, () => {\n      /* istanbul ignore next */\n      { // jsdom throws errors for this kind of fancy stuff\n        // read all the style/layout calculations we need to make\n        const style = getComputedStyle(refs.rootElement);\n        const newNumColumns = parseInt(style.getPropertyValue('--num-columns'), 10);\n        const newIsRtl = style.getPropertyValue('direction') === 'rtl';\n\n        // write to state variables\n        state.numColumns = newNumColumns;\n        state.isRtl = newIsRtl;\n      }\n    });\n  }\n\n  // Re-run whenever the custom emoji in a category are shown/hidden. This is an optimization that simulates\n  // what we'd get from `<img loading=lazy>` but without rendering an `<img>`.\n  function updateOnIntersection (node) {\n    intersectionObserverAction(node, abortSignal, (entries) => {\n      for (const { target, isIntersecting } of entries) {\n        target.classList.toggle('onscreen', isIntersecting);\n      }\n    });\n  }\n\n  //\n  // Set or update the currentEmojis. Check for invalid ZWJ renderings\n  // (i.e. double emoji).\n  //\n\n  createEffect(() => {\n    async function updateEmojis () {\n      const { searchText, currentGroup, databaseLoaded, customEmoji } = state;\n      if (!databaseLoaded) {\n        state.currentEmojis = [];\n        state.searchMode = false;\n      } else if (searchText.length >= MIN_SEARCH_TEXT_LENGTH) {\n        const newEmojis = await getEmojisBySearchQuery(searchText);\n        if (state.searchText === searchText) { // if the situation changes asynchronously, do not update\n          updateCurrentEmojis(newEmojis);\n          updateSearchMode(true);\n        }\n      } else { // database is loaded and we're not in search mode, so we're in normal category mode\n        const { id: currentGroupId } = currentGroup;\n        // avoid race condition where currentGroupId is -1 and customEmoji is undefined/empty\n        if (currentGroupId !== -1 || (customEmoji && customEmoji.length)) {\n          const newEmojis = await getEmojisByGroup(currentGroupId);\n          if (state.currentGroup.id === currentGroupId) { // if the situation changes asynchronously, do not update\n            updateCurrentEmojis(newEmojis);\n            updateSearchMode(false);\n          }\n        }\n      }\n    }\n\n    /* no await */ updateEmojis();\n  });\n\n  const resetScrollTopInRaf = () => {\n    rAF(() => resetScrollTopIfPossible(refs.tabpanelElement));\n  };\n\n  // Some emojis have their ligatures rendered as two or more consecutive emojis\n  // We want to treat these the same as unsupported emojis, so we compare their\n  // widths against the baseline widths and remove them as necessary\n  createEffect(() => {\n    const { currentEmojis, emojiVersion } = state;\n    const zwjEmojisToCheck = currentEmojis\n      .filter(emoji => emoji.unicode) // filter custom emoji\n      .filter(emoji => hasZwj(emoji) && !supportedZwjEmojis.has(emoji.unicode));\n    if (!emojiVersion && zwjEmojisToCheck.length) {\n      // render now, check their length later\n      updateCurrentEmojis(currentEmojis);\n      rAF(() => checkZwjSupportAndUpdate(zwjEmojisToCheck));\n    } else {\n      const newEmojis = emojiVersion ? currentEmojis : currentEmojis.filter(isZwjSupported);\n      updateCurrentEmojis(newEmojis);\n      // Reset scroll top to 0 when emojis change\n      resetScrollTopInRaf();\n    }\n  });\n\n  function checkZwjSupportAndUpdate (zwjEmojisToCheck) {\n    const allSupported = checkZwjSupport(zwjEmojisToCheck, refs.baselineEmoji, emojiToDomNode);\n    if (allSupported) {\n      // Even if all emoji are supported, we still need to reset the scroll top to 0 when emojis change\n      resetScrollTopInRaf();\n    } else {\n      // Force update. We only do this if there are any unsupported ZWJ characters since otherwise,\n      // for browsers that support all emoji, it would be an unnecessary extra re-render.\n      state.currentEmojis = [...state.currentEmojis];\n    }\n  }\n\n  function isZwjSupported (emoji) {\n    return !emoji.unicode || !hasZwj(emoji) || supportedZwjEmojis.get(emoji.unicode)\n  }\n\n  async function filterEmojisByVersion (emojis) {\n    const emojiSupportLevel = state.emojiVersion || await detectEmojiSupportLevel();\n    // !version corresponds to custom emoji\n    return emojis.filter(({ version }) => !version || version <= emojiSupportLevel)\n  }\n\n  async function summarizeEmojis (emojis) {\n    return summarizeEmojisForUI(emojis, state.emojiVersion || await detectEmojiSupportLevel())\n  }\n\n  async function getEmojisByGroup (group) {\n    // -1 is custom emoji\n    const emoji = group === -1 ? state.customEmoji : await state.database.getEmojiByGroup(group);\n    return summarizeEmojis(await filterEmojisByVersion(emoji))\n  }\n\n  async function getEmojisBySearchQuery (query) {\n    return summarizeEmojis(await filterEmojisByVersion(await state.database.getEmojiBySearchQuery(query)))\n  }\n\n  createEffect(() => {\n  });\n\n  //\n  // Derive currentEmojisWithCategories from currentEmojis. This is always done even if there\n  // are no categories, because it's just easier to code the HTML this way.\n  //\n\n  createEffect(() => {\n    function calculateCurrentEmojisWithCategories () {\n      const { searchMode, currentEmojis } = state;\n      if (searchMode) {\n        return [\n          {\n            category: '',\n            emojis: currentEmojis\n          }\n        ]\n      }\n      const categoriesToEmoji = new Map();\n      for (const emoji of currentEmojis) {\n        const category = emoji.category || '';\n        let emojis = categoriesToEmoji.get(category);\n        if (!emojis) {\n          emojis = [];\n          categoriesToEmoji.set(category, emojis);\n        }\n        emojis.push(emoji);\n      }\n      return [...categoriesToEmoji.entries()]\n        .map(([category, emojis]) => ({ category, emojis }))\n        .sort((a, b) => state.customCategorySorting(a.category, b.category))\n    }\n\n    const newEmojisWithCategories = calculateCurrentEmojisWithCategories();\n    updateCurrentEmojisWithCategories(newEmojisWithCategories);\n  });\n\n  //\n  // Handle active search item (i.e. pressing up or down while searching)\n  //\n\n  createEffect(() => {\n    state.activeSearchItemId = state.activeSearchItem !== -1 && state.currentEmojis[state.activeSearchItem].id;\n  });\n\n  //\n  // Handle user input on the search input\n  //\n\n  createEffect(() => {\n    const { rawSearchText } = state;\n    rIC(() => {\n      state.searchText = (rawSearchText || '').trim(); // defer to avoid input delays, plus we can trim here\n      state.activeSearchItem = -1;\n    });\n  });\n\n  function onSearchKeydown (event) {\n    if (!state.searchMode || !state.currentEmojis.length) {\n      return\n    }\n\n    const goToNextOrPrevious = (previous) => {\n      halt(event);\n      state.activeSearchItem = incrementOrDecrement(previous, state.activeSearchItem, state.currentEmojis);\n    };\n\n    switch (event.key) {\n      case 'ArrowDown':\n        return goToNextOrPrevious(false)\n      case 'ArrowUp':\n        return goToNextOrPrevious(true)\n      case 'Enter':\n        if (state.activeSearchItem === -1) {\n          // focus the first option in the list since the list must be non-empty at this point (it's verified above)\n          state.activeSearchItem = 0;\n        } else { // there is already an active search item\n          halt(event);\n          return clickEmoji(state.currentEmojis[state.activeSearchItem].id)\n        }\n    }\n  }\n\n  //\n  // Handle user input on nav\n  //\n\n  function onNavClick (event) {\n    const { target } = event;\n    const closestTarget = target.closest('.nav-button');\n    /* istanbul ignore if */\n    if (!closestTarget) {\n      return // This should never happen, but makes me nervous not to have it\n    }\n    const groupId = parseInt(closestTarget.dataset.groupId, 10);\n    refs.searchElement.value = ''; // clear search box input\n    state.rawSearchText = '';\n    state.searchText = '';\n    state.activeSearchItem = -1;\n    state.currentGroupIndex = state.groups.findIndex(_ => _.id === groupId);\n  }\n\n  function onNavKeydown (event) {\n    const { target, key } = event;\n\n    const doFocus = el => {\n      if (el) {\n        halt(event);\n        el.focus();\n      }\n    };\n\n    switch (key) {\n      case 'ArrowLeft':\n        return doFocus(target.previousElementSibling)\n      case 'ArrowRight':\n        return doFocus(target.nextElementSibling)\n      case 'Home':\n        return doFocus(target.parentElement.firstElementChild)\n      case 'End':\n        return doFocus(target.parentElement.lastElementChild)\n    }\n  }\n\n  //\n  // Handle user input on an emoji\n  //\n\n  async function clickEmoji (unicodeOrName) {\n    const emoji = await state.database.getEmojiByUnicodeOrName(unicodeOrName);\n    const emojiSummary = [...state.currentEmojis, ...state.currentFavorites]\n      .find(_ => (_.id === unicodeOrName));\n    const skinTonedUnicode = emojiSummary.unicode && unicodeWithSkin(emojiSummary, state.currentSkinTone);\n    await state.database.incrementFavoriteEmojiCount(unicodeOrName);\n    fireEvent('emoji-click', {\n      emoji,\n      skinTone: state.currentSkinTone,\n      ...(skinTonedUnicode && { unicode: skinTonedUnicode }),\n      ...(emojiSummary.name && { name: emojiSummary.name })\n    });\n  }\n\n  async function onEmojiClick (event) {\n    const { target } = event;\n    /* istanbul ignore if */\n    if (!target.classList.contains('emoji')) {\n      // This should never happen, but makes me nervous not to have it\n      return\n    }\n    halt(event);\n    const id = target.id.substring(4); // replace 'emo-' or 'fav-' prefix\n\n    /* no await */ clickEmoji(id);\n  }\n\n  //\n  // Handle user input on the skintone picker\n  //\n\n  function changeSkinTone (skinTone) {\n    state.currentSkinTone = skinTone;\n    state.skinTonePickerExpanded = false;\n    focus('skintone-button');\n    fireEvent('skin-tone-change', { skinTone });\n    /* no await */ state.database.setPreferredSkinTone(skinTone);\n  }\n\n  function onSkinToneOptionsClick (event) {\n    const { target: { id } } = event;\n    const match = id && id.match(/^skintone-(\\d)/); // skintone option format\n    /* istanbul ignore if */\n    if (!match) { // not a skintone option\n      return // This should never happen, but makes me nervous not to have it\n    }\n    halt(event);\n    const skinTone = parseInt(match[1], 10); // remove 'skintone-' prefix\n    changeSkinTone(skinTone);\n  }\n\n  function onClickSkinToneButton (event) {\n    state.skinTonePickerExpanded = !state.skinTonePickerExpanded;\n    state.activeSkinTone = state.currentSkinTone;\n    // this should always be true, since the button is obscured by the listbox, so this `if` is just to be sure\n    if (state.skinTonePickerExpanded) {\n      halt(event);\n      rAF(() => focus('skintone-list'));\n    }\n  }\n\n  // To make the animation nicer, change the z-index of the skintone picker button\n  // *after* the animation has played. This makes it appear that the picker box\n  // is expanding \"below\" the button\n  createEffect(() => {\n    if (state.skinTonePickerExpanded) {\n      refs.skinToneDropdown.addEventListener('transitionend', () => {\n        state.skinTonePickerExpandedAfterAnimation = true; // eslint-disable-line no-unused-vars\n      }, { once: true });\n    } else {\n      state.skinTonePickerExpandedAfterAnimation = false; // eslint-disable-line no-unused-vars\n    }\n  });\n\n  function onSkinToneOptionsKeydown (event) {\n    // this should never happen, but makes me nervous not to have it\n    /* istanbul ignore if */\n    if (!state.skinTonePickerExpanded) {\n      return\n    }\n    const changeActiveSkinTone = async nextSkinTone => {\n      halt(event);\n      state.activeSkinTone = nextSkinTone;\n    };\n\n    switch (event.key) {\n      case 'ArrowUp':\n        return changeActiveSkinTone(incrementOrDecrement(true, state.activeSkinTone, state.skinTones))\n      case 'ArrowDown':\n        return changeActiveSkinTone(incrementOrDecrement(false, state.activeSkinTone, state.skinTones))\n      case 'Home':\n        return changeActiveSkinTone(0)\n      case 'End':\n        return changeActiveSkinTone(state.skinTones.length - 1)\n      case 'Enter':\n        // enter on keydown, space on keyup. this is just how browsers work for buttons\n        // https://lists.w3.org/Archives/Public/w3c-wai-ig/2019JanMar/0086.html\n        halt(event);\n        return changeSkinTone(state.activeSkinTone)\n      case 'Escape':\n        halt(event);\n        state.skinTonePickerExpanded = false;\n        return focus('skintone-button')\n    }\n  }\n\n  function onSkinToneOptionsKeyup (event) {\n    // this should never happen, but makes me nervous not to have it\n    /* istanbul ignore if */\n    if (!state.skinTonePickerExpanded) {\n      return\n    }\n    switch (event.key) {\n      case ' ':\n        // enter on keydown, space on keyup. this is just how browsers work for buttons\n        // https://lists.w3.org/Archives/Public/w3c-wai-ig/2019JanMar/0086.html\n        halt(event);\n        return changeSkinTone(state.activeSkinTone)\n    }\n  }\n\n  async function onSkinToneOptionsFocusOut (event) {\n    // On blur outside of the skintone listbox, collapse the skintone picker.\n    const { relatedTarget } = event;\n    // The `else` should never happen, but makes me nervous not to have it\n    /* istanbul ignore else */\n    if (!relatedTarget || relatedTarget.id !== 'skintone-list') {\n      state.skinTonePickerExpanded = false;\n    }\n  }\n\n  function onSearchInput (event) {\n    state.rawSearchText = event.target.value;\n  }\n\n  return {\n    $set (newState) {\n      assign(state, newState);\n    },\n    $destroy () {\n      abortController.abort();\n    }\n  }\n}\n\nconst DEFAULT_DATA_SOURCE = 'https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json';\nconst DEFAULT_LOCALE = 'en';\n\nvar enI18n = {\n  categoriesLabel: 'Categories',\n  emojiUnsupportedMessage: 'Your browser does not support color emoji.',\n  favoritesLabel: 'Favorites',\n  loadingMessage: 'Loading…',\n  networkErrorMessage: 'Could not load emoji.',\n  regionLabel: 'Emoji picker',\n  searchDescription: 'When search results are available, press up or down to select and enter to choose.',\n  searchLabel: 'Search',\n  searchResultsLabel: 'Search results',\n  skinToneDescription: 'When expanded, press up or down to select and enter to choose.',\n  skinToneLabel: 'Choose a skin tone (currently {skinTone})',\n  skinTonesLabel: 'Skin tones',\n  skinTones: [\n    'Default',\n    'Light',\n    'Medium-Light',\n    'Medium',\n    'Medium-Dark',\n    'Dark'\n  ],\n  categories: {\n    custom: 'Custom',\n    'smileys-emotion': 'Smileys and emoticons',\n    'people-body': 'People and body',\n    'animals-nature': 'Animals and nature',\n    'food-drink': 'Food and drink',\n    'travel-places': 'Travel and places',\n    activities: 'Activities',\n    objects: 'Objects',\n    symbols: 'Symbols',\n    flags: 'Flags'\n  }\n};\n\nvar baseStyles = \":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:\\\"\\\";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}\";\n\nconst PROPS = [\n  'customEmoji',\n  'customCategorySorting',\n  'database',\n  'dataSource',\n  'i18n',\n  'locale',\n  'skinToneEmoji',\n  'emojiVersion'\n];\n\n// Styles injected ourselves, so we can declare the FONT_FAMILY variable in one place\nconst EXTRA_STYLES = `:host{--emoji-font-family:${FONT_FAMILY}}`;\n\nclass PickerElement extends HTMLElement {\n  constructor (props) {\n    super();\n    this.attachShadow({ mode: 'open' });\n    const style = document.createElement('style');\n    style.textContent = baseStyles + EXTRA_STYLES;\n    this.shadowRoot.appendChild(style);\n    this._ctx = {\n      // Set defaults\n      locale: DEFAULT_LOCALE,\n      dataSource: DEFAULT_DATA_SOURCE,\n      skinToneEmoji: DEFAULT_SKIN_TONE_EMOJI,\n      customCategorySorting: DEFAULT_CATEGORY_SORTING,\n      customEmoji: null,\n      i18n: enI18n,\n      emojiVersion: null,\n      ...props\n    };\n    // Handle properties set before the element was upgraded\n    for (const prop of PROPS) {\n      if (prop !== 'database' && Object.prototype.hasOwnProperty.call(this, prop)) {\n        this._ctx[prop] = this[prop];\n        delete this[prop];\n      }\n    }\n    this._dbFlush(); // wait for a flush before creating the db, in case the user calls e.g. a setter or setAttribute\n  }\n\n  connectedCallback () {\n    // The _cmp may be defined if the component was immediately disconnected and then reconnected. In that case,\n    // do nothing (preserve the state)\n    if (!this._cmp) {\n      this._cmp = createRoot(this.shadowRoot, this._ctx);\n    }\n  }\n\n  disconnectedCallback () {\n    // Check in a microtask if the element is still connected. If so, treat this as a \"move\" rather than a disconnect\n    // Inspired by Vue: https://vuejs.org/guide/extras/web-components.html#building-custom-elements-with-vue\n    qM(() => {\n      // this._cmp may be defined if connect-disconnect-connect-disconnect occurs synchronously\n      if (!this.isConnected && this._cmp) {\n        this._cmp.$destroy();\n        this._cmp = undefined;\n\n        const { database } = this._ctx;\n        database.close()\n          // only happens if the database failed to load in the first place, so we don't care\n          .catch(err => console.error(err));\n      }\n    });\n  }\n\n  static get observedAttributes () {\n    return ['locale', 'data-source', 'skin-tone-emoji', 'emoji-version'] // complex objects aren't supported, also use kebab-case\n  }\n\n  attributeChangedCallback (attrName, oldValue, newValue) {\n    this._set(\n      // convert from kebab-case to camelcase\n      // see https://github.com/sveltejs/svelte/issues/3852#issuecomment-665037015\n      attrName.replace(/-([a-z])/g, (_, up) => up.toUpperCase()),\n      // convert string attribute to float if necessary\n      attrName === 'emoji-version' ? parseFloat(newValue) : newValue\n    );\n  }\n\n  _set (prop, newValue) {\n    this._ctx[prop] = newValue;\n    if (this._cmp) {\n      this._cmp.$set({ [prop]: newValue });\n    }\n    if (['locale', 'dataSource'].includes(prop)) {\n      this._dbFlush();\n    }\n  }\n\n  _dbCreate () {\n    const { locale, dataSource, database } = this._ctx;\n    // only create a new database if we really need to\n    if (!database || database.locale !== locale || database.dataSource !== dataSource) {\n      this._set('database', new Database({ locale, dataSource }));\n    }\n  }\n\n  // Update the Database in one microtask if the locale/dataSource change. We do one microtask\n  // so we don't create two Databases if e.g. both the locale and the dataSource change\n  _dbFlush () {\n    qM(() => (\n      this._dbCreate()\n    ));\n  }\n}\n\nconst definitions = {};\n\nfor (const prop of PROPS) {\n  definitions[prop] = {\n    get () {\n      if (prop === 'database') {\n        // in rare cases, the microtask may not be flushed yet, so we need to instantiate the DB\n        // now if the user is asking for it\n        this._dbCreate();\n      }\n      return this._ctx[prop]\n    },\n    set (val) {\n      if (prop === 'database') {\n        throw new Error('database is read-only')\n      }\n      this._set(prop, val);\n    }\n  };\n}\n\nObject.defineProperties(PickerElement.prototype, definitions);\n\n/* istanbul ignore else */\nif (!customElements.get('emoji-picker')) { // if already defined, do nothing (e.g. same script imported twice)\n  customElements.define('emoji-picker', PickerElement);\n}\n\nexport { PickerElement as default };\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { Socket } from \"./socket.js\";\nexport { Socket };\nexport { SocketWithoutUpgrade, SocketWithUpgrade, } from \"./socket.js\";\nexport const protocol = Socket.protocol;\nexport { Transport, TransportError } from \"./transport.js\";\nexport { transports } from \"./transports/index.js\";\nexport { installTimerFunctions } from \"./util.js\";\nexport { parse } from \"./contrib/parseuri.js\";\nexport { nextTick } from \"./globals.node.js\";\nexport { Fetch } from \"./transports/polling-fetch.js\";\nexport { XHR as NodeXHR } from \"./transports/polling-xhr.node.js\";\nexport { XHR } from \"./transports/polling-xhr.js\";\nexport { WS as NodeWebSocket } from \"./transports/websocket.node.js\";\nexport { WS as WebSocket } from \"./transports/websocket.js\";\nexport { WT as WebTransport } from \"./transports/webtransport.js\";\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Polling } from \"./polling.js\";\n/**\n * HTTP long-polling based on the built-in `fetch()` method.\n *\n * Usage: browser, Node.js (since v18), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/fetch\n * @see https://caniuse.com/fetch\n * @see https://nodejs.org/api/globals.html#fetch\n */\nexport class Fetch extends Polling {\n    doPoll() {\n        this._fetch()\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError(\"fetch read error\", res.status, res);\n            }\n            res.text().then((data) => this.onData(data));\n        })\n            .catch((err) => {\n            this.onError(\"fetch read error\", err);\n        });\n    }\n    doWrite(data, callback) {\n        this._fetch(data)\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError(\"fetch write error\", res.status, res);\n            }\n            callback();\n        })\n            .catch((err) => {\n            this.onError(\"fetch write error\", err);\n        });\n    }\n    _fetch(data) {\n        var _a;\n        const isPost = data !== undefined;\n        const headers = new Headers(this.opts.extraHeaders);\n        if (isPost) {\n            headers.set(\"content-type\", \"text/plain;charset=UTF-8\");\n        }\n        (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.appendCookies(headers);\n        return fetch(this.uri(), {\n            method: isPost ? \"POST\" : \"GET\",\n            body: isPost ? data : null,\n            headers,\n            credentials: this.opts.withCredentials ? \"include\" : \"omit\",\n        }).then((res) => {\n            var _a;\n            // @ts-ignore getSetCookie() was added in Node.js v19.7.0\n            (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(res.headers.getSetCookie());\n            return res;\n        });\n    }\n}\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["Emitter","obj","key","prototype","mixin","on","addEventListener","event","fn","this","_callbacks","push","once","off","apply","arguments","removeListener","removeAllListeners","removeEventListener","length","cb","callbacks","i","splice","emit","args","Array","len","slice","emitReserved","listeners","hasListeners","_regeneratorRuntime","e","t","r","Object","n","hasOwnProperty","o","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","_asyncToGenerator","_next","_throw","utcToLocal","utcDate","date","Date","hours","getHours","minutes","getMinutes","day","getDate","toString","month","getMonth","year","getFullYear","concat","showNotification","text","document","querySelector","classList","remove","textContent","setTimeout","add","chatClicked","_ref","_callee","htmlElement","unreadElement","clickedUser_Username","clickedUser","_len","_key","clickedUser_Id","clickedUser_Name","clickedUser_Avatar","isOnline","statusElement","_args","_context","children","contains","innerText","username","dataset","id","src","encryptedId","avatar","handleChatHeadAndEnd","handleChats","_x","undefined","chat_mid","getElementById","chat_end","chat_head","chat_head_name","chat_head_img","to_user_info_popup","replace","toUserInfoPopupOptions","groupInfoPopupOptions","copyBtn","chatSection","toUserProfileSecName","toUserProfileSecUsername","parentElement","tip","receiverId","handleConversation","fetch","headers","body","JSON","stringify","res","json","data","isBlocked","blockedBy","currentUserId","senderId","blockInfoDiv","appendChild","handleHtmlConversation","err","console","log","msgContainerDiv","messages","filter","msg","msgDate","createdAt","dayDiv","createElement","dateDiv","dateh1","fromUserMsg","fromUserMsgComponent","message","_id","toUserMsg","toUserMsgComponent","scrollTop","scrollHeight","msgId","time","component","innerHTML","createLeftsidePeople","parentDiv","leftSidePersonComponent","handleHtmlOnlineUsers","onlineUsers","onlineClass","addPeopleToChat","_ref2","_callee2","element","alreadyThere","clickedPerson","eleUsername","currentUserName","selfChatJokes","alert","alertText","eleName","eleAvatar","eleId","eleData","privateChats","_context2","Math","floor","random","open","querySelectorAll","person","newPerson","error","click","_x2","handleHtmlSend","msgRes","msgTime","dates","from","handleSendRequest","_ref3","_callee3","_context3","_x3","_x4","deleteMessage","_ref4","_callee4","_context4","nextElementSibling","_x5","deleteConversation","_ref5","_callee5","blockDiv","receiver","_context5","handleBlockUser","handleUnblockUser","blockUnblockUser","_ref6","_callee6","_context6","_x6","setIntervalId","setInterval","clearInterval","emoji_popup_btn","emoji_popup","target","detail","unicode","addChatPopupInitialState","add_people_btn","overlay","to_user_info_btn","showGroupMembersBtn","addChatPopup","initializeAddChatPopupEventListeners","add_people_popup","add_people_list","popup_search","toggle","focus","preventDefault","msgInput","DOMPurify","sanitize","ChatFunctions","groupId","GroupChatFunctions","shiftKey","start","selectionStart","selectionEnd","closest","my_modal_2","showModal","modalProfilePic","gender","csrfToken","success","user","groupMembers","groupMembersParent","noOfMembers","previousElementSibling","member","groupMember","copyLinkBtn","currentGroupId","navigator","clipboard","writeText","process","encodeURIComponent","newChatTab","newGroupTab","newChatTabContent","newGroupTabContent","queryText","popupPeople","foundPeopleUsernames","toLowerCase","people","map","personUsername","trim","includes","t0","scrollLeft","deltaY","passive","checkBox","selectedPeopleParent","selectedPeople","selectedPerson","checked","selectedPersonDiv","selectedPersonInnerDiv","selectedPersonImg","alt","_step","_iterator","_createForOfIteratorHelper","groupAvatar","groupMembersIds","groupName","groupDescription","groupInfo","searchPeople","result","createLeftsideGroup","clicked","groupChats","avatarDiv","imgDiv","img","draggable","nameDiv","groupChatClicked","clickedGroupId","clickedGroup","handleGroupChatHeadAndEnd","handleGroupChat","_groupName","_groupDescription","groupData","handleHtmlGroupConversation","requesterId","groupMessages","fromUserGroupMsg","fromUserGroupMsgComponent","senderName","toUserGroupMsg","toUserGroupMsgComponent","handleSendRequestGroup","_data$msgInfo","msgInfo","deleteGroupMessage","groupMemberComponent","handleHtmlGet","users","status","chat_head_status","socket","io","withCredentials","senderUsername","callback","sender","unreadMsg","unreadMsgCount","personName","personAvatar","personId","parseInt","dltMsgId","activePerson","blockOption","blockBtn","deleteChatBtn","oldUserDetails","newUserDetails","toUserProfileSec","roomId","creatorName","findGroup","group","unreadMsgStatus","deletedBy","allGroups","messageId","assertNonEmptyString","str","assertNumber","number","STORE_EMOJI","STORE_KEYVALUE","STORE_FAVORITES","INDEX_TOKENS","INDEX_COUNT","INDEX_GROUP_AND_ORDER","KEY_ETAG","KEY_URL","KEY_PREFERRED_SKINTONE","MODE_READONLY","MODE_READWRITE","INDEX_SKIN_UNICODE","uniqEmoji","emojis","arr","func","set","Set","item","has","uniqBy","_","openIndexedDBRequests","databaseCache","onCloseListeners","handleOpenOrDeleteReq","reject","req","onerror","onblocked","onsuccess","createDatabase","dbName","db","indexedDB","onupgradeneeded","oldVersion","createObjectStore","keyPath","indexes","store","indexName","multiEntry","entries","createIndex","initialMigration","onclose","closeDatabase","dbPromise","storeName","readOnlyOrReadWrite","txn","transaction","durability","objectStore","oncomplete","close","listener","irregularEmoticons","extractTokens","split","word","match","Boolean","normalizeTokens","callStore","getIDB","getAllIDB","commit","findCommonMembers","arrays","uniqByFunc","shortestArray","array","minItem","minBy","results","some","findIndex","loadData","emojiData","url","eTag","transformedData","annotation","emoticon","order","shortcodes","skins","tags","emoji","version","tokens","flat","sort","skinTones","skinUnicodes","skinVersions","tone","transformEmojiData","emojiStore","metaStore","oldETag","oldUrl","todo","checkFetched","clear","put","onFetched","getEmojiBySearchQuery","query","intermediateResults","onDone","b","token","range","IDBKeyRange","bound","only","index","getEmojiByShortcode","shortcode","predicate","lastKey","processNextBatch","getAll","lowerBound","doFullDatabaseScanForSingleResult","lowerShortcodes","get","requiredKeys$1","customEmojiIndex","customEmojis","isArray","firstItemIsFaulty","assertCustomEmojis","sortByName","all","searchTrie","itemToTokens","Map","currentMap","char","nextMap","valuesAtCoda","exact","queue","entriesSortedByKey","shift","trie","searchByExactMatch","searchByPrefix","shortcodeToEmoji","nameToEmoji","customEmoji","search","byShortcode","byName","isFirefoxContentScript","wrappedJSObject","cleanEmoji","structuredClone","warnETag","warn","requiredKeys","assertStatus","response","dataSource","getETagAndData","assertEmojiData","jsonChecksum","object","inBuffer","binary","buf","ArrayBuffer","Uint8Array","charCodeAt","binaryStringToArrayBuffer","outBinString","buffer","bytes","byteLength","String","fromCharCode","arrayBufferToBinaryString","crypto","subtle","digest","btoa","checkForUpdates","getETag","eTagAndData","hasData","Database","locale","_dbName","_db","_lazyUpdate","_custom","_clear","bind","_ready","_init","addOnCloseListener","empty","isEmpty","loadDataForFirstTime","ready","checkReady","getEmojiByGroup","custom","getEmojiByUnicodeOrName","unicodeOrName","getEmojiByUnicode","getPreferredSkinTone","setPreferredSkinTone","skinTone","incrementFavoriteEmojiCount","getTopFavoriteEmoji","limit","favoritesStore","openCursor","cursor","addResult","continue","primaryKey","_shutdown","deleteDatabase","groups","rIC","requestIdleCallback","hasZwj","versionsAndTestEmoji","MOST_COMMONLY_USED_EMOJI","FONT_FAMILY","DEFAULT_CATEGORY_SORTING","getTextFeature","color","canvas","width","height","ctx","getContext","willReadFrequently","textBaseline","font","fillStyle","scale","fillText","getImageData","testColorEmojiSupported","feature1","feature2","feature1Str","join","startsWith","compareFeatures","promise","detectEmojiSupportLevel","determineEmojiSupportLevel","supportedZwjEmojis","halt","stopPropagation","incrementOrDecrement","decrement","val","rAF","requestAnimationFrame","baselineEmojiWidth","resizeObserverSupported","ResizeObserver","calculateTextWidth","node","createRange","selectNode","firstChild","getBoundingClientRect","getFromMap","cache","cached","parseCache","WeakMap","domInstancesCache","unkeyedSymbol","hasReplaceChildren","Element","patchChildren","newChildren","instanceBinding","targetNode","targetParentNode","needsRerender","parentNode","oldChild","oldChildrenCount","nextSibling","doChildrenNeedRerender","replaceChildren","append","parse","htmlString","withinTag","withinAttribute","elementIndexCounter","elementsToBindings","elementIndexes","j","bindings","attributeName","attributeValuePre","attributeValuePost","exec","binding","expressionIndex","template","parseTemplate","applyBindings","instanceBindings","currentExpression","parseHtml","dom","cloneNode","content","firstElementChild","rootElement","topLevelBindings","size","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","elementIndex","nextNode","traverseAndSetupBindings","expressions","expression","setAttribute","newNode","replaceWith","nodeValue","patch","render","container","state","helpers","events","actions","refs","abortSignal","actionContext","firstRender","labelWithSkin","titleForEmoji","unicodeWithSkin","html","domInstances","domInstanceCacheKey","keyFunction","originalCacheKey","domInstancesForTokens","updateDomInstance","createFramework","emojiList","searchMode","prefix","activeSearchItem","currentSkinTone","rootDom","i18n","regionLabel","pickerStyle","searchLabel","currentEmojis","activeSearchItemId","searchDescription","skinTonePickerExpandedAfterAnimation","skinTonePickerExpanded","skinToneButtonLabel","skinToneButtonText","skinToneDescription","skinTonesLabel","activeSkinTone","categoriesLabel","categories","currentGroup","isRtl","currentGroupIndex","databaseLoaded","searchResultsLabel","currentEmojisWithCategories","emojiWithCategory","category","ceil","numColumns","favoritesLabel","currentFavorites","forElementWithAttribute","getAttribute","eventName","listenerName","ref","removeChild","action","boundActions","WeakSet","qM","queueMicrotask","arraysAreEqualByFunction","left","right","areEqualFunc","intersectionObserverCache","EMPTY_ARRAY","assign","createRoot","shadowRoot","props","abortController","AbortController","signal","createEffect","currentObserver","destroyed","propsToObservers","dirtyObservers","queued","flush","observersToRun","observer","Proxy","prop","observers","newValue","runnable","oldObserver","createState","skinToneEmoji","database","customCategorySorting","emojiVersion","initialLoad","rawSearchText","searchText","defaultFavoriteEmojis","emojiToDomNode","fireEvent","dispatchEvent","CustomEvent","bubbles","composed","compareEmojiArrays","compareCurrentEmojisWithCategories","aCategory","aEmojis","bCategory","bEmojis","updateCurrentEmojis","newEmojis","updateSearchMode","newSearchMode","onClickSkinToneButton","onEmojiClick","clickEmoji","substring","onNavClick","closestTarget","searchElement","onNavKeydown","doFocus","el","lastElementChild","onSearchKeydown","goToNextOrPrevious","previous","onSkinToneOptionsClick","changeSkinTone","onSkinToneOptionsFocusOut","relatedTarget","onSkinToneOptionsKeydown","changeActiveSkinTone","nextSkinTone","onSkinToneOptionsKeyup","onSearchInput","calculateEmojiGridStyle","onUpdate","resizeObserver","observe","disconnect","resizeObserverAction","style","getComputedStyle","newNumColumns","getPropertyValue","newIsRtl","updateOnIntersection","root","IntersectionObserver","rootMargin","threshold","intersectionObserverAction","isIntersecting","updateCustomEmoji","databaseCustomEmoji","level","emojiUnsupportedMessage","showingLoadingMessage","timeoutHandle","loadingMessage","networkErrorMessage","clearTimeout","handleDatabaseLoading","updatePreferredSkinTone","fill","zwjIndex","indexOf","fromCodePoint","endsWith","applySkinTone","skinToneLabel","favs","updateDefaultFavoriteEmojis","dbFavorites","favorites","summarizeEmojis","updateFavorites","filterEmojisByVersion","getEmojisBySearchQuery","getEmojisByGroup","updateEmojis","resetScrollTopInRaf","tabpanelElement","isZwjSupported","emojiSupportLevel","toSimpleSkinsMap","skin","summarizeEmojisForUI","emojiSummary","find","skinTonedUnicode","zwjEmojisToCheck","allSupported","baselineEmoji","emojiWidth","supported","checkZwjSupport","checkZwjSupportAndUpdate","newEmojisWithCategories","updateCurrentEmojisWithCategories","categoriesToEmoji","calculateCurrentEmojisWithCategories","skinToneDropdown","$set","newState","$destroy","abort","enI18n","activities","objects","symbols","flags","PROPS","EXTRA_STYLES","PickerElement","HTMLElement","super","attachShadow","mode","_ctx","_dbFlush","connectedCallback","_cmp","disconnectedCallback","isConnected","catch","observedAttributes","attributeChangedCallback","attrName","oldValue","_set","up","toUpperCase","parseFloat","_dbCreate","definitions","defineProperties","customElements","XMLHttpRequest","hasCORS","encode","decode","qs","qry","pairs","pair","decodeURIComponent","re","parts","m","uri","source","host","authority","ipv6uri","pathNames","path","regx","names","queryKey","$0","$1","$2","nextTick","setTimeoutFn","globalThisShim","self","window","Function","defaultBinaryType","createCookieJar","protocol","Socket","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","opts","binaryType","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","Infinity","parsedUri","hostname","secure","port","installTimerFunctions","location","transports","_transportsByName","transportName","agent","upgrade","timestampParam","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","transportOptions","closeOnBeforeunload","_beforeunloadEventListener","transport","_offlineEventListener","_onClose","description","_cookieJar","_open","createTransport","EIO","sid","priorWebsocketSuccess","readyState","setTransport","_onDrain","_onPacket","_onError","reason","onOpen","packet","onHandshake","_sendPacket","_resetPingTimeout","code","pingInterval","pingTimeout","maxPayload","clearTimeoutFn","_pingTimeoutTimer","delay","now","autoUnref","unref","upgrading","packets","_getWritablePackets","send","payloadSize","_hasPingExpired","hasExpired","write","options","compress","cleanupAndClose","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","pause","cleanup","freezeTransport","onTransportClose","onupgrade","to","_filterUpgrades","upgrades","filteredUpgrades","TransportError","context","Transport","supportsBinary","forceBase64","onError","doOpen","doClose","onClose","onData","decodePacket","onPacket","details","onPause","createUri","schema","_hostname","_port","_query","Number","encodedQuery","websocket","WS","webtransport","WT","polling","XHR","Fetch","Polling","doPoll","_fetch","ok","doWrite","_a","isPost","Headers","extraHeaders","appendCookies","credentials","parseCookies","getSetCookie","BaseXHR","isSSL","xd","request","xhrStatus","pollXhr","Request","createRequest","_opts","_method","_uri","_data","_create","pick","xdomain","xhr","_xhr","setDisableHeaderCheck","setRequestHeader","cookieJar","addCookies","requestTimeout","timeout","onreadystatechange","getResponseHeader","_onLoad","_index","requestsCount","requests","_cleanup","fromError","responseText","attachEvent","unloadHandler","terminationEvent","hasXHR2","newRequest","responseType","_polling","_poll","total","decodePayload","encodePayload","timestampRequests","randomString","b64","isReactNative","product","BaseWS","protocols","ws","createSocket","addEventListeners","onopen","_socket","closeEvent","onmessage","ev","lastPacket","encodePacket","WebSocketCtor","WebSocket","MozWebSocket","_packet","_transport","WebTransport","closed","createBidirectionalStream","stream","decoderStream","createPacketDecoderStream","MAX_SAFE_INTEGER","reader","readable","pipeThrough","getReader","encoderStream","createPacketEncoderStream","pipeTo","_writer","getWriter","read","attr","reduce","acc","k","NATIVE_SET_TIMEOUT","NATIVE_CLEAR_TIMEOUT","useNativeTimers","BASE64_OVERHEAD","utf8Length","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","chars","lookup","arraybuffer","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","withNativeArrayBuffer","encodedPacket","mapBinary","decodeBase64Packet","decoded","Blob","withNativeBlob","isView","encodeBlobAsBase64","fileReader","FileReader","onload","readAsDataURL","toArray","byteOffset","TEXT_ENCODER","encodePacketToBinary","arrayBuffer","encoded","TextEncoder","SEPARATOR","encodedPackets","count","encodedPayload","decodedPacket","TransformStream","transform","controller","payloadLength","header","DataView","setUint8","view","setUint16","setBigUint64","BigInt","enqueue","TEXT_DECODER","totalLength","chunks","chunk","concatChunks","TextDecoder","expectedLength","isBinary","headerArray","getUint16","getUint32","pow","Backoff","ms","min","max","factor","jitter","attempts","duration","rand","deviation","setMin","setMax","setJitter","parsed","sameNamespace","forceNew","multiplex","Manager","connect","nsps","subs","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_readyState","_parser","parser","encoder","Encoder","decoder","Decoder","_autoConnect","autoConnect","_reconnection","skipReconnect","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","engine","openSubDestroy","errorSub","timer","onping","ondata","ondecoded","nsp","active","_destroy","_close","subDestroy","destroy","onreconnect","attempt","RESERVED_EVENTS","freeze","connect_error","disconnecting","newListener","connected","recovered","receiveBuffer","sendBuffer","_queue","_queueSeq","ids","acks","auth","disconnected","subEvents","onpacket","unshift","_b","_c","retries","fromQueue","volatile","_addToQueue","PacketType","EVENT","ack","_registerAckCallback","isTransportWritable","notifyOutgoingListeners","ackTimeout","withError","emitWithAck","arg1","arg2","tryCount","pending","responseArgs","_drainQueue","force","_sendConnectPacket","CONNECT","_pid","pid","offset","_lastOffset","_clearAcks","onconnect","BINARY_EVENT","onevent","ACK","BINARY_ACK","onack","DISCONNECT","ondisconnect","CONNECT_ERROR","emitEvent","_anyListeners","emitBuffered","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","loc","test","href","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","placeholder","_placeholder","num","newData","reconstructPacket","_reconstructPacket","replacer","hasBinary","encodeAsString","encodeAsBinary","deconstruction","isObject","reviver","reconstructor","decodeString","isBinaryEvent","BinaryReconstructor","takeBinaryData","payload","tryParse","substr","isPayloadValid","finishedReconstruction","reconPack","binData","withNativeFile","File","toJSON","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","definition"],"sourceRoot":""}